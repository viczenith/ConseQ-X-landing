{"version":3,"file":"static/js/707.c4ec53c9.chunk.js","mappings":"4NAOA,SAASA,IACP,OAAOC,QADcC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,KACL,IAChBG,cACAC,QAAQ,OAAQ,IAChBA,QAAQ,SAAU,IAClBA,QAAQ,mBAAoB,IAC5BC,MACL,CAEA,SAASC,IAAwC,IAAjBC,EAAKP,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,OACtC,IACE,MAAMQ,EAAMC,aAAaC,QAAQ,0BAEjC,OADYF,EAAMG,KAAKC,MAAMJ,GAAO,CAAC,GAC1BD,IAAU,EACvB,CAAE,MAAAM,GACA,MAAO,EACT,CACF,CAEA,SAASC,EAAeC,EAAKC,GAC3B,OAAY,OAARD,QAAwBb,IAARa,EAA0BC,EAAW,4BAA8B,2BACnFD,GAAO,GAAWC,EAAW,iCAAmC,6BAChED,GAAO,GAAWC,EAAW,mCAAqC,+BAC/DA,EAAW,6BAA+B,wBACnD,CAGA,SAASC,EAAMC,GACb,MAAMC,EAAOC,IACX,GAAU,OAANA,QAAoBlB,IAANkB,EAAiB,MAAO,GAC1C,MAAMC,EAAItB,OAAOqB,GAAGhB,QAAQ,YAAa,KACzC,OAAIiB,EAAEC,SAAS,MAAQD,EAAEC,SAAS,KAAY,IAANC,OAAWF,EAAEjB,QAAQ,KAAM,MAAK,KACjEiB,GAET,OAAOH,EAAKM,IAAKC,GAAMA,EAAED,IAAIL,GAAKO,KAAK,MAAMA,KAAK,KACpD,CAGA,SAASC,EAAKC,GAAgE,IAA/D,KAAEC,EAAI,QAAEC,EAAO,MAAEC,EAAK,SAAEC,EAAQ,OAAEC,EAAM,SAAEjB,GAAW,GAAOY,EACzE,OAAKC,GAEHK,EAAAA,EAAAA,MAAA,OAAKC,UAAU,0DAAyDH,SAAA,EACtEI,EAAAA,EAAAA,KAAA,OACED,UAAU,mBACVE,MAAO,CAAEC,gBAAiBtB,EAAW,mBAAqB,oBAC1DuB,QAAST,KAEXI,EAAAA,EAAAA,MAAA,OACEC,UAAS,iEAAAZ,OAAmEP,EAAW,mDAAqD,gDAA+C,eAC3LwB,KAAK,SACL,aAAW,OACX,aAAYT,EAAMC,SAAA,EAElBE,EAAAA,EAAAA,MAAA,OAAKC,UAAU,yCAAwCH,SAAA,EACrDI,EAAAA,EAAAA,KAAA,MAAID,UAAU,wBAAuBH,SAAED,KACvCK,EAAAA,EAAAA,KAAA,UAAQG,QAAST,EAAS,aAAW,QAAQK,UAAS,GAAAZ,OAAKP,EAAW,gBAAkB,gBAAe,SAAQgB,SAAC,eAGlHI,EAAAA,EAAAA,KAAA,OAAKD,UAAU,iDAAgDH,SAAEA,IAEhEC,IAAUG,EAAAA,EAAAA,KAAA,OAAKD,UAAU,sDAAqDH,SAAEC,UArBrE,IAyBpB,CAGe,SAASQ,EAAiBC,GAAoB,IAADC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,IAAlB,MAAExC,EAAQ,MAAMmC,EACxD,MAAM,SAAE1B,EAAQ,IAAEgC,IAAQC,EAAAA,EAAAA,MACpBC,GAAWC,EAAAA,EAAAA,MACXC,EAAe7C,IAAY,OAAHyC,QAAG,IAAHA,OAAG,EAAHA,EAAKK,KAAM,QAElCC,EAASC,IAAcC,EAAAA,EAAAA,UAAS,KAChCC,EAASC,IAAcF,EAAAA,EAAAA,WAAS,IAGhCG,EAAWC,IAAgBJ,EAAAA,EAAAA,WAAS,IACpCK,EAAcC,IAAmBN,EAAAA,EAAAA,UAAS,OAGjDO,EAAAA,EAAAA,WAAU,KACR,IAAIC,GAAU,EACdC,eAAeC,IACbR,GAAW,GACX,IACE,MAAMS,EAAQC,EAAAA,IAAaA,EAAAA,EAAAA,IAAWhB,GAAgB,KAChDiB,EAAWF,aAAiBG,cAAgBH,EAAQA,EAC1D,IAAII,EAAOC,MAAMC,QAAQJ,GAAYA,EAAW,GAChD,GAAKE,GAAwB,IAAhBA,EAAKtE,OAehBsE,EAAOA,EAAK/C,IAAKC,IAACiD,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAWjD,GAAC,IAAEkD,SAAUlD,EAAEkD,UAAYlD,SAf1B,CAC9B,MAAMmD,EAAWtE,EAAuB8C,GAEtCmB,EADEK,GAAYA,EAAS3E,OAAS,EACzB2E,EAASpD,IAAKqD,IAAC,IAAAC,EAAA,MAAM,CAC1BzB,GAAIwB,EAAExB,GACN0B,SAAUF,EAAEE,UAAYF,EAAEG,SAAgB,QAAVF,EAAID,EAAEI,YAAI,IAAAH,OAAA,EAANA,EAAQC,WAAY,UACxDhD,MAAO8C,EAAE9C,OAAS8C,EAAEK,MAASL,EAAEE,UAAYF,EAAEG,OAC7CG,MAA0B,kBAAZN,EAAEM,MAAqBN,EAAEM,MAASN,EAAEM,MAAQC,OAAOP,EAAEM,OAAS,KAC5EE,UAAWR,EAAEQ,WAAaC,KAAKC,MAC/BZ,SAAUE,KAGL,EAEX,CAGIb,GAAST,EAAWgB,GAAQ,GAClC,CAAE,MAAOiB,GACP,MAAMZ,EAAWtE,EAAuB8C,GACpCY,GAAST,EAAWqB,GAAY,GACtC,CAAC,QACKZ,GAASN,GAAW,EAC1B,CACF,CAGA,SAAS+B,IACPvB,GACF,CAJAA,IAMA,IACEwB,OAAOC,iBAAiB,8BAA+BF,GACvDC,OAAOC,iBAAiB,8BAA+BF,GACvDC,OAAOC,iBAAiB,UAAWF,EACrC,CAAE,MAAAG,GAAO,CACT,MAAO,KACL5B,GAAU,EACV,IACE0B,OAAOG,oBAAoB,8BAA+BJ,GAC1DC,OAAOG,oBAAoB,8BAA+BJ,GAC1DC,OAAOG,oBAAoB,UAAWJ,EACxC,CAAE,MAAAK,GAAO,IAEV,CAAC1C,IAGJ,MAAM2C,GAAYC,EAAAA,EAAAA,SAChB,IAAM,CACJ,CAAE3C,GAAI,kBAAmB4C,MAAO,kBAAmBC,MAAO,iEAC1D,CAAE7C,GAAI,YAAa4C,MAAO,YAAaC,MAAO,8EAC9C,CAAE7C,GAAI,gBAAiB4C,MAAO,gBAAiBC,MAAO,yDACtD,CAAE7C,GAAI,iBAAkB4C,MAAO,iBAAkBC,MAAO,oEACxD,CAAE7C,GAAI,eAAgB4C,MAAO,eAAgBC,MAAO,kEACpD,CAAE7C,GAAI,aAAc4C,MAAO,aAAcC,MAAO,6EAElD,IAIIC,GAAiBH,EAAAA,EAAAA,SAAQ,KAC7B,MAAMxE,EAAM,CAAC,EASb,OARC8B,GAAW,IAAI8C,QAAS3E,IAAO,IAAD4E,EAAAC,EAAAC,EAAAC,EAC7B,MACMC,EAAM3G,EADG2B,EAAEsD,UAAYtD,EAAEuD,SAAoB,QAAdqB,EAAI5E,EAAEkD,gBAAQ,IAAA0B,OAAA,EAAVA,EAAYtB,YAAsB,QAAduB,EAAI7E,EAAEkD,gBAAQ,IAAA2B,OAAA,EAAVA,EAAYtB,UAAoB,QAAduB,EAAI9E,EAAEkD,gBAAQ,IAAA4B,GAAM,QAANC,EAAVD,EAAYtB,YAAI,IAAAuB,OAAN,EAAVA,EAAkBzB,WAAY,WAE/G2B,EAAKjF,EAAE4D,WAAa5D,EAAEiF,IAAMpB,KAAKC,QAClC/D,EAAIiF,KAASjF,EAAIiF,GAAKpB,WAAa,GAAKqB,KAC3ClF,EAAIiF,IAAI/B,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAQjD,GAAC,IAAEkF,mBAAoBF,EAAKpB,UAAWqB,OAGpDlF,GACN,CAAC8B,IAGEsD,GAAYZ,EAAAA,EAAAA,SAAQ,IACjBD,EAAUvE,IAAKH,IAAO,IAADwF,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAC1B,MAAMC,EAAMzH,EAAauB,EAAEgC,IACrBmE,EAAMrB,EAAeoB,GACrBpC,EACJqC,IAA6B,kBAAdA,EAAIrC,MAAqBqC,EAAIrC,MAASqC,EAAIrC,MAAQC,OAAOoC,EAAIrC,OAAUqC,EAAI7C,UAA0C,kBAAvB6C,EAAI7C,SAASQ,MAAqBqC,EAAI7C,SAASQ,MAAQ,MAEhKsC,EAAmE,QAA3DZ,EAA0B,QAA1BC,EAAM,OAAHU,QAAG,IAAHA,GAAa,QAAVT,EAAHS,EAAK7C,gBAAQ,IAAAoC,OAAV,EAAHA,EAAeU,gBAAQ,IAAAX,EAAAA,EAAO,OAAHU,QAAG,IAAHA,GAAa,QAAVR,EAAHQ,EAAK7C,gBAAQ,IAAAqC,GAAM,QAANC,EAAbD,EAAe/B,YAAI,IAAAgC,OAAhB,EAAHA,EAAqBQ,gBAAQ,IAAAZ,EAAAA,EAAI,KACvEa,EAA0D,QAArDR,EAAuB,QAAvBC,EAAM,OAAHK,QAAG,IAAHA,GAAa,QAAVJ,EAAHI,EAAK7C,gBAAQ,IAAAyC,OAAV,EAAHA,EAAeM,aAAK,IAAAP,EAAAA,EAAO,OAAHK,QAAG,IAAHA,GAAa,QAAVH,EAAHG,EAAK7C,gBAAQ,IAAA0C,GAAM,QAANC,EAAbD,EAAepC,YAAI,IAAAqC,OAAhB,EAAHA,EAAqBI,aAAK,IAAAR,EAAAA,EAAI,KAC9DS,EAA2B,MAAZF,GAA6B,MAATC,GAAiBA,EAAQ,EAAKE,KAAKC,MAAOJ,EAAWC,EAAS,KAAO,KAC9G,MAAO,CAAErE,GAAIkE,EAAKtB,MAAO5E,EAAE4E,MAAOC,MAAO7E,EAAE6E,MAAOf,MAAgB,MAATA,GAAkBC,OAAO0C,MAAM3C,GAA6B,KAApByC,KAAKC,MAAM1C,GAAe4C,OAAQP,GAAO,KAAMG,iBAEjJ,CAAC5B,EAAWI,IAGT6B,GAAYhC,EAAAA,EAAAA,SAAQ,KACxB,MACMiC,EADOrB,EAAUpF,IAAK0G,GAAmB,OAAZA,EAAE/C,YAA8BjF,IAAZgI,EAAE/C,MAAsB,KAAO+C,EAAE/C,OACvEgD,OAAQ/G,GAAY,OAANA,QAAoBlB,IAANkB,GAC7C,OAAmB,IAAf6G,EAAIhI,OAAqB,KACtB2H,KAAKC,MAAMI,EAAIG,OAAO,CAAC/G,EAAGD,IAAMC,EAAID,EAAG,GAAK6G,EAAIhI,SACtD,CAAC2G,IAGEyB,GAAmBrC,EAAAA,EAAAA,SAAQ,KAC/B,IAAK1C,GAA8B,IAAnBA,EAAQrD,OAAc,MAAO,GAC7C,MAAMqI,EAAQ,CAAC,EACfhF,EAAQ8C,QAAS3E,IACf,MAAM8G,EAAM,IAAIjD,KAAK7D,EAAE4D,WAAaC,KAAKC,OACzCgD,EAAIC,SAAS,EAAG,EAAG,EAAG,GACtB,MAAMC,EAAIF,EAAIG,UACTJ,EAAMG,KAAIH,EAAMG,GAAK,IAC1B,MAAME,EAAwB,kBAAZlH,EAAE0D,MAAqB1D,EAAE0D,MAAS1D,EAAE0D,MAAQC,OAAO3D,EAAE0D,OAAS,KACrE,OAAPwD,QAAsBzI,IAAPyI,GAAqBvD,OAAO0C,MAAMa,IAAKL,EAAMG,GAAGG,KAAKD,KAM1E,OAJgBE,OAAOC,KAAKR,GACzB9G,IAAKiH,IAAC,CAAQM,EAAG3D,OAAOqD,GAAIO,IAAKpB,KAAKC,MAAMS,EAAMG,GAAGL,OAAO,CAACvD,EAAGoE,IAAMpE,EAAIoE,EAAG,GAAKX,EAAMG,GAAGxI,WAC3FiJ,KAAK,CAACrE,EAAGoE,IAAMpE,EAAEkE,EAAIE,EAAEF,GACvBI,OAAO,IACK3H,IAAKgE,GAAMA,EAAEwD,MAC3B,CAAC1F,IAGJ,SAAS8F,IAAwC,IAAhBC,EAAMrJ,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,KACxC,IAAK,IAADsJ,EACF,MAAMC,EAAUF,IAAmB/F,GAAW,IACxCkG,EAAO,IAAIC,KAAK,CAAC9I,KAAK+I,UAAUH,EAAS,KAAM,IAAK,CAAEI,KAAM,qBAC5DC,EAAMC,IAAIC,gBAAgBN,GAC1B3E,EAAIkF,SAASC,cAAc,KACjCnF,EAAEoF,KAAOL,EACT/E,EAAEqF,SAAiB,GAAA3I,OAAN8H,GAA4B,QAAfC,EAAAD,EAAO1E,gBAAQ,IAAA2E,OAAA,EAAfA,EAAiBvH,QAASsH,EAAOhG,IAAM,SAAiCL,GAAOA,EAAIkC,MAAS9B,EAA7C,mBACzE2G,SAASI,KAAKC,YAAYvF,GAC1BA,EAAEwF,QACFxF,EAAEyF,SACFC,WAAW,IAAMV,IAAIW,gBAAgBZ,GAAM,IAC7C,CAAE,MAAAa,GACAC,MAAM,gBACR,CACF,CAEA,SAASC,IAAuC,IAAhBtB,EAAMrJ,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,KACvC,IACE,GAAIqJ,EAAQ,CAAC,IAADuB,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EACV,MAAMxJ,EAAI4H,EAaJ6B,EAAMjK,EAJC,CAPE,CACb,SACA,QACA,YACA,QACA,SAIA,CAACQ,EAAEkF,oBAAsBlF,EAAEsD,UAAY,GAAW,QAAT6F,EAAEnJ,EAAE0D,aAAK,IAAAyF,EAAAA,EAAI,GAAI,IAAItF,KAAK7D,EAAE4D,YAAuB,QAAdwF,EAAIpJ,EAAEkD,gBAAQ,IAAAkG,OAAA,EAAVA,EAAYxF,YAAaC,KAAKC,OAAO4F,eAAyB,QAAVL,EAAArJ,EAAEkD,gBAAQ,IAAAmG,OAAA,EAAVA,EAAY/I,QAASN,EAAEM,OAAS,KAAe,QAAVgJ,EAAAtJ,EAAEkD,gBAAQ,IAAAoG,OAAA,EAAVA,EAAYK,SAAmB,QAAdJ,EAAIvJ,EAAEkD,gBAAQ,IAAAqG,OAAA,EAAVA,EAAYK,UAAW,IAAIjL,QAAQ,MAAO,QAGtOoJ,EAAO,IAAIC,KAAK,CAACyB,GAAM,CAAEvB,KAAM,aAC/BC,EAAMC,IAAIC,gBAAgBN,GAC1B3E,EAAIkF,SAASC,cAAc,KAOjC,OANAnF,EAAEoF,KAAOL,EACT/E,EAAEqF,SAAQ,GAAA3I,QAAiB,QAAV0J,EAAAxJ,EAAEkD,gBAAQ,IAAAsG,OAAA,EAAVA,EAAYlJ,QAASN,EAAEkF,oBAAsBlF,EAAE4B,GAAE,kBAClE0G,SAASI,KAAKC,YAAYvF,GAC1BA,EAAEwF,QACFxF,EAAEyF,cACFC,WAAW,IAAMV,IAAIW,gBAAgBZ,GAAM,KAE7C,CAEA,MAAM1I,EAAO,CAAC,CAAC,SAAU,QAAS,YAAa,WAC9CoC,GAAW,IAAI8C,QAAS3E,IAAO,IAAD6J,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAC7B,MAAMC,EAAM/L,EAAa2B,EAAEsD,UAAYtD,EAAEuD,SAAoB,QAAdsG,EAAI7J,EAAEkD,gBAAQ,IAAA2G,OAAA,EAAVA,EAAYvG,YAAsB,QAAdwG,EAAI9J,EAAEkD,gBAAQ,IAAA4G,OAAA,EAAVA,EAAYvG,SAAU,WAC3FG,EAAoC,QAA/BqG,EAAU,QAAVC,EAAGhK,EAAE0D,aAAK,IAAAsG,EAAAA,EAAc,QAAdC,EAAIjK,EAAEkD,gBAAQ,IAAA+G,OAAA,EAAVA,EAAYvG,aAAK,IAAAqG,EAAAA,EAAI,GACxC9E,EAAK,IAAIpB,KAAK7D,EAAE4D,YAAuB,QAAdsG,EAAIlK,EAAEkD,gBAAQ,IAAAgH,OAAA,EAAVA,EAAYtG,YAAaC,KAAKC,OAAO4F,cAClEpJ,GAAkB,QAAV6J,EAAAnK,EAAEkD,gBAAQ,IAAAiH,OAAA,EAAVA,EAAY7J,QAASN,EAAEM,OAAS,GAC9Cb,EAAK0H,KAAK,CAACiD,EAAK1G,EAAOuB,EAAI3E,MAE7B,MAAMmJ,EAAMjK,EAAMC,GACZsI,EAAO,IAAIC,KAAK,CAACyB,GAAM,CAAEvB,KAAM,aAC/BC,EAAMC,IAAIC,gBAAgBN,GAC1B3E,EAAIkF,SAASC,cAAc,KACjCnF,EAAEoF,KAAOL,EACT/E,EAAEqF,SAAQ,GAAA3I,OAAOyB,GAAOA,EAAIkC,MAAS9B,EAAY,kBACjD2G,SAASI,KAAKC,YAAYvF,GAC1BA,EAAEwF,QACFxF,EAAEyF,SACFC,WAAW,IAAMV,IAAIW,gBAAgBZ,GAAM,IAC7C,CAAE,MAAAkC,GACApB,MAAM,oBACR,CACF,CAEA,SAASqB,IAA4B,IAADC,EAAAC,EAAA,IAAf5C,EAAMrJ,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,KAE5B,MAAMuJ,EAAUF,GAAkB,CAAErB,YAAWkE,QAAStF,GAClDuF,EAAI,+jBAAA5K,OAc2ByB,GAAOA,EAAIkC,MAAS9B,EAAY,mDAAA7B,QAC/B,IAAI+D,MAAO8G,iBAAgB,mEAAA7K,OACK,QADLyK,EACZzC,EAAQvB,iBAAS,IAAAgE,EAAAA,EAAK3C,GAAsB,QAAhB4C,EAAI5C,EAAOlE,aAAK,IAAA8G,EAAAA,EAAW,SAAG,sBAAA1K,OACvG8H,EAAM,eAAA9H,OAAkB8H,EAAO1C,oBAAsB0C,EAAOtE,UAAYsE,EAAOhG,GAAE,6CAAA9B,OACzDZ,KAAK+I,UAAUL,EAAQ,KAAM,GAAE,uEAAA9H,OAC/BZ,KAAK+I,UAAU9C,EAAW,KAAM,GAAE,gBAAc,0CAI1EyF,EAAI3G,OAAO7D,KAAK,GAAI,SAAU,uBACpC,IAAKwK,EAAG,OAAO3B,MAAM,iBACrB2B,EAAEtC,SAASuC,MAAMH,GACjBE,EAAEtC,SAASwC,QACXF,EAAEG,OAEJ,CAGA,SAASC,EAASC,GAAgC,IAA/B,OAAEC,EAAS,GAAE,OAAEC,EAAS,IAAIF,EAC7C,IAAKC,GAA4B,IAAlBA,EAAO1M,OAAc,OAAOmC,EAAAA,EAAAA,KAAA,OAAKD,UAAU,wBAAuBH,SAAC,eAClF,MAAM6K,EAAMjF,KAAKiF,OAAOF,GAClBG,EAAMlF,KAAKkF,OAAOH,GAClBI,EAAWnF,KAAKiF,IAAI,EAAGF,EAAO1M,QAC9BoM,EAAIzE,KAAKiF,IAAI,IAAgB,EAAXE,GACxB,OACE3K,EAAAA,EAAAA,KAAA,OAAKD,UAAU,SAAQH,UACrBI,EAAAA,EAAAA,KAAA,OACE4K,MAAM,OACNJ,OAAQA,EACRK,QAAO,OAAA1L,OAAS8K,EAAC,KAAA9K,OAAIqL,GACrBM,oBAAoB,gBACpB/K,UAAU,gBACVE,MAAO,CAAE8K,QAAS,SAAUnL,SAE3B2K,EAAOnL,IAAI,CAACJ,EAAGgM,KACd,MAAMC,EAAID,GAAKf,EAAIM,EAAO1M,QACpBqN,EAAIT,IAAQC,EAAe,GAATF,GAAiBxL,EAAI0L,IAAQD,EAAMC,GAAO,IAAOF,EAAS,GAAK,EACjFW,EAAO3F,KAAKiF,IAAI,EAAGR,EAAIM,EAAO1M,OAAS,GAC7C,OACEmC,EAAAA,EAAAA,KAAA,QAEEiL,EAAGA,EAAI,EACPG,EAAGZ,EAASU,EACZN,MAAOO,EACPX,OAAQU,EACRG,GAAI,EACJtL,UAAWnB,EAAW,aAAe,aACrCqB,MAAO,CAAEqL,KAAM,YAPVN,QAcnB,CAKA,MAAMO,EAAkB,CACtB,oBACA,iBACA,eACA,aACA,UACA,aACA,WACA,YACA,YACA,mBACA,aACA,OACA,aACA,SACA,YACA,cACA,QACA,SACA,gBAIF,SAASC,EAAYC,GAA2B,IAADC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,IAAzB,YAAEC,EAAW,OAAE1G,GAAQ8F,EAC3C,MAAM1I,EAAgD,QAA3C2I,EAAgB,QAAhBC,EAAS,OAANhG,QAAM,IAANA,OAAM,EAANA,EAAQ5C,aAAK,IAAA4I,EAAAA,EAAU,OAANhG,QAAM,IAANA,GAAgB,QAAViG,EAANjG,EAAQpD,gBAAQ,IAAAqJ,OAAV,EAANA,EAAkB7I,aAAK,IAAA2I,EAAAA,EAAI,KACpDpH,GAAW,OAANqB,QAAM,IAANA,OAAM,EAANA,EAAQ1C,aAAmB,OAAN0C,QAAM,IAANA,GAAgB,QAAVkG,EAANlG,EAAQpD,gBAAQ,IAAAsJ,OAAV,EAANA,EAAkB5I,aAAmB,OAAN0C,QAAM,IAANA,GAAgB,QAAVmG,EAANnG,EAAQpD,gBAAQ,IAAAuJ,OAAV,EAANA,EAAkBxH,KAAM,KACjF/B,GAAiB,OAANoD,QAAM,IAANA,OAAM,EAANA,EAAQpD,WAAY,CAAC,EAEhCyG,IADsB,OAARzG,QAAQ,IAARA,OAAQ,EAARA,EAAU+J,eAAuB,OAAR/J,QAAQ,IAARA,GAAc,QAANwJ,EAARxJ,EAAUM,YAAI,IAAAkJ,GAAdA,EAAgBO,cACvC,OAAR/J,QAAQ,IAARA,OAAQ,EAARA,EAAUyG,SAAiB,OAARzG,QAAQ,IAARA,GAAc,QAANyJ,EAARzJ,EAAUM,YAAI,IAAAmJ,OAAN,EAARA,EAAgBhD,SAAiB,OAARzG,QAAQ,IAARA,OAAQ,EAARA,EAAU0G,UAAW,IAGzEsD,EAAa,MACjB,MACMC,EADYhI,EAAUpF,IAAK0G,GAAmB,OAAZA,EAAE/C,YAA8BjF,IAAZgI,EAAE/C,OAAuB,EAAI+C,EAAE/C,OACnEgD,OAAQ9G,GAAMA,GAAK,GAC3C,IAAKuN,EAAM3O,OAAQ,MAAO,CAAE4O,KAAM,SAAKnH,MAAOd,EAAU3G,QAGxD,MAAO,CAAE4O,KAFMD,EAAMzF,QAAQD,KAAK,CAACrE,EAAGoE,IAAMA,EAAIpE,GAC7BiK,QAAQ3J,GAAS,GAAK,SACrBuC,MAAOkH,EAAM3O,OAClC,EAPkB,GAUb8O,GAAmB,OAARpK,QAAQ,IAARA,GAAc,QAAN0J,EAAR1J,EAAUM,YAAI,IAAAoJ,OAAN,EAARA,EAAgBU,YAAoB,OAARpK,QAAQ,IAARA,OAAQ,EAARA,EAAUoK,WAAY,CAAC,kBAADxN,OAC/C4D,GAAS,GAAK,gCAAkC,+BAA6B,oBAAA5D,OAC3E4D,EAAQ,GAAK,kCAAoC,2CAGjE6J,GAAoB,OAARrK,QAAQ,IAARA,GAAc,QAAN2J,EAAR3J,EAAUM,YAAI,IAAAqJ,OAAN,EAARA,EAAgBU,aAAqB,OAARrK,QAAQ,IAARA,OAAQ,EAARA,EAAUqK,YAAa,CACpE,CAAEC,QAAS,UAAWC,KAAM,kDAC5B,CAAED,QAAS,WAAYC,KAAM,+CAC7B,CAAED,QAAS,YAAaC,KAAM,sDAI1BC,GAAqB,OAARxK,QAAQ,IAARA,GAAc,QAAN4J,EAAR5J,EAAUM,YAAI,IAAAsJ,OAAN,EAARA,EAAgBa,kBAAmB,CACpD,CAAErN,MAAO,QAASsN,MAAO,CAAC,2CAA4C,iDACtE,CAAEtN,MAAO,MAAOsN,MAAO,CAAC,4BAA6B,8BACrD,CAAEtN,MAAO,OAAQsN,MAAO,CAAC,gDAAiD,6CAItEC,GAAoB,OAAR3K,QAAQ,IAARA,GAAc,QAAN6J,EAAR7J,EAAUM,YAAI,IAAAuJ,OAAN,EAARA,EAAgBc,YAAa,CAC7CC,QAAS,0BACTlE,QAAS,gHACTtD,OAAQ,0EAIJyH,GAA0B,OAAR7K,QAAQ,IAARA,OAAQ,EAARA,EAAU8K,aAAc,KAEhD,OACEvN,EAAAA,EAAAA,MAAA,OAAKC,UAAU,YAAWH,SAAA,EACxBE,EAAAA,EAAAA,MAAA,OAAKC,UAAU,yCAAwCH,SAAA,EACrDE,EAAAA,EAAAA,MAAA,OAAAF,SAAA,EACEE,EAAAA,EAAAA,MAAA,OAAKC,UAAU,6BAA4BH,SAAA,CAAC,UACxB,OAAVmD,EAAc,GAAA5D,OAAM4D,EAAK,KAAM,SAAI,IAAEuB,IAAMxE,EAAAA,EAAAA,MAAA,QAAMC,UAAU,OAAMH,SAAA,CAAC,kBAAa,IAAIsD,KAAKoB,GAAI0F,wBAEtGlK,EAAAA,EAAAA,MAAA,OAAKC,UAAU,6BAA4BH,SAAA,CAAC,YAAU2M,EAAWE,KAAK,IAAEF,EAAWjH,aAGrFxF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,0BAAyBH,SAAA,EACtCI,EAAAA,EAAAA,KAAA,UAAQG,QAASA,IAAM6G,GAAW,EAAOrB,GAAS5F,UAAU,sCAAqCH,SAAC,iBAClGI,EAAAA,EAAAA,KAAA,UAAQG,QAASA,IAAMoI,GAAU,EAAO5C,GAAS5F,UAAU,sCAAqCH,SAAC,gBACjGI,EAAAA,EAAAA,KAAA,UAAQG,QAASA,IAAMwJ,EAAYhE,GAAS5F,UAAU,sCAAqCH,SAAC,uBAKhGE,EAAAA,EAAAA,MAAA,OAAAF,SAAA,EACEI,EAAAA,EAAAA,KAAA,MAAID,UAAU,gBAAeH,SAAC,yBAC9BI,EAAAA,EAAAA,KAAA,OAAKD,UAAU,6CAA4CH,SACxD2L,EAAgBnM,IAAKkO,IACpBxN,EAAAA,EAAAA,MAAA,OAAaC,UAAS,0BAAAZ,OAA4BP,EAAW,qCAAuC,qCAAsCgB,SAAA,EACxII,EAAAA,EAAAA,KAAA,OAAKD,UAAU,cAAaH,SAAE0N,KAC9BtN,EAAAA,EAAAA,KAAA,OAAKD,UAAU,6BAA4BH,SAAGwN,GAAyC,MAAtBA,EAAgBE,GAAU,GAAAnO,OAAOqG,KAAKC,MAAM2H,EAAgBE,IAAG,KAAM,aAF9HA,UAShBxN,EAAAA,EAAAA,MAAA,OAAAF,SAAA,EACEI,EAAAA,EAAAA,KAAA,MAAID,UAAU,gBAAeH,SAAC,iBAC9BE,EAAAA,EAAAA,MAAA,OAAKC,UAAU,6BAA4BH,SAAA,CAAC,iBAC7BE,EAAAA,EAAAA,MAAA,UAAAF,SAAA,CAAS2M,EAAWE,KAAK,IAAEF,EAAWjH,SAAe,IACjE8H,EAAkB,0CAA4C,8CAKnEtN,EAAAA,EAAAA,MAAA,OAAAF,SAAA,EACEI,EAAAA,EAAAA,KAAA,MAAID,UAAU,gBAAeH,SAAC,iBAC9BI,EAAAA,EAAAA,KAAA,OAAKD,UAAU,iBAAgBH,SAC5B+M,EAASvN,IAAI,CAACmO,EAAKvC,KAAMhL,EAAAA,EAAAA,KAAA,OAAaD,UAAS,kBAAAZ,OAAoBP,EAAW,qCAAuC,qCAAsCgB,SAAE2N,GAA1HvC,UAKxClL,EAAAA,EAAAA,MAAA,OAAAF,SAAA,EACEI,EAAAA,EAAAA,KAAA,MAAID,UAAU,gBAAeH,SAAC,yCAC9BE,EAAAA,EAAAA,MAAA,OAAKC,UAAS,kBAAAZ,OAAoBP,EAAW,0CAA4C,uCAAwCgB,SAAA,EAC/HI,EAAAA,EAAAA,KAAA,OAAKD,UAAU,cAAaH,SAAEsN,EAAUC,WACxCnN,EAAAA,EAAAA,KAAA,OAAKD,UAAU,eAAcH,SAAEsN,EAAUjE,WACzCjJ,EAAAA,EAAAA,KAAA,OAAKD,UAAU,2BAA0BH,SAAC,aAC1CI,EAAAA,EAAAA,KAAA,OAAKD,UAAU,UAASH,SAAEsN,EAAUvH,gBAKxC7F,EAAAA,EAAAA,MAAA,OAAAF,SAAA,EACEI,EAAAA,EAAAA,KAAA,MAAID,UAAU,gBAAeH,SAAC,kBAC9BI,EAAAA,EAAAA,KAAA,OAAKD,UAAU,iBAAgBH,SAC5BgN,EAAUxN,IAAI,CAACoO,EAAGxC,KACjBlL,EAAAA,EAAAA,MAAA,OAAaC,UAAS,kBAAAZ,OAAoBP,EAAW,qCAAuC,qCAAsCgB,SAAA,EAChII,EAAAA,EAAAA,KAAA,OAAKD,UAAU,cAAaH,SAAE4N,EAAEX,WAChC7M,EAAAA,EAAAA,KAAA,OAAKD,UAAU,6BAA4BH,SAAE4N,EAAEV,SAFvC9B,UAShBlL,EAAAA,EAAAA,MAAA,OAAAF,SAAA,EACEI,EAAAA,EAAAA,KAAA,MAAID,UAAU,gBAAeH,SAAC,gCAC9BI,EAAAA,EAAAA,KAAA,OAAKD,UAAU,iBAAgBH,SAC5BmN,EAAW3N,IAAI,CAACC,EAAG2L,KAClBlL,EAAAA,EAAAA,MAAA,OAAaC,UAAS,kBAAAZ,OAAoBP,EAAW,wCAA0C,qCAAsCgB,SAAA,EACnII,EAAAA,EAAAA,KAAA,OAAKD,UAAU,cAAaH,SAAEP,EAAEM,SAChCK,EAAAA,EAAAA,KAAA,MAAID,UAAU,8BAA6BH,SACxCP,EAAE4N,MAAM7N,IAAI,CAACqO,EAAIC,KAAM1N,EAAAA,EAAAA,KAAA,MAAAJ,SAAa6N,GAAJC,QAH3B1C,SAUfhC,IACClJ,EAAAA,EAAAA,MAAA,OAAAF,SAAA,EACEI,EAAAA,EAAAA,KAAA,MAAID,UAAU,gBAAeH,SAAC,0BAC9BI,EAAAA,EAAAA,KAAA,OAAKD,UAAU,iDAAgDH,SAAEoJ,SAK3E,CAGA,SAAS2E,EAAYC,GAA0B,IAAzB,YAAEvB,EAAW,MAAEvI,GAAO8J,EAC1C,OACE9N,EAAAA,EAAAA,MAAA,OAAKC,UAAU,YAAWH,SAAA,EACxBE,EAAAA,EAAAA,MAAA,OAAAF,SAAA,EACEE,EAAAA,EAAAA,MAAA,MAAIC,UAAU,wBAAuBH,SAAA,CAAC,2BAAyByM,MAC/DrM,EAAAA,EAAAA,KAAA,OAAKD,UAAU,6BAA4BH,SAAC,gDAG9CE,EAAAA,EAAAA,MAAA,OAAKC,UAAS,kBAAAZ,OAAoBP,EAAW,qCAAuC,qCAAsCgB,SAAA,EACxHI,EAAAA,EAAAA,KAAA,OAAKD,UAAU,wBAAuBH,SAAEkE,KACxChE,EAAAA,EAAAA,MAAA,MAAIC,UAAU,4CAA2CH,SAAA,EACvDI,EAAAA,EAAAA,KAAA,MAAAJ,SAAI,sEACJI,EAAAA,EAAAA,KAAA,MAAAJ,SAAI,kEACJI,EAAAA,EAAAA,KAAA,MAAAJ,SAAI,8EAIRE,EAAAA,EAAAA,MAAA,OAAAF,SAAA,EACEI,EAAAA,EAAAA,KAAA,KAAGD,UAAU,wBAAuBH,SAAC,+JACrCI,EAAAA,EAAAA,KAAA,OAAKD,UAAU,OAAMH,UACnBI,EAAAA,EAAAA,KAAA,UACEG,QAASA,KACP,IAAMmD,OAAOuK,cAAc,IAAIC,YAAY,2BAA4B,CAAEC,OAAQ,CAAEpL,SAAU0J,EAAalO,MAAO6C,KAAoB,CAAE,MAAAgN,GAAO,CAC9IlN,EAAS,oBACTU,GAAa,IAEfzB,UAAU,+EAA8EH,SACzF,iDAOX,CAiBA,OACEE,EAAAA,EAAAA,MAAA,OAAKC,UAAS,mBAAAZ,OAAqBP,EAAW,yFAA2F,iDAAkDgB,SAAA,EACzLI,EAAAA,EAAAA,KAAA,SAAAJ,SAAA,wHAEAE,EAAAA,EAAAA,MAAA,OAAKC,UAAU,yCAAwCH,SAAA,EACrDE,EAAAA,EAAAA,MAAA,OAAKC,UAAU,0BAAyBH,SAAA,EAEtCI,EAAAA,EAAAA,KAAA,OAAKD,UAAU,gCAA+BH,UAC5CI,EAAAA,EAAAA,KAACiO,EAAAA,IAAU,CAAClO,UAAU,qDAExBD,EAAAA,EAAAA,MAAA,OAAAF,SAAA,EACEI,EAAAA,EAAAA,KAAA,OAAKD,UAAU,wBAAuBH,SAAC,2BACvCI,EAAAA,EAAAA,KAAA,OAAKD,UAAS,WAAAZ,OAAaP,EAAW,gBAAkB,iBAAkBgB,SAAC,8CAI/EI,EAAAA,EAAAA,KAAA,OAAKD,UAAU,0BAAyBH,UACtCE,EAAAA,EAAAA,MAAA,OAAKC,UAAU,mEAAkEH,SAAA,EAC/EI,EAAAA,EAAAA,KAAA,UAAQG,QAASA,IAAM6G,GAAW,GAAOjH,UAAS,qBAAAZ,OAAuBP,EAAW,4CAA8C,iDAAmDe,MAAM,oBAAmBC,SAAC,UAC/MI,EAAAA,EAAAA,KAAA,UAAQG,QAASA,IAAMoI,GAAU,GAAOxI,UAAS,qBAAAZ,OAAuBP,EAAW,4CAA8C,iDAAmDe,MAAM,mBAAkBC,SAAC,SAC7MI,EAAAA,EAAAA,KAAA,UAAQG,QAASA,IAAMwJ,EAAY,MAAO5J,UAAS,qBAAAZ,OAAuBP,EAAW,4CAA8C,iDAAmDe,MAAM,cAAaC,SAAC,mBAMhNE,EAAAA,EAAAA,MAAA,OAAKC,UAAU,2DAA0DH,SAAA,EACvEI,EAAAA,EAAAA,KAAA,OAAKD,UAAU,gBAAeH,UAC5BE,EAAAA,EAAAA,MAAA,OAAKC,UAAU,0BAAyBH,SAAA,EACtCE,EAAAA,EAAAA,MAAA,OAAAF,SAAA,EACEI,EAAAA,EAAAA,KAAA,OAAKD,UAAU,wBAAuBH,SAAC,qBACvCI,EAAAA,EAAAA,KAAA,OAAKD,UAAU,0BAAyBH,SAAEyB,EAAU,SAAoB,OAAduE,EAAkB,GAAAzG,OAAMyG,EAAS,KAAM,YACjG5F,EAAAA,EAAAA,KAAA,OAAKD,UAAS,gBAAAZ,OAAkBP,EAAW,gBAAkB,iBAAkBgB,SAAEsB,GAAWA,EAAQrD,OAAM,GAAAsB,OAAM+B,EAAQrD,OAAM,eAAgB,oBAGhJmC,EAAAA,EAAAA,KAAA,OAAKD,UAAU,iCAMnBC,EAAAA,EAAAA,KAAA,OAAKD,UAAU,8CAA6CH,UAE1DE,EAAAA,EAAAA,MAAA,OAAKC,UAAU,uBAAsBH,SAAA,EACnCI,EAAAA,EAAAA,KAAA,OAAKD,UAAS,gBAAAZ,OAAkBP,EAAW,2BAA6B,4BAA6BgB,SAAC,kBACtGI,EAAAA,EAAAA,KAAA,OAAKD,UAAS,2BAAAZ,OAA6BP,EAAW,iBAAmB,cAAegB,UACtFI,EAAAA,EAAAA,KAACqK,EAAS,CAACE,OAAQtE,EAAkBuE,OAAQ,gBAMrDxK,EAAAA,EAAAA,KAAA,OAAKD,UAAU,8BAA6BH,SACzC4E,EAAUpF,IAAK0G,IAAC,IAAAoI,EAAA,OACfpO,EAAAA,EAAAA,MAAA,OAAgBC,UAAS,uDAAAZ,OAAyDP,EAAW,qCAAuC,qCAAsCgB,SAAA,EACxKE,EAAAA,EAAAA,MAAA,OAAKC,UAAU,UAASH,SAAA,EACtBE,EAAAA,EAAAA,MAAA,OAAKC,UAAU,0BAAyBH,SAAA,EACtCI,EAAAA,EAAAA,KAAA,OAAKD,UAAS,6CAAAZ,OAA+CT,EAAeoH,EAAE/C,MAAOnE,IAAYgB,SAAEkG,EAAEjC,SACrG7D,EAAAA,EAAAA,KAAA,OAAKD,UAAS,oBAAAZ,OAAsBP,EAAW,gBAAkB,iBAAkBgB,SACpE,OAAZkG,EAAE/C,MAAc,GAAA5D,OAAM2G,EAAE/C,MAAK,MAAM/C,EAAAA,EAAAA,KAAA,QAAMD,UAAU,wBAAuBH,SAAC,8BAK9D,MAAjBkG,EAAEP,aACDzF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,OAAMH,SAAA,EACnBE,EAAAA,EAAAA,MAAA,OAAKC,UAAU,6BAA4BH,SAAA,CAAEkG,EAAEP,YAAY,iBAC3DvF,EAAAA,EAAAA,KAAA,OAAKD,UAAS,2BAAAZ,OAA6BP,EAAW,cAAgB,eAAgBgB,UACpFI,EAAAA,EAAAA,KAAA,OAAKC,MAAO,CAAE2K,MAAM,GAADzL,OAAKqG,KAAKiF,IAAI,EAAGjF,KAAKkF,IAAI,IAAK5E,EAAEP,cAAa,MAAOxF,UAAU,0EAGxE,OAAZ+F,EAAE/C,OAEJjD,EAAAA,EAAAA,MAAA,OAAKC,UAAU,OAAMH,SAAA,EACnBI,EAAAA,EAAAA,KAAA,OAAKD,UAAU,6BAA4BH,SAAC,oBAC5CI,EAAAA,EAAAA,KAAA,OAAKD,UAAS,2BAAAZ,OAA6BP,EAAW,cAAgB,eAAgBgB,UACpFI,EAAAA,EAAAA,KAAA,OAAKC,MAAO,CAAE2K,MAAM,GAADzL,OAAKqG,KAAKiF,IAAI,EAAGjF,KAAKkF,IAAI,IAAK5E,EAAE/C,QAAO,MAAOhD,UAAU,2EAIhFC,EAAAA,EAAAA,KAAA,OAAKD,UAAU,6BAA4BH,SAAC,qFAIhDE,EAAAA,EAAAA,MAAA,OAAKC,UAAU,gCAA+BH,SAAA,EAC5CE,EAAAA,EAAAA,MAAA,OAAKC,UAAU,0BAAyBH,SAAA,EACtCI,EAAAA,EAAAA,KAAA,UACEG,QAASA,IArGzB,SAAyBwC,GACvB,MAAMwE,EAAU,CAAExE,WAAUgD,OAAQ5B,EAAepB,IAAa,MAChEjB,EAAgByF,GAChB3F,GAAa,EACf,CAiG+B2M,CAAgBrI,EAAE7E,IACjClB,UAAS,uCAAAZ,OAAyCP,EAAW,4CAA8C,iDAC3Ge,MAAmB,OAAZmG,EAAE/C,MAAiB,wBAA0B,wEACpD,qBAAA5D,OAAoB2G,EAAEjC,OAAQjE,UAE9BI,EAAAA,EAAAA,KAACoO,EAAAA,IAAK,MAGK,OAAZtI,EAAE/C,QACD/C,EAAAA,EAAAA,KAAA,UACEG,QAASA,IAzG3B,SAA0BwC,GACxB,IACEW,OAAOuK,cAAc,IAAIC,YAAY,2BAA4B,CAAEC,OAAQ,CAAEpL,WAAUxE,MAAO6C,KAChG,CAAE,MAAAqN,GAAO,CACTvN,EAAS,mBACX,CAoGiCwN,CAAiBxI,EAAE7E,IAClClB,UAAU,wDACVJ,MAAK,QAAAR,OAAU2G,EAAEjC,MAAK,eAAcjE,SACrC,wBAMLI,EAAAA,EAAAA,KAAA,OAAKD,UAAU,wBAAuBH,SAAU,QAARsO,EAAApI,EAAEH,cAAM,IAAAuI,GAARA,EAAUjL,UAAY,IAAIC,KAAK4C,EAAEH,OAAO1C,WAAWsL,qBAAoC,OAAZzI,EAAE/C,MAAiB,eAAiB,gBApDjJ+C,EAAE7E,SA0DhBjB,EAAAA,EAAAA,KAAA,OAAKD,UAAU,6BAA4BH,SAAC,8JAG5CI,EAAAA,EAAAA,KAACT,EAAK,CACJE,KAAM8B,EACN7B,QAASA,KACP8B,GAAa,GACbE,EAAgB,OAElB/B,MAAO8B,EAAgBA,EAAakE,OAAM,iBAAAxG,SAAsF,QAAjEoB,EAAAoD,EAAU6K,KAAKlB,GAAK5P,EAAa4P,EAAErM,MAAQQ,EAAakB,iBAAS,IAAApC,OAAA,EAAjEA,EAAmEsD,QAASpC,EAAakB,UAAU8L,cAAa,4BAAAtP,SAA+F,QAAjEqB,EAAAmD,EAAU6K,KAAKlB,GAAK5P,EAAa4P,EAAErM,MAAQQ,EAAakB,iBAAS,IAAAnC,OAAA,EAAjEA,EAAmEqD,QAASpC,EAAakB,UAAU8L,cAAa,uBAAoB,SACjV7P,SAAUA,EACViB,OACE4B,EACEA,EAAakE,QACX7F,EAAAA,EAAAA,MAAA4O,EAAAA,SAAA,CAAA9O,SAAA,EACEI,EAAAA,EAAAA,KAAA,UAAQG,QAASA,IAAM6G,GAAW,EAAOvF,EAAakE,QAAS5F,UAAU,8BAA6BH,SAAC,UACvGI,EAAAA,EAAAA,KAAA,UAAQG,QAASA,IAAMoI,GAAU,EAAO9G,EAAakE,QAAS5F,UAAU,8BAA6BH,SAAC,SACtGI,EAAAA,EAAAA,KAAA,UAAQG,QAASA,IAAMwJ,EAAYlI,EAAakE,QAAS5F,UAAU,8BAA6BH,SAAC,WACjGE,EAAAA,EAAAA,MAAA,UAAQK,QAASA,KAAQqB,GAAa,GAAQV,EAAS,qBAAwBf,UAAU,+EAA8EH,SAAA,EAACI,EAAAA,EAAAA,KAAC2O,EAAAA,IAAiB,CAAC5O,UAAU,gBAAgB,yBAGvNC,EAAAA,EAAAA,KAAA0O,EAAAA,SAAA,IAIA,KACL9O,SAEA6B,IAAiBA,EAAakE,QAC7B3F,EAAAA,EAAAA,KAACwL,EAAY,CAACa,aAA+E,QAAlE5L,EAACkD,EAAU6K,KAAKlB,GAAK5P,EAAa4P,EAAErM,MAAQQ,EAAakB,iBAAS,IAAAlC,OAAA,EAAjEA,EAAmEoD,QAAUpC,EAAakB,SAAUgD,OAAQlE,EAAakE,UAErJ3F,EAAAA,EAAAA,KAAC2N,EAAY,CAACtB,aAA+E,QAAlE3L,EAACiD,EAAU6K,KAAKlB,GAAK5P,EAAa4P,EAAErM,MAAQQ,EAAakB,iBAAS,IAAAjC,OAAA,EAAjEA,EAAmEmD,QAAUpC,EAAakB,SAAUmB,OAAyE,QAAlEnD,EAACgD,EAAU6K,KAAKlB,GAAK5P,EAAa4P,EAAErM,MAAQQ,EAAakB,iBAAS,IAAAhC,OAAA,EAAjEA,EAAmEmD,QAAU,UAK/N,C,6CC5sBA,MAAM8K,EAAiB,wBAKvB,SAASC,IACP,IACE,MAAMzQ,EAAMC,aAAaC,QAAQsQ,GACjC,OAAOxQ,EAAMG,KAAKC,MAAMJ,GAAO,CAAC,CAClC,CAAE,MAAAK,GACA,MAAO,CAAC,CACV,CACF,CAUO,SAASqQ,EAAW3Q,EAAOwH,GAC3BxH,IAAOA,EAAQ,QACpB,MAAM4Q,EAAMF,IACNG,EAAMD,EAAI5Q,IAAU,GAE1B6Q,EAAIC,QAAQtJ,GACZoJ,EAAI5Q,GAAS6Q,EAAIjI,MAAM,EAAG,KAf5B,SAAkBmI,GAChB,IACE7Q,aAAa8Q,QAAQP,EAAgBrQ,KAAK+I,UAAU4H,GACtD,CAAE,MAAA1L,GAAO,CACX,CAYE4L,CAASL,GAET,IACEzL,OAAOuK,cAAc,IAAIC,YAAY,8BAA+B,CAAEC,OAAQ,CAAE5P,QAAOwH,YACzF,CAAE,MAAAjC,GAAO,CACX,CAQO,SAAS2L,IAA+B,IAAd1J,EAAM/H,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,CAAC,EACzC,IACE,MAAMO,EAAQwH,EAAOxH,OAAS,OACxBwE,EAAWgD,EAAOhD,UAAYgD,EAAO/C,QAAU,UAI/CC,EAAO8C,EAAO9C,MAAQ,CAAC,EAMvByM,EAAgD,kBAAxBzM,EAAKyM,eAA8B9J,KAAKiF,IAAI,EAAGjF,KAAKkF,IAAI,EAAG7H,EAAKyM,iBAAoBtM,OAAO2C,EAAO5C,OAASyC,KAAKkF,IAAI,EAAG/E,EAAO5C,MAAQ,KAAO,GACrKwM,EAAoC,kBAAnB1M,EAAK2M,UAAyB3M,EAAK2M,UAAY,KAChEA,EAAwB,OAAZD,EAAmB/J,KAAKiF,IAAI,EAAGjF,KAAKkF,IAAI,GAAI6E,EAAU,GAAK,IAAM/J,KAAKkF,IAAI,GAAI1H,OAAO2C,EAAO5C,QAAU,GAAK,KACvH0M,EAA0C,kBAArB5M,EAAK4M,YAA2BjK,KAAKiF,IAAI,EAAGjF,KAAKkF,IAAI,EAAG7H,EAAK4M,cAAgBjK,KAAKkF,IAAI,GAAI1H,OAAO2C,EAAO5C,QAAU,GAAK,KAIlJ,IAAI2M,EADmB,CAAEJ,eAAgB,GAAKE,UAAW,GAAKC,YAAa,IAI3E,MAAME,EAAgB,CACpBC,gBAAiB,CAAEN,eAAgB,GAAKE,UAAW,GAAKC,YAAa,IACrEI,cAAe,CAAEP,eAAgB,GAAKE,UAAW,GAAKC,YAAa,IACnEK,WAAY,CAAER,eAAgB,GAAKE,UAAW,GAAKC,YAAa,IAChEM,cAAe,CAAET,eAAgB,GAAKE,UAAW,GAAKC,YAAa,IACnEO,aAAc,CAAEV,eAAgB,GAAKE,UAAW,GAAKC,YAAa,IAClEQ,eAAgB,CAAEX,eAAgB,GAAKE,UAAW,GAAKC,YAAa,KAElEE,EAAchN,KAAW+M,EAAUC,EAAchN,IAErD,MAAMuN,EAAU,CACdZ,iBACAE,YACAC,eAGI1M,EClFH,WAAyD,IAA7BmN,EAAOtS,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,CAAC,EAAG8R,EAAO9R,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,CAAC,EAG1D,MAAMuS,EAAa1J,OAAOC,KAAKgJ,GAC/B,GAA0B,IAAtBS,EAAWtS,OAAc,CAE3B,MAAMuS,EAAO3J,OAAO8D,OAAO2F,GAC3B,GAAoB,IAAhBE,EAAKvS,OAAc,OAAO,EAC9B,MAAM+I,EAAMwJ,EAAKpK,OAAO,CAAC/G,EAAGD,IAAMC,GAAK+D,OAAOhE,IAAM,GAAI,GAAKoR,EAAKvS,OAClE,OAAO2H,KAAKC,MAAY,IAANmB,EACpB,CAEA,MAAMyJ,EAAaF,EAAWnK,OAAO,CAAC/G,EAAGoH,IAAMpH,GAAK+D,OAAO0M,EAAQrJ,KAAO,GAAI,IAAM,EAM9EiK,EALMH,EAAWnK,OAAO,CAACuK,EAAKlK,IAG3BkK,GAFGvN,OAAOkN,EAAQ7J,KAAO,IACtBrD,OAAO0M,EAAQrJ,KAAO,GAE/B,GACsBgK,EACzB,OAAO7K,KAAKC,MAA6C,IAAvCD,KAAKiF,IAAI,EAAGjF,KAAKkF,IAAI,EAAG4F,IAC5C,CD8DkBE,CAAmBN,EAASR,GAEpCe,EAAM,CACVxP,GAAI0E,EAAO1E,IAAE,MAAA9B,OAAU+D,KAAKC,MAAMuN,SAAS,KAC3CvS,QACAwE,WACAI,QACA4N,UAAWT,EACXU,WAAY,CACVC,mBAAoBlL,EAAO1E,GAC3B6P,iBAAkB,eAClBC,UAAW7N,KAAKC,OAElBF,UAAWC,KAAKC,MAEhBZ,SAAU,CACR5C,MAAOgG,EAAOhG,MACdqR,MAAOrL,EAAOqL,MACdnO,KAAM8C,EAAO9C,MAAQ,CAAC,IAK1BiM,EAAW3Q,EAAOsS,GAGlB,MAAMQ,EAAiB,CACrBhQ,GAAG,OAAD9B,OAAS+D,KAAKC,MAAMuN,SAAS,KAC/B/Q,MAAM,eAADR,OAAiBwD,EAAQ,OAAAxD,OAAM4D,EAAK,KACzCkG,QAAQ,UAAD9J,OAAYwD,EAAQ,yBAAAxD,OAAwB4D,EAAK,oBAAA5D,OAAmBsH,OAAOyK,QAAQhB,GAAS9Q,IAAII,IAAA,IAAE6G,EAAGrH,GAAEQ,EAAA,SAAAL,OAAQkH,EAAC,KAAAlH,OAAIqG,KAAKC,MAAU,IAAJzG,GAAQ,OAAKM,KAAK,MAAK,KAC7J6R,OAAQpO,EAAQ,GAAK,6BAA0BA,EAAQ,GAAK,SAAW,MACvEqO,SAAUrO,EAAQ,GAAK,UAAY,cACnCsO,YAAa,CACXC,MAAOvO,EAAQ,GAAK,4CAA8C,qBAClEwO,IAAKxO,EAAQ,GAAK,8CAAgD,kCAClEyO,KAAM,6BAERC,SAAU,CAAC,2BAADtS,OACmBwG,EAAO1E,OAC9B0E,EAAO9C,MAAQ8C,EAAO9C,KAAKmG,MAAQ,CAACrD,EAAO9C,KAAKmG,OAAS,IAE/D0I,YAAa,GACbC,mBAAoB,CAClBhS,MAAM,0BAADR,OAA4BwD,GACjCiP,QAAS7O,EAAQ,GAAK,SAAW,OACjC8O,UAAW,CAAC,kBAAmB,sBAAuB,YACtDC,oBAAqB,GACrBC,OAAQ,CAAC,kBAAmB,gBAAiB,qBAE/CC,OAAO,eAAD7S,OAAiBwD,GACvBoO,UAAW7N,KAAKC,OAIlB,IACEG,OAAOuK,cAAc,IAAIC,YAAY,mCAAoC,CAAEC,OAAQ,CAAE5P,QAAO6O,gBAAiB,CAACiE,MAChH,CAAE,MAAA5I,GAAO,CAET,OAAOoI,CACT,CAAE,MAAOrN,GAGP,OADA6O,QAAQC,MAAM,mCAAoC9O,GAC3C,IACT,CACF,CAKO,SAASpB,EAAW7D,GAEzB,OADY0Q,IACD1Q,IAAU,EACvB,C","sources":["pages/CEO_Dashboard/OrgHealthOverview.jsx","pages/CEO_Dashboard/services/orgHealth/index.js","pages/CEO_Dashboard/services/orgHealth/score.js"],"sourcesContent":["// src/pages/CEO_Dashboard/OrgHealthOverview.jsx\r\nimport React, { useEffect, useMemo, useState } from \"react\";\r\nimport { useOutletContext, useNavigate } from \"react-router-dom\";\r\nimport { getResults } from \"./services/orgHealth\"; // ensure path is correct\r\nimport { FaChartPie, FaDownload, FaEye, FaExternalLinkAlt } from \"react-icons/fa\";\r\n\r\n/* ----------------- helpers ----------------- */\r\nfunction normalizeKey(k = \"\") {\r\n  return String(k || \"\")\r\n    .toLowerCase()\r\n    .replace(/\\s+/g, \"\")\r\n    .replace(/[_\\-]/g, \"\")\r\n    .replace(/systemof|system/g, \"\")\r\n    .trim();\r\n}\r\n\r\nfunction readAssessmentsStorage(orgId = \"anon\") {\r\n  try {\r\n    const raw = localStorage.getItem(\"conseqx_assessments_v1\");\r\n    const all = raw ? JSON.parse(raw) : {};\r\n    return all[orgId] || [];\r\n  } catch {\r\n    return [];\r\n  }\r\n}\r\n\r\nfunction pctToToneClass(pct, darkMode) {\r\n  if (pct === null || pct === undefined) return darkMode ? \"text-gray-400 bg-gray-800\" : \"text-gray-500 bg-gray-50\";\r\n  if (pct >= 80) return darkMode ? \"text-green-300 bg-green-900/20\" : \"text-green-700 bg-green-50\";\r\n  if (pct >= 60) return darkMode ? \"text-yellow-300 bg-yellow-900/20\" : \"text-yellow-700 bg-yellow-50\";\r\n  return darkMode ? \"text-red-300 bg-red-900/20\" : \"text-red-700 bg-red-50\";\r\n}\r\n\r\n/* simple CSV helper */\r\nfunction toCSV(rows) {\r\n  const esc = (v) => {\r\n    if (v === null || v === undefined) return \"\";\r\n    const s = String(v).replace(/\\r?\\n|\\r/g, \" \");\r\n    if (s.includes(\",\") || s.includes('\"')) return `\"${s.replace(/\"/g, '\"\"')}\"`;\r\n    return s;\r\n  };\r\n  return rows.map((r) => r.map(esc).join(\",\")).join(\"\\n\");\r\n}\r\n\r\n/* small Modal (responsive) */\r\nfunction Modal({ open, onClose, title, children, footer, darkMode = false }) {\r\n  if (!open) return null;\r\n  return (\r\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4\">\r\n      <div\r\n        className=\"absolute inset-0\"\r\n        style={{ backgroundColor: darkMode ? \"rgba(2,6,23,0.6)\" : \"rgba(0,0,0,0.45)\" }}\r\n        onClick={onClose}\r\n      />\r\n      <div\r\n        className={`relative z-10 w-full max-w-4xl mx-auto rounded-2xl p-4 sm:p-6 ${darkMode ? \"bg-gray-900 border border-gray-700 text-gray-100\" : \"bg-white border border-gray-100 text-gray-900\"} shadow-2xl`}\r\n        role=\"dialog\"\r\n        aria-modal=\"true\"\r\n        aria-label={title}\r\n      >\r\n        <div className=\"flex items-start justify-between gap-3\">\r\n          <h3 className=\"text-lg font-semibold\">{title}</h3>\r\n          <button onClick={onClose} aria-label=\"Close\" className={`${darkMode ? \"text-gray-300\" : \"text-gray-600\"} ml-2`}>✕</button>\r\n        </div>\r\n\r\n        <div className=\"mt-4 max-h-[70vh] overflow-auto hide-scrollbar\">{children}</div>\r\n\r\n        {footer && <div className=\"mt-5 flex flex-col sm:flex-row sm:justify-end gap-3\">{footer}</div>}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n/* ----------------- main component ----------------- */\r\nexport default function OrgHealthOverview({ orgId = null }) {\r\n  const { darkMode, org } = useOutletContext();\r\n  const navigate = useNavigate();\r\n  const effectiveOrg = orgId || org?.id || \"anon\";\r\n\r\n  const [results, setResults] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  // modal state\r\n  const [modalOpen, setModalOpen] = useState(false);\r\n  const [modalPayload, setModalPayload] = useState(null); // { systemId, result (nullable) }\r\n\r\n  /* load results with fallback */\r\n  useEffect(() => {\r\n    let mounted = true;\r\n    async function load() {\r\n      setLoading(true);\r\n      try {\r\n        const maybe = getResults ? getResults(effectiveOrg) : null;\r\n        const resolved = maybe instanceof Promise ? await maybe : maybe;\r\n        let data = Array.isArray(resolved) ? resolved : [];\r\n        if (!data || data.length === 0) {\r\n          const fallback = readAssessmentsStorage(effectiveOrg);\r\n          if (fallback && fallback.length > 0) {\r\n            data = fallback.map((a) => ({\r\n              id: a.id,\r\n              systemId: a.systemId || a.system || a.meta?.systemId || \"general\",\r\n              title: a.title || a.name || (a.systemId || a.system),\r\n              score: typeof a.score === \"number\" ? a.score : (a.score ? Number(a.score) : null),\r\n              timestamp: a.timestamp || Date.now(),\r\n              original: a,\r\n            }));\r\n          } else {\r\n            data = [];\r\n          }\r\n        } else {\r\n          data = data.map((r) => ({ ...r, original: r.original || r }));\r\n        }\r\n        if (mounted) setResults(data || []);\r\n      } catch (e) {\r\n        const fallback = readAssessmentsStorage(effectiveOrg);\r\n        if (mounted) setResults(fallback || []);\r\n      } finally {\r\n        if (mounted) setLoading(false);\r\n      }\r\n    }\r\n    load();\r\n\r\n    function refreshHandler() {\r\n      load();\r\n    }\r\n\r\n    try {\r\n      window.addEventListener(\"conseqx:orghealth:completed\", refreshHandler);\r\n      window.addEventListener(\"conseqx:assessments:updated\", refreshHandler);\r\n      window.addEventListener(\"storage\", refreshHandler);\r\n    } catch {}\r\n    return () => {\r\n      mounted = false;\r\n      try {\r\n        window.removeEventListener(\"conseqx:orghealth:completed\", refreshHandler);\r\n        window.removeEventListener(\"conseqx:assessments:updated\", refreshHandler);\r\n        window.removeEventListener(\"storage\", refreshHandler);\r\n      } catch {}\r\n    };\r\n  }, [effectiveOrg]);\r\n\r\n  /* canonical systems */\r\n  const canonical = useMemo(\r\n    () => [\r\n      { id: \"interdependency\", label: \"Interdependency\", blurb: \"How well teams integrate and hand-off work across boundaries.\" },\r\n      { id: \"iteration\", label: \"Iteration\", blurb: \"Pace of learning: experiments, feedback loops, and continuous improvement.\" },\r\n      { id: \"investigation\", label: \"Investigation\", blurb: \"Root-cause discovery and data-driven problem solving.\" },\r\n      { id: \"interpretation\", label: \"Interpretation\", blurb: \"How insights are turned into shared understanding and decisions.\" },\r\n      { id: \"illustration\", label: \"Illustration\", blurb: \"Clarity in process, playbooks, and operational visualizations.\" },\r\n      { id: \"inlignment\", label: \"Inlignment\", blurb: \"Strategic alignment — how goals, incentives, and execution line up.\" },\r\n    ],\r\n    []\r\n  );\r\n\r\n  /* compute latestBySystem */\r\n  const latestBySystem = useMemo(() => {\r\n    const map = {};\r\n    (results || []).forEach((r) => {\r\n      const rawSid = r.systemId || r.system || r.original?.systemId || r.original?.system || r.original?.meta?.systemId || \"general\";\r\n      const sid = normalizeKey(rawSid);\r\n      const ts = r.timestamp || r.ts || Date.now();\r\n      if (!map[sid] || (map[sid].timestamp || 0) < ts) {\r\n        map[sid] = { ...r, normalizedSystemId: sid, timestamp: ts };\r\n      }\r\n    });\r\n    return map;\r\n  }, [results]);\r\n\r\n  /* per-system derived list (rounded score) */\r\n  const perSystem = useMemo(() => {\r\n    return canonical.map((s) => {\r\n      const key = normalizeKey(s.id);\r\n      const res = latestBySystem[key];\r\n      const score =\r\n        res && (typeof res.score === \"number\" ? res.score : (res.score ? Number(res.score) : (res.original && typeof res.original.score === \"number\" ? res.original.score : null)));\r\n      // compute answered % if available\r\n      const answered = res?.original?.answered ?? res?.original?.meta?.answered ?? null;\r\n      const total = res?.original?.total ?? res?.original?.meta?.total ?? null;\r\n      const answeredPct = (answered != null && total != null && total > 0) ? Math.round((answered / total) * 100) : null;\r\n      return { id: key, label: s.label, blurb: s.blurb, score: score != null && !Number.isNaN(score) ? Math.round(score) : null, result: res || null, answeredPct };\r\n    });\r\n  }, [canonical, latestBySystem]);\r\n\r\n  /* composite */\r\n  const composite = useMemo(() => {\r\n    const vals = perSystem.map((p) => (p.score === null || p.score === undefined ? null : p.score));\r\n    const has = vals.filter((v) => v !== null && v !== undefined);\r\n    if (has.length === 0) return null;\r\n    return Math.round(has.reduce((s, v) => s + v, 0) / has.length);\r\n  }, [perSystem]);\r\n\r\n  /* composite history small spark */\r\n  const compositeHistory = useMemo(() => {\r\n    if (!results || results.length === 0) return [];\r\n    const byDay = {};\r\n    results.forEach((r) => {\r\n      const day = new Date(r.timestamp || Date.now());\r\n      day.setHours(0, 0, 0, 0);\r\n      const k = day.getTime();\r\n      if (!byDay[k]) byDay[k] = [];\r\n      const sc = typeof r.score === \"number\" ? r.score : (r.score ? Number(r.score) : null);\r\n      if (sc !== null && sc !== undefined && !Number.isNaN(sc)) byDay[k].push(sc);\r\n    });\r\n    const entries = Object.keys(byDay)\r\n      .map((k) => ({ t: Number(k), avg: Math.round(byDay[k].reduce((a, b) => a + b, 0) / byDay[k].length) }))\r\n      .sort((a, b) => a.t - b.t)\r\n      .slice(-12);\r\n    return entries.map((e) => e.avg);\r\n  }, [results]);\r\n\r\n  /* ---- Export helpers ---- */\r\n  function exportJSON(full = true, single = null) {\r\n    try {\r\n      const payload = single ? single : (results || []);\r\n      const blob = new Blob([JSON.stringify(payload, null, 2)], { type: \"application/json\" });\r\n      const url = URL.createObjectURL(blob);\r\n      const a = document.createElement(\"a\");\r\n      a.href = url;\r\n      a.download = single ? `${(single.original?.title || single.id || \"system\")}_orghealth.json` : `${(org && org.name) || effectiveOrg}_orghealth.json`;\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      a.remove();\r\n      setTimeout(() => URL.revokeObjectURL(url), 2000);\r\n    } catch {\r\n      alert(\"Export failed\");\r\n    }\r\n  }\r\n\r\n  function exportCSV(full = true, single = null) {\r\n    try {\r\n      if (single) {\r\n        const r = single;\r\n        // try to flatten a few useful fields for CSV\r\n        const header = [\r\n          \"system\",\r\n          \"score\",\r\n          \"timestamp\",\r\n          \"title\",\r\n          \"notes\",\r\n        ];\r\n        const rows = [\r\n          header,\r\n          [r.normalizedSystemId || r.systemId || \"\", r.score ?? \"\", new Date(r.timestamp || r.original?.timestamp || Date.now()).toISOString(), r.original?.title || r.title || \"\", (r.original?.notes || r.original?.summary || \"\").replace(/\\n/g, \" \")],\r\n        ];\r\n        const csv = toCSV(rows);\r\n        const blob = new Blob([csv], { type: \"text/csv\" });\r\n        const url = URL.createObjectURL(blob);\r\n        const a = document.createElement(\"a\");\r\n        a.href = url;\r\n        a.download = `${(r.original?.title || r.normalizedSystemId || r.id)}_orghealth.csv`;\r\n        document.body.appendChild(a);\r\n        a.click();\r\n        a.remove();\r\n        setTimeout(() => URL.revokeObjectURL(url), 1500);\r\n        return;\r\n      }\r\n      // full export: list of rows (system, score, timestamp, title)\r\n      const rows = [[\"system\", \"score\", \"timestamp\", \"title\"]];\r\n      (results || []).forEach((r) => {\r\n        const sys = normalizeKey(r.systemId || r.system || r.original?.systemId || r.original?.system || \"general\");\r\n        const score = r.score ?? r.original?.score ?? \"\";\r\n        const ts = new Date(r.timestamp || r.original?.timestamp || Date.now()).toISOString();\r\n        const title = r.original?.title || r.title || \"\";\r\n        rows.push([sys, score, ts, title]);\r\n      });\r\n      const csv = toCSV(rows);\r\n      const blob = new Blob([csv], { type: \"text/csv\" });\r\n      const url = URL.createObjectURL(blob);\r\n      const a = document.createElement(\"a\");\r\n      a.href = url;\r\n      a.download = `${(org && org.name) || effectiveOrg}_orghealth.csv`;\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      a.remove();\r\n      setTimeout(() => URL.revokeObjectURL(url), 2000);\r\n    } catch {\r\n      alert(\"CSV export failed\");\r\n    }\r\n  }\r\n\r\n  function exportPrint(single = null) {\r\n    // simple printable HTML view — user can Print -> Save as PDF\r\n    const payload = single ? single : { composite, systems: perSystem };\r\n    const html = `\r\n      <html>\r\n        <head>\r\n          <title>Org Health Report</title>\r\n          <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\r\n          <style>\r\n            body{font-family: Arial, Helvetica, sans-serif;padding:20px;color:#111}\r\n            h1{font-size:20px}\r\n            h2{font-size:16px;margin-top:18px}\r\n            .box{border:1px solid #ddd;padding:12px;margin-top:8px;border-radius:6px}\r\n            .muted{color:#666;font-size:12px}\r\n          </style>\r\n        </head>\r\n        <body>\r\n          <h1>Organizational Health — ${(org && org.name) || effectiveOrg}</h1>\r\n          <div class=\"muted\">Generated: ${new Date().toLocaleString()}</div>\r\n          <div class=\"box\"><strong>Composite:</strong> ${payload.composite ?? (single ? (single.score ?? \"—\") : \"—\")}</div>\r\n          ${single ? `<h2>System: ${single.normalizedSystemId || single.systemId || single.id}</h2>\r\n            <div class=\"box\"><pre>${JSON.stringify(single, null, 2)}</pre></div>` : `<h2>Systems</h2>\r\n            <div class=\"box\"><pre>${JSON.stringify(perSystem, null, 2)}</pre></div>`}\r\n        </body>\r\n      </html>\r\n    `;\r\n    const w = window.open(\"\", \"_blank\", \"noopener,noreferrer\");\r\n    if (!w) return alert(\"Popup blocked\");\r\n    w.document.write(html);\r\n    w.document.close();\r\n    w.focus();\r\n    // user prints manually to PDF\r\n  }\r\n\r\n  /* small spark bars */\r\n  function SparkBars({ values = [], height = 36 }) {\r\n    if (!values || values.length === 0) return <div className=\"text-xs text-gray-400\">No history</div>;\r\n    const max = Math.max(...values);\r\n    const min = Math.min(...values);\r\n    const barCount = Math.max(4, values.length);\r\n    const w = Math.max(120, barCount * 8); // narrower bars so they fit neatly\r\n    return (\r\n      <div className=\"w-full\">\r\n        <svg\r\n          width=\"100%\"\r\n          height={height}\r\n          viewBox={`0 0 ${w} ${height}`}\r\n          preserveAspectRatio=\"xMidYMid meet\"\r\n          className=\"rounded block\"\r\n          style={{ display: \"block\" }}\r\n        >\r\n          {values.map((v, i) => {\r\n            const x = i * (w / values.length);\r\n            const h = max === min ? height * 0.6 : ((v - min) / (max - min || 1)) * (height - 6) + 4;\r\n            const barW = Math.max(4, w / values.length - 2);\r\n            return (\r\n              <rect\r\n                key={i}\r\n                x={x + 1}\r\n                y={height - h}\r\n                width={barW}\r\n                height={h}\r\n                rx={2}\r\n                className={darkMode ? \"opacity-80\" : \"opacity-90\"}\r\n                style={{ fill: \"#4f46e5\" }}\r\n              />\r\n            );\r\n          })}\r\n        </svg>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  /* ---------- Modal content ---------- */\r\n\r\n  // Components list (from your specification)\r\n  const COMPONENTS_LIST = [\r\n    \"Industry Dynamics\",\r\n    \"Founding Roots\",\r\n    \"Organization\",\r\n    \"Leadership\",\r\n    \"Culture\",\r\n    \"Innovation\",\r\n    \"Strategy\",\r\n    \"Structure\",\r\n    \"Processes\",\r\n    \"Dynamic Behavior\",\r\n    \"Technology\",\r\n    \"Risk\",\r\n    \"Financials\",\r\n    \"Skills\",\r\n    \"Resources\",\r\n    \"Environment\",\r\n    \"Goals\",\r\n    \"Policy\",\r\n    \"Staff-People\",\r\n  ];\r\n\r\n  // ResultDetail now follows the required output structure\r\n  function ResultDetail({ systemLabel, result }) {\r\n    const score = result?.score ?? result?.original?.score ?? null;\r\n    const ts = result?.timestamp || result?.original?.timestamp || result?.original?.ts || null;\r\n    const original = result?.original || {};\r\n    const subProgress = original?.subProgress || original?.meta?.subProgress || null;\r\n    const notes = original?.notes || original?.meta?.notes || original?.summary || \"\";\r\n\r\n    // Rankings: system rank relative to other systems (compute quickly)\r\n    const systemRank = (() => {\r\n      const allScores = perSystem.map((p) => (p.score === null || p.score === undefined ? -1 : p.score));\r\n      const valid = allScores.filter((s) => s >= 0);\r\n      if (!valid.length) return { rank: \"—\", total: perSystem.length };\r\n      const sorted = valid.slice().sort((a, b) => b - a);\r\n      const pos = sorted.indexOf(score) + 1 || \"—\";\r\n      return { rank: pos, total: valid.length };\r\n    })();\r\n\r\n    // Insights: try to read from original.meta.insights otherwise synthesize simple ones\r\n    const insights = original?.meta?.insights || original?.insights || [\r\n      `Core strength: ${score >= 75 ? \"strong governance and clarity\" : \"needs improved coordination\"}`,\r\n      `Area of concern: ${score < 60 ? \"low ownership and slow handoffs\" : \"occasional misalignment under pressure\"}`,\r\n    ];\r\n\r\n    const forecasts = original?.meta?.forecasts || original?.forecasts || [\r\n      { horizon: \"4 weeks\", text: \"Stabilize processes — small wins expected\" },\r\n      { horizon: \"3 months\", text: \"Partial improvement if action plan executed\" },\r\n      { horizon: \"12 months\", text: \"Sustained lift if underlying culture & KPIs fixed\" },\r\n    ];\r\n\r\n    // Recommendations (X-ULTRA)\r\n    const xUltraRecs = original?.meta?.recommendations || [\r\n      { title: \"Short\", items: [\"Assign triage owners for blocked tickets\", \"Daily 15m unblock standup for critical flows\"] },\r\n      { title: \"Mid\", items: [\"Run 8-week retention test\", \"Implement cross-team SLAs\"] },\r\n      { title: \"Long\", items: [\"Embed playbooks and capability uplift program\", \"Consider partnerships to scale delivery\"] },\r\n    ];\r\n\r\n    // African case-study\r\n    const caseStudy = original?.meta?.caseStudy || {\r\n      company: \"Dangote Group (Nigeria)\",\r\n      summary: \"Improved cross-unit coordination via central playbooks and weekly triage; measured using delivery cycle time.\",\r\n      result: \"~35% faster delivery for prioritized initiatives in 12–18 months.\",\r\n    };\r\n\r\n    // Build Rankings table at component-level if original.components available\r\n    const componentScores = original?.components || null; // expected shape { \"Leadership\": 78, ... }\r\n\r\n    return (\r\n      <div className=\"space-y-4\">\r\n        <div className=\"flex items-start justify-between gap-3\">\r\n          <div>\r\n            <div className=\"text-xs text-gray-400 mt-1\">\r\n              Score: {score !== null ? `${score}%` : \"—\"} {ts && <span className=\"ml-2\">· Completed {new Date(ts).toLocaleString()}</span>}\r\n            </div>\r\n            <div className=\"text-xs text-gray-400 mt-1\">Ranking: {systemRank.rank}/{systemRank.total}</div>\r\n          </div>\r\n\r\n          <div className=\"flex items-center gap-2\">\r\n            <button onClick={() => exportJSON(false, result)} className=\"px-3 py-1 rounded-md border text-sm\">Export JSON</button>\r\n            <button onClick={() => exportCSV(false, result)} className=\"px-3 py-1 rounded-md border text-sm\">Export CSV</button>\r\n            <button onClick={() => exportPrint(result)} className=\"px-3 py-1 rounded-md border text-sm\">Print / PDF</button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Components list */}\r\n        <div>\r\n          <h5 className=\"font-semibold\">Components examined</h5>\r\n          <div className=\"mt-2 grid grid-cols-2 sm:grid-cols-3 gap-2\">\r\n            {COMPONENTS_LIST.map((c) => (\r\n              <div key={c} className={`p-2 rounded-md text-sm ${darkMode ? \"bg-gray-800 border border-gray-700\" : \"bg-gray-50 border border-gray-100\"}`}>\r\n                <div className=\"font-medium\">{c}</div>\r\n                <div className=\"text-xs text-gray-400 mt-1\">{(componentScores && componentScores[c] != null) ? `${Math.round(componentScores[c])}%` : \"—\"}</div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Rankings */}\r\n        <div>\r\n          <h5 className=\"font-semibold\">1. Rankings</h5>\r\n          <div className=\"mt-2 text-sm text-gray-600\">\r\n            System rank: <strong>{systemRank.rank}/{systemRank.total}</strong>.\r\n            {componentScores ? \" Component-level ranks are shown above.\" : \" Component-level data not available.\"}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Insights */}\r\n        <div>\r\n          <h5 className=\"font-semibold\">2. Insights</h5>\r\n          <div className=\"mt-2 space-y-2\">\r\n            {insights.map((ins, i) => <div key={i} className={`p-3 rounded-md ${darkMode ? \"bg-gray-800 border border-gray-700\" : \"bg-gray-50 border border-gray-100\"}`}>{ins}</div>)}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Case Study */}\r\n        <div>\r\n          <h5 className=\"font-semibold\">3. Case study from African business</h5>\r\n          <div className={`p-3 rounded-md ${darkMode ? \"bg-green-900/10 border border-green-800\" : \"bg-green-50 border border-green-100\"}`}>\r\n            <div className=\"font-medium\">{caseStudy.company}</div>\r\n            <div className=\"text-sm mt-1\">{caseStudy.summary}</div>\r\n            <div className=\"text-sm mt-2 font-medium\">Outcome</div>\r\n            <div className=\"text-sm\">{caseStudy.result}</div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Forecasts */}\r\n        <div>\r\n          <h5 className=\"font-semibold\">4. Forecasts</h5>\r\n          <div className=\"mt-2 space-y-2\">\r\n            {forecasts.map((f, i) => (\r\n              <div key={i} className={`p-3 rounded-md ${darkMode ? \"bg-gray-800 border border-gray-700\" : \"bg-gray-50 border border-gray-100\"}`}>\r\n                <div className=\"font-medium\">{f.horizon}</div>\r\n                <div className=\"text-sm text-gray-600 mt-1\">{f.text}</div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {/* X-ULTRA Recommendations */}\r\n        <div>\r\n          <h5 className=\"font-semibold\">5. X-ULTRA Recommendations</h5>\r\n          <div className=\"mt-2 space-y-3\">\r\n            {xUltraRecs.map((r, i) => (\r\n              <div key={i} className={`p-3 rounded-md ${darkMode ? \"bg-blue-900/10 border border-blue-800\" : \"bg-blue-50 border border-blue-100\"}`}>\r\n                <div className=\"font-medium\">{r.title}</div>\r\n                <ul className=\"list-disc pl-5 mt-2 text-sm\">\r\n                  {r.items.map((it, j) => <li key={j}>{it}</li>)}\r\n                </ul>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {notes && (\r\n          <div>\r\n            <h5 className=\"font-semibold\">Notes & Observations</h5>\r\n            <div className=\"mt-2 text-sm text-gray-400 whitespace-pre-wrap\">{notes}</div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  /* No-data: single clear CTA */\r\n  function NoDataPrompt({ systemLabel, blurb }) {\r\n    return (\r\n      <div className=\"space-y-4\">\r\n        <div>\r\n          <h4 className=\"text-lg font-semibold\">No assessment found for {systemLabel}</h4>\r\n          <div className=\"text-sm text-gray-400 mt-1\">We don't yet have data for this system.</div>\r\n        </div>\r\n\r\n        <div className={`p-4 rounded-md ${darkMode ? \"bg-gray-800 border border-gray-700\" : \"bg-gray-50 border border-gray-100\"}`}>\r\n          <div className=\"text-sm text-gray-400\">{blurb}</div>\r\n          <ul className=\"list-disc pl-5 mt-3 text-sm text-gray-600\">\r\n            <li>Understand how this system impacts delivery, quality and growth.</li>\r\n            <li>Get automated recommendations tailored to your organization.</li>\r\n            <li>Export actionable meeting agendas and owners to follow up quickly.</li>\r\n          </ul>\r\n        </div>\r\n\r\n        <div>\r\n          <p className=\"text-sm text-gray-500\">Ready to assess? The assessment takes ~10–20 minutes per system and will populate this panel with an easy-to-read report and recommended next steps.</p>\r\n          <div className=\"mt-4\">\r\n            <button\r\n              onClick={() => {\r\n                try { window.dispatchEvent(new CustomEvent(\"conseqx:assessment:start\", { detail: { systemId: systemLabel, orgId: effectiveOrg } })); } catch {}\r\n                navigate(\"/ceo/assessments\");\r\n                setModalOpen(false);\r\n              }}\r\n              className=\"px-4 py-2 rounded-md bg-gradient-to-r from-indigo-600 to-blue-600 text-white\"\r\n            >\r\n              Take Organizational Health Assessment\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  /* row action handlers */\r\n  function openSystemModal(systemId) {\r\n    const payload = { systemId, result: latestBySystem[systemId] || null };\r\n    setModalPayload(payload);\r\n    setModalOpen(true);\r\n  }\r\n\r\n  function onTakeAssessment(systemId) {\r\n    try {\r\n      window.dispatchEvent(new CustomEvent(\"conseqx:assessment:start\", { detail: { systemId, orgId: effectiveOrg } }));\r\n    } catch {}\r\n    navigate(\"/ceo/assessments\");\r\n  }\r\n\r\n  /* ---------- render ---------- */\r\n  return (\r\n    <div className={`rounded-2xl p-4 ${darkMode ? \"bg-gradient-to-br from-gray-900/80 to-gray-900/60 border border-gray-700 text-gray-100\" : \"bg-white border border-gray-100 text-gray-900\"}`}>\r\n      <style>{`.hide-scrollbar::-webkit-scrollbar{display:none} .hide-scrollbar{ -ms-overflow-style:none; scrollbar-width:none; }`}</style>\r\n\r\n      <div className=\"flex items-start justify-between gap-3\">\r\n        <div className=\"flex items-center gap-2\">\r\n          {/* Removed the large blue background behind the icon; icon now sits on transparent background */}\r\n          <div className=\"p-2 rounded-md bg-transparent\">\r\n            <FaChartPie className=\"text-2xl text-indigo-600 dark:text-indigo-400\" />\r\n          </div>\r\n          <div>\r\n            <div className=\"text-sm font-semibold\">Organizational Health</div>\r\n            <div className={`text-xs ${darkMode ? \"text-gray-400\" : \"text-gray-500\"}`}>Composite view across core systems</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-2\">\r\n          <div className=\"inline-flex items-center gap-1 rounded-md border overflow-hidden\">\r\n            <button onClick={() => exportJSON(true)} className={`px-2 py-1 text-xs ${darkMode ? \"bg-gray-800 border-gray-700 text-gray-200\" : \"bg-white border border-gray-200 text-gray-700\"}`} title=\"Export all (JSON)\">JSON</button>\r\n            <button onClick={() => exportCSV(true)} className={`px-2 py-1 text-xs ${darkMode ? \"bg-gray-800 border-gray-700 text-gray-200\" : \"bg-white border border-gray-200 text-gray-700\"}`} title=\"Export all (CSV)\">CSV</button>\r\n            <button onClick={() => exportPrint(null)} className={`px-2 py-1 text-xs ${darkMode ? \"bg-gray-800 border-gray-700 text-gray-200\" : \"bg-white border border-gray-200 text-gray-700\"}`} title=\"Print / PDF\">Print</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* GRID: left = score/details, right = spark (keeps spark aligned and never overlapped) */}\r\n      <div className=\"mt-4 grid grid-cols-1 sm:grid-cols-12 gap-4 items-center\">\r\n        <div className=\"sm:col-span-8\">\r\n          <div className=\"flex items-center gap-4\">\r\n            <div>\r\n              <div className=\"text-xs text-gray-400\">Composite score</div>\r\n              <div className=\"text-2xl font-bold mt-1\">{loading ? \"…\" : composite !== null ? `${composite}%` : \"—\"}</div>\r\n              <div className={`text-sm mt-1 ${darkMode ? \"text-gray-400\" : \"text-gray-500\"}`}>{results && results.length ? `${results.length} datapoints` : \"No data yet\"}</div>\r\n            </div>\r\n\r\n            <div className=\"flex-1 hidden sm:block\">\r\n              {/* keep some space between score and spark on large screens */}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"sm:col-span-4 flex justify-end items-center\">\r\n          {/* Constrain spark to a tidy box so it doesn't float or overlap */}\r\n          <div className=\"w-full max-w-[220px]\">\r\n            <div className={`text-xs mb-1 ${darkMode ? \"text-gray-400 text-right\" : \"text-gray-500 text-right\"}`}>Recent trend</div>\r\n            <div className={`w-full h-11 rounded p-1 ${darkMode ? \"bg-gray-800/50\" : \"bg-gray-50\"}`}>\r\n              <SparkBars values={compositeHistory} height={36} />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"mt-4 grid grid-cols-1 gap-2\">\r\n        {perSystem.map((p) => (\r\n          <div key={p.id} className={`flex items-center justify-between gap-3 p-3 rounded ${darkMode ? \"bg-gray-800 border border-gray-700\" : \"bg-gray-50 border border-gray-100\"}`}>\r\n            <div className=\"min-w-0\">\r\n              <div className=\"flex items-center gap-3\">\r\n                <div className={`px-2 py-0.5 rounded text-xs font-semibold ${pctToToneClass(p.score, darkMode)}`}>{p.label}</div>\r\n                <div className={`text-sm truncate ${darkMode ? \"text-gray-200\" : \"text-gray-800\"}`}>\r\n                  {p.score !== null ? `${p.score}%` : <span className=\"text-xs text-gray-400\">Assessment not taken</span>}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Blue progress bar for answered systems (if answeredPct available) */}\r\n              {p.answeredPct != null ? (\r\n                <div className=\"mt-2\">\r\n                  <div className=\"text-xs text-gray-400 mb-1\">{p.answeredPct}% answered</div>\r\n                  <div className={`w-full h-2 rounded-full ${darkMode ? \"bg-gray-700\" : \"bg-gray-200\"}`}>\r\n                    <div style={{ width: `${Math.max(4, Math.min(100, p.answeredPct))}%` }} className=\"h-full rounded-full bg-gradient-to-r from-indigo-600 to-blue-500\" />\r\n                  </div>\r\n                </div>\r\n              ) : p.score !== null ? (\r\n                // if no answeredPct but has score, show small indicator bar proportional to score\r\n                <div className=\"mt-2\">\r\n                  <div className=\"text-xs text-gray-400 mb-1\">Score progress</div>\r\n                  <div className={`w-full h-2 rounded-full ${darkMode ? \"bg-gray-700\" : \"bg-gray-200\"}`}>\r\n                    <div style={{ width: `${Math.max(4, Math.min(100, p.score))}%` }} className=\"h-full rounded-full bg-gradient-to-r from-indigo-600 to-blue-500\" />\r\n                  </div>\r\n                </div>\r\n              ) : (\r\n                <div className=\"mt-2 text-xs text-gray-400\">Take your organizational health assessment to populate this system's report.</div>\r\n              )}\r\n            </div>\r\n\r\n            <div className=\"flex flex-col items-end gap-2\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <button\r\n                  onClick={() => openSystemModal(p.id)}\r\n                  className={`px-3 py-1 rounded-md border text-xs ${darkMode ? \"bg-gray-900 border-gray-700 text-gray-200\" : \"bg-white border border-gray-200 text-gray-700\"}`}\r\n                  title={p.score !== null ? \"View detailed results\" : \"No results yet — learn about this system and take the assessment\"}\r\n                  aria-label={`View ${p.label}`}\r\n                >\r\n                  <FaEye />\r\n                </button>\r\n\r\n                {p.score === null && (\r\n                  <button\r\n                    onClick={() => onTakeAssessment(p.id)}\r\n                    className=\"px-3 py-1 rounded-md bg-indigo-600 text-white text-xs\"\r\n                    title={`Take ${p.label} assessment`}\r\n                  >\r\n                    Take assessment\r\n                  </button>\r\n                )}\r\n              </div>\r\n\r\n              <div className=\"text-xs text-gray-400\">{p.result?.timestamp ? new Date(p.result.timestamp).toLocaleDateString() : (p.score !== null ? \"Date unknown\" : \"—\")}</div>\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      <div className=\"mt-3 text-xs text-gray-400\">Tip: run assessments from the Assessments panel to populate these scores. The OrgHealth engine stores recent results and emits suggestions into Reports.</div>\r\n\r\n      {/* Modal */}\r\n      <Modal\r\n        open={modalOpen}\r\n        onClose={() => {\r\n          setModalOpen(false);\r\n          setModalPayload(null);\r\n        }}\r\n        title={modalPayload ? (modalPayload.result ? `THE SYSTEM OF ${(canonical.find(c => normalizeKey(c.id) === modalPayload.systemId)?.label || modalPayload.systemId).toUpperCase()} REPORT` : `THE SYSTEM OF ${(canonical.find(c => normalizeKey(c.id) === modalPayload.systemId)?.label || modalPayload.systemId).toUpperCase()} — GET STARTED`) : \"System\"}\r\n        darkMode={darkMode}\r\n        footer={\r\n          modalPayload ? (\r\n            modalPayload.result ? (\r\n              <>\r\n                <button onClick={() => exportJSON(false, modalPayload.result)} className=\"px-3 py-2 rounded-md border\">JSON</button>\r\n                <button onClick={() => exportCSV(false, modalPayload.result)} className=\"px-3 py-2 rounded-md border\">CSV</button>\r\n                <button onClick={() => exportPrint(modalPayload.result)} className=\"px-3 py-2 rounded-md border\">Print</button>\r\n                <button onClick={() => { setModalOpen(false); navigate(\"/ceo/assessments\"); }} className=\"px-3 py-2 rounded-md bg-gradient-to-r from-indigo-600 to-blue-600 text-white\"><FaExternalLinkAlt className=\"inline mr-2\" />Open assessment</button>\r\n              </>\r\n            ) : (\r\n              <>\r\n                {/* placeholder */}\r\n              </>\r\n            )\r\n          ) : null\r\n        }\r\n      >\r\n        {modalPayload && (modalPayload.result ? (\r\n          <ResultDetail systemLabel={(canonical.find(c => normalizeKey(c.id) === modalPayload.systemId)?.label) || modalPayload.systemId} result={modalPayload.result} />\r\n        ) : (\r\n          <NoDataPrompt systemLabel={(canonical.find(c => normalizeKey(c.id) === modalPayload.systemId)?.label) || modalPayload.systemId} blurb={(canonical.find(c => normalizeKey(c.id) === modalPayload.systemId)?.blurb) || \"\"} />\r\n        ))}\r\n      </Modal>\r\n    </div>\r\n  );\r\n}\r\n","// src/pages/CEO_Dashboard/services/orgHealth/index.js\r\n// Minimal OrgHealth service: ingest assessment -> map to simple metrics -> compute score -> persist -> emit events\r\n\r\nimport { computeSystemScore } from \"./score\";\r\n\r\nconst ORG_HEALTH_KEY = \"conseqx_org_health_v1\";\r\n\r\n/**\r\n * Persist results per orgId (simple localStorage JSON).\r\n */\r\nfunction readAll() {\r\n  try {\r\n    const raw = localStorage.getItem(ORG_HEALTH_KEY);\r\n    return raw ? JSON.parse(raw) : {};\r\n  } catch {\r\n    return {};\r\n  }\r\n}\r\nfunction writeAll(obj) {\r\n  try {\r\n    localStorage.setItem(ORG_HEALTH_KEY, JSON.stringify(obj));\r\n  } catch {}\r\n}\r\n\r\n/**\r\n * Save a single computed system result\r\n */\r\nexport function saveResult(orgId, result) {\r\n  if (!orgId) orgId = \"anon\";\r\n  const all = readAll();\r\n  const arr = all[orgId] || [];\r\n  // Prepend newest\r\n  arr.unshift(result);\r\n  all[orgId] = arr.slice(0, 300); // keep a cap\r\n  writeAll(all);\r\n\r\n  try {\r\n    window.dispatchEvent(new CustomEvent(\"conseqx:orghealth:completed\", { detail: { orgId, result } }));\r\n  } catch {}\r\n}\r\n\r\n/**\r\n * Basic mapping: convert an assessment result into metrics for a given system.\r\n * This is intentionally simple and deterministic.\r\n *\r\n * result: normalized assessment object (see Assessments.js normalized variable)\r\n */\r\nexport function ingestAssessment(result = {}) {\r\n  try {\r\n    const orgId = result.orgId || \"anon\";\r\n    const systemId = result.systemId || result.system || \"general\";\r\n\r\n    // Build example metrics by looking into result.meta and score\r\n    // We expect Assessment meta to include helpful keys; otherwise derive from score\r\n    const meta = result.meta || {};\r\n\r\n    // Basic normalized metrics (0..1)\r\n    // - networkDensity: prefer explicit meta.networkDensity or derive from score\r\n    // - sentiment: prefer meta.sentiment (-1..1) -> map to 0..1\r\n    // - operational: prefer meta.operational (0..1)\r\n    const networkDensity = typeof meta.networkDensity === \"number\" ? Math.max(0, Math.min(1, meta.networkDensity)) : (Number(result.score) ? Math.min(1, result.score / 100) : 0.5);\r\n    const rawSent = typeof meta.sentiment === \"number\" ? meta.sentiment : null; // expected -1..1\r\n    const sentiment = rawSent !== null ? Math.max(0, Math.min(1, (rawSent + 1) / 2)) : Math.min(1, (Number(result.score) || 0) / 100);\r\n    const operational = typeof meta.operational === \"number\" ? Math.max(0, Math.min(1, meta.operational)) : Math.min(1, (Number(result.score) || 0) / 100);\r\n\r\n    // Choose weights depending on system\r\n    const defaultWeights = { networkDensity: 0.4, sentiment: 0.3, operational: 0.3 };\r\n    let weights = defaultWeights;\r\n\r\n    // Example per-system custom weights\r\n    const systemWeights = {\r\n      interdependency: { networkDensity: 0.6, sentiment: 0.2, operational: 0.2 },\r\n      investigation: { networkDensity: 0.2, sentiment: 0.2, operational: 0.6 },\r\n      inlignment: { networkDensity: 0.2, sentiment: 0.4, operational: 0.4 },\r\n      orchestration: { networkDensity: 0.3, sentiment: 0.2, operational: 0.5 },\r\n      illustration: { networkDensity: 0.2, sentiment: 0.5, operational: 0.3 },\r\n      interpretation: { networkDensity: 0.2, sentiment: 0.5, operational: 0.3 }\r\n    };\r\n    if (systemWeights[systemId]) weights = systemWeights[systemId];\r\n\r\n    const metrics = {\r\n      networkDensity,\r\n      sentiment,\r\n      operational\r\n    };\r\n\r\n    const score = computeSystemScore(metrics, weights);\r\n\r\n    const out = {\r\n      id: result.id || `oh-${Date.now().toString(36)}`,\r\n      orgId,\r\n      systemId,\r\n      score,\r\n      breakdown: metrics,\r\n      provenance: {\r\n        sourceAssessmentId: result.id,\r\n        algorithmVersion: \"orghealth-v1\",\r\n        createdAt: Date.now()\r\n      },\r\n      timestamp: Date.now(),\r\n      // keep original result for traceability\r\n      original: {\r\n        title: result.title,\r\n        owner: result.owner,\r\n        meta: result.meta || {}\r\n      }\r\n    };\r\n\r\n    // Persist result\r\n    saveResult(orgId, out);\r\n\r\n    // Build a small recommendation stub (consumer UI can enrich or run an LLM for richer text)\r\n    const recommendation = {\r\n      id: `rec-${Date.now().toString(36)}`,\r\n      title: `Investigate ${systemId} - ${score}%`,\r\n      summary: `System ${systemId} received a score of ${score}%. Key drivers: ${Object.entries(metrics).map(([k, v]) => `${k}=${Math.round(v * 100)}%`).join(\", \")}.`,\r\n      impact: score < 60 ? \"High — potential risk\" : score < 75 ? \"Medium\" : \"Low\",\r\n      severity: score < 60 ? \"warning\" : \"improvement\",\r\n      predictions: {\r\n        short: score < 60 ? \"Short term: Operational friction, delays.\" : \"Short term: Stable\",\r\n        mid: score < 60 ? \"Mid term: Reduced throughput if unresolved.\" : \"Mid term: Maintain improvements\",\r\n        long: \"Long term: Monitor trends\"\r\n      },\r\n      evidence: [\r\n        `Derived from assessment ${result.id}`,\r\n        ...(result.meta && result.meta.notes ? [result.meta.notes] : [])\r\n      ],\r\n      comparables: [],\r\n      recommendedMeeting: {\r\n        title: `Cross-functional sync: ${systemId}`,\r\n        urgency: score < 60 ? \"Urgent\" : \"High\",\r\n        attendees: [\"Head of Product\", \"Head of Engineering\", \"Ops Lead\"],\r\n        proposedDurationMin: 45,\r\n        agenda: [\"Review findings\", \"Assign owners\", \"Agree next steps\"]\r\n      },\r\n      source: `Assessment: ${systemId}`,\r\n      createdAt: Date.now()\r\n    };\r\n\r\n    // Emit recommendation event for UI to pick up\r\n    try {\r\n      window.dispatchEvent(new CustomEvent(\"conseqx:orghealth:recommendation\", { detail: { orgId, recommendations: [recommendation] } }));\r\n    } catch {}\r\n\r\n    return out;\r\n  } catch (e) {\r\n    // swallow errors (non-fatal) — real service should surface logs\r\n    console.error(\"orgHealth.ingestAssessment error\", e);\r\n    return null;\r\n  }\r\n}\r\n\r\n/**\r\n * Return persisted results for an org\r\n */\r\nexport function getResults(orgId) {\r\n  const all = readAll();\r\n  return all[orgId] || [];\r\n}\r\n","// src/pages/CEO_Dashboard/services/orgHealth/score.js\r\n// Small deterministic scoring util for organizational health systems.\r\n// Keep calculations simple and auditable.\r\n\r\nexport function computeSystemScore(metrics = {}, weights = {}) {\r\n  // metrics: { metricKey: valueBetween0And1, ... }\r\n  // weights: { metricKey: weight, ... }\r\n  const weightKeys = Object.keys(weights);\r\n  if (weightKeys.length === 0) {\r\n    // If no weights provided, average metrics\r\n    const vals = Object.values(metrics);\r\n    if (vals.length === 0) return 0;\r\n    const avg = vals.reduce((s, v) => s + (Number(v) || 0), 0) / vals.length;\r\n    return Math.round(avg * 100);\r\n  }\r\n\r\n  const sumWeights = weightKeys.reduce((s, k) => s + (Number(weights[k]) || 0), 0) || 1;\r\n  const raw = weightKeys.reduce((acc, k) => {\r\n    const v = Number(metrics[k]) || 0;\r\n    const w = Number(weights[k]) || 0;\r\n    return acc + v * w;\r\n  }, 0);\r\n  const normalized = raw / sumWeights;\r\n  return Math.round(Math.max(0, Math.min(1, normalized)) * 100);\r\n}\r\n"],"names":["normalizeKey","String","arguments","length","undefined","toLowerCase","replace","trim","readAssessmentsStorage","orgId","raw","localStorage","getItem","JSON","parse","_unused","pctToToneClass","pct","darkMode","toCSV","rows","esc","v","s","includes","concat","map","r","join","Modal","_ref","open","onClose","title","children","footer","_jsxs","className","_jsx","style","backgroundColor","onClick","role","OrgHealthOverview","_ref2","_canonical$find","_canonical$find2","_canonical$find3","_canonical$find4","_canonical$find5","org","useOutletContext","navigate","useNavigate","effectiveOrg","id","results","setResults","useState","loading","setLoading","modalOpen","setModalOpen","modalPayload","setModalPayload","useEffect","mounted","async","load","maybe","getResults","resolved","Promise","data","Array","isArray","_objectSpread","original","fallback","a","_a$meta","systemId","system","meta","name","score","Number","timestamp","Date","now","e","refreshHandler","window","addEventListener","_unused2","removeEventListener","_unused3","canonical","useMemo","label","blurb","latestBySystem","forEach","_r$original","_r$original2","_r$original3","_r$original3$meta","sid","ts","normalizedSystemId","perSystem","_ref3","_res$original$answere","_res$original","_res$original2","_res$original2$meta","_ref4","_res$original$total","_res$original3","_res$original4","_res$original4$meta","key","res","answered","total","answeredPct","Math","round","isNaN","result","composite","has","p","filter","reduce","compositeHistory","byDay","day","setHours","k","getTime","sc","push","Object","keys","t","avg","b","sort","slice","exportJSON","single","_single$original","payload","blob","Blob","stringify","type","url","URL","createObjectURL","document","createElement","href","download","body","appendChild","click","remove","setTimeout","revokeObjectURL","_unused4","alert","exportCSV","_r$score","_r$original4","_r$original5","_r$original6","_r$original7","_r$original8","csv","toISOString","notes","summary","_r$original9","_r$original0","_ref5","_r$score2","_r$original1","_r$original10","_r$original11","sys","_unused5","exportPrint","_payload$composite","_single$score","systems","html","toLocaleString","w","write","close","focus","SparkBars","_ref6","values","height","max","min","barCount","width","viewBox","preserveAspectRatio","display","i","x","h","barW","y","rx","fill","COMPONENTS_LIST","ResultDetail","_ref7","_ref8","_result$score","_result$original","_result$original2","_result$original3","_original$meta","_original$meta2","_original$meta3","_original$meta4","_original$meta5","_original$meta6","systemLabel","subProgress","systemRank","valid","rank","indexOf","insights","forecasts","horizon","text","xUltraRecs","recommendations","items","caseStudy","company","componentScores","components","c","ins","f","it","j","NoDataPrompt","_ref9","dispatchEvent","CustomEvent","detail","_unused6","FaChartPie","_p$result","openSystemModal","FaEye","_unused7","onTakeAssessment","toLocaleDateString","find","toUpperCase","_Fragment","FaExternalLinkAlt","ORG_HEALTH_KEY","readAll","saveResult","all","arr","unshift","obj","setItem","writeAll","ingestAssessment","networkDensity","rawSent","sentiment","operational","weights","systemWeights","interdependency","investigation","inlignment","orchestration","illustration","interpretation","metrics","weightKeys","vals","sumWeights","normalized","acc","computeSystemScore","out","toString","breakdown","provenance","sourceAssessmentId","algorithmVersion","createdAt","owner","recommendation","entries","impact","severity","predictions","short","mid","long","evidence","comparables","recommendedMeeting","urgency","attendees","proposedDurationMin","agenda","source","console","error"],"sourceRoot":""}
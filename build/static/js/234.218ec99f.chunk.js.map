{"version":3,"file":"static/js/234.218ec99f.chunk.js","mappings":"4NAGA,SAASA,EAASC,GAChB,OAAQA,GAAQ,IACbC,cACAC,QAAQ,eAAgB,KACxBC,MAAM,OACNC,OAAOC,QACZ,CAyDA,SAASC,EAAWC,EAAOC,GAAkB,IAAXC,EAAIC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,EACvC,IAAKH,IAAUA,EAAMM,MAA8B,IAAtBN,EAAMM,KAAKF,OAAc,MAAO,GAC7D,MAAMG,EA1BR,SAAoBP,EAAOC,GACzB,MAAMO,EAAUhB,EAASS,GACnBQ,EAAMC,OAAOC,OAAO,MAC1BH,EAAQI,QAASC,IAAQJ,EAAII,IAAMJ,EAAII,IAAM,GAAK,IAElD,MAAMC,EAAOJ,OAAOC,OAAO,MAC3B,IAAII,EAAQ,EAeZ,OAdAL,OAAOM,QAAQP,GAAKG,QAAQK,IAAa,IAAXJ,EAAGK,GAAED,EACjC,MAAME,EAAMD,GAAKlB,EAAMoB,IAAIP,IAAM,GACjCC,EAAKD,GAAKM,EACVJ,GAASI,EAAMA,IAEjBJ,EAAQM,KAAKC,KAAKP,IAAU,EAEbf,EAAMuB,WAAWC,IAAI,CAAAC,EAAgBC,KAAO,IAAtB,IAAEC,EAAG,KAAEC,GAAMH,EAE5CI,EAAM,EAGV,OAFAnB,OAAOM,QAAQF,GAAMF,QAAQkB,IAAa,IAAXjB,EAAGkB,GAAED,EAAWH,EAAId,KAAIgB,GAAOE,EAAIJ,EAAId,MAE/D,CAAEa,IAAGM,IADAH,GAAOD,EAAOb,MAGdkB,KAAK,CAACC,EAAGC,IAAMA,EAAEH,IAAME,EAAEF,IACzC,CAIiBI,CAAWpC,EAAOC,GAAOJ,OAAOwC,GAAKA,EAAEL,IAAM,GAC5D,OAAOzB,EAAO+B,MAAM,EAAGpC,GAAMsB,IAAIa,IAAC,CAAOE,MAAOF,EAAEL,IAAKQ,IAAKxC,EAAMM,KAAK+B,EAAEX,KAC3E,C,qCCrEO,MAAMe,EAAgB,CAC3BC,MAAO,CAAC,UACRC,cAAe,gBACfC,QAAS,CAAC,OAAQ,MAClBC,UAAW,CACTC,MAAO,CAAC,SACRC,MAAO,CAAC,SACRC,MAAO,CAAC,SACRC,GAAI,CAAC,SACLC,GAAI,CAAC,SACLC,GAAI,CAAC,UAEPC,UAAW,CACTC,KAAM,CAAC,OAAQ,QAAS,SAAU,OAAQ,MAAO,QACjDC,KAAM,CAAC,OAAQ,SACfC,IAAK,CAAC,OAAQ,SACdC,SAAU,CAAC,OAAQ,UAErBC,SAAU,CACR,KACA,KACA,KACA,KACA,KACA,KACA,KACA,IACA,IACA,SACA,KACA,IACA,MACA,OACA,MACA,KACA,MACA,MACA,MACA,MACA,MACA,IACA,KACA,KACA,QACA,QACA,QACA,QACA,aACA,KACA,KACA,KACA,MACA,IACA,OACA,MACA,KACA,OACA,KACA,KACA,KACA,KACA,KACA,KACA,IACA,SACA,UACA,UACA,UACA,SACA,aACA,OACA,MACA,OACA,MACA,OACA,QACA,OACA,OACA,MACA,SAEFC,WAAY,CACVxB,EAAG,CAAC,QACJyB,IAAK,CAAC,MAAO,YACbC,MAAO,CACL,CAAC,OAAQ,YACT,CAAC,YAAY,IAEfC,GAAI,CAAC,CAAC,YAAa,mBACnBC,IAAK,CAAC,YAAa,YACnBC,WAAY,CAAC,QACbC,IAAK,CAAC,QACNC,IAAK,CAAC,QACNC,EAAG,CAAC,QACJ,IAAK,CACH,OACA,SACA,gBACA,YACA,SACA,QACA,MACA,kBACA,aACA,YACA,iBACA,OACA,SACA,cACA,cACA,OACA,UACA,UACA,UACA,QACA,OACA,UACA,QACA,UACA,SACA,WACA,MACA,WACA,UACA,UACA,QACA,UACA,SACA,WACA,SACA,QACA,KACA,QACA,OACA,YACA,QACA,SACA,WACA,OACA,SACA,UACA,SACA,OACA,SACA,WACA,MACA,MACA,OACA,UACA,QACA,QACA,WACA,QACA,OACA,OACA,QACA,UACA,WACA,SACA,QACA,OACA,SACA,SACA,QACA,SACA,QACA,aAGJC,SAAU,CACRP,MAAO,CACLQ,KAAM,WACNC,UAAU,KC3HVC,EAAM,CAAC,EAAEC,eAGTC,EAAa,CACjBC,KAAM,CAACC,SAAUC,GACjBC,QAwJF,SAAuBC,GACrB,OAAOA,EAAOC,cAAgB,CAACC,KAAMC,QAAqB3E,CAC5D,EAzJE4E,QA4JF,SAAuBJ,GACrB,OAAO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","sources":["lib/rag.js","../node_modules/hast-util-sanitize/lib/schema.js","../node_modules/hast-util-sanitize/lib/index.js","../node_modules/rehype-sanitize/index.js","pages/CEO_Dashboard/CEODashboardComponents/Chat.js","pages/CEO_Dashboard/constants/systems.js"],"sourcesContent":["// Simple in-memory TF-IDF based retrieval for demo RAG\r\n// Not production grade — lightweight and dependency-free\r\n\r\nfunction tokenize(text) {\r\n  return (text || \"\")\r\n    .toLowerCase()\r\n    .replace(/[^a-z0-9\\s]/g, \" \")\r\n    .split(/\\s+/)\r\n    .filter(Boolean);\r\n}\r\n\r\nfunction buildIndex(docs = []) {\r\n  // docs: array of { id, text, meta }\r\n  const N = docs.length;\r\n  const termDocCount = Object.create(null);\r\n  const docTerms = docs.map((d) => {\r\n    const toks = tokenize(d.text);\r\n    const tf = Object.create(null);\r\n    toks.forEach((t) => { tf[t] = (tf[t] || 0) + 1; });\r\n    Object.keys(tf).forEach((t) => { termDocCount[t] = (termDocCount[t] || 0) + 1; });\r\n    return tf;\r\n  });\r\n\r\n  const idf = Object.create(null);\r\n  Object.keys(termDocCount).forEach((t) => { idf[t] = Math.log(1 + N / termDocCount[t]); });\r\n\r\n  // compute tf-idf vectors (sparse) and norms\r\n  const docVectors = docTerms.map((tf) => {\r\n    const vec = Object.create(null);\r\n    let norm = 0;\r\n    Object.entries(tf).forEach(([t, f]) => {\r\n      const score = f * (idf[t] || 0);\r\n      vec[t] = score;\r\n      norm += score * score;\r\n    });\r\n    norm = Math.sqrt(norm) || 1;\r\n    return { vec, norm };\r\n  });\r\n\r\n  return { docs, idf, docVectors };\r\n}\r\n\r\nfunction scoreQuery(index, query) {\r\n  const qTokens = tokenize(query);\r\n  const qtf = Object.create(null);\r\n  qTokens.forEach((t) => { qtf[t] = (qtf[t] || 0) + 1; });\r\n\r\n  const qvec = Object.create(null);\r\n  let qnorm = 0;\r\n  Object.entries(qtf).forEach(([t, f]) => {\r\n    const val = f * (index.idf[t] || 0);\r\n    qvec[t] = val;\r\n    qnorm += val * val;\r\n  });\r\n  qnorm = Math.sqrt(qnorm) || 1;\r\n\r\n  const scores = index.docVectors.map(({ vec, norm }, i) => {\r\n    // dot product\r\n    let dot = 0;\r\n    Object.entries(qvec).forEach(([t, v]) => { if (vec[t]) dot += v * vec[t]; });\r\n    const sim = dot / (norm * qnorm);\r\n    return { i, sim };\r\n  });\r\n  return scores.sort((a, b) => b.sim - a.sim);\r\n}\r\n\r\nfunction queryIndex(index, query, topK = 5) {\r\n  if (!index || !index.docs || index.docs.length === 0) return [];\r\n  const scored = scoreQuery(index, query).filter(s => s.sim > 0);\r\n  return scored.slice(0, topK).map(s => ({ score: s.sim, doc: index.docs[s.i] }));\r\n}\r\n\r\nexport { buildIndex, queryIndex };\r\n","/** @type {import('./index.js').Schema} */\nexport const defaultSchema = {\n  strip: ['script'],\n  clobberPrefix: 'user-content-',\n  clobber: ['name', 'id'],\n  ancestors: {\n    tbody: ['table'],\n    tfoot: ['table'],\n    thead: ['table'],\n    td: ['table'],\n    th: ['table'],\n    tr: ['table']\n  },\n  protocols: {\n    href: ['http', 'https', 'mailto', 'xmpp', 'irc', 'ircs'],\n    cite: ['http', 'https'],\n    src: ['http', 'https'],\n    longDesc: ['http', 'https']\n  },\n  tagNames: [\n    'h1',\n    'h2',\n    'h3',\n    'h4',\n    'h5',\n    'h6',\n    'br',\n    'b',\n    'i',\n    'strong',\n    'em',\n    'a',\n    'pre',\n    'code',\n    'img',\n    'tt',\n    'div',\n    'ins',\n    'del',\n    'sup',\n    'sub',\n    'p',\n    'ol',\n    'ul',\n    'table',\n    'thead',\n    'tbody',\n    'tfoot',\n    'blockquote',\n    'dl',\n    'dt',\n    'dd',\n    'kbd',\n    'q',\n    'samp',\n    'var',\n    'hr',\n    'ruby',\n    'rt',\n    'rp',\n    'li',\n    'tr',\n    'td',\n    'th',\n    's',\n    'strike',\n    'summary',\n    'details',\n    'caption',\n    'figure',\n    'figcaption',\n    'abbr',\n    'bdo',\n    'cite',\n    'dfn',\n    'mark',\n    'small',\n    'span',\n    'time',\n    'wbr',\n    'input'\n  ],\n  attributes: {\n    a: ['href'],\n    img: ['src', 'longDesc'],\n    input: [\n      ['type', 'checkbox'],\n      ['disabled', true]\n    ],\n    li: [['className', 'task-list-item']],\n    div: ['itemScope', 'itemType'],\n    blockquote: ['cite'],\n    del: ['cite'],\n    ins: ['cite'],\n    q: ['cite'],\n    '*': [\n      'abbr',\n      'accept',\n      'acceptCharset',\n      'accessKey',\n      'action',\n      'align',\n      'alt',\n      'ariaDescribedBy',\n      'ariaHidden',\n      'ariaLabel',\n      'ariaLabelledBy',\n      'axis',\n      'border',\n      'cellPadding',\n      'cellSpacing',\n      'char',\n      'charOff',\n      'charSet',\n      'checked',\n      'clear',\n      'cols',\n      'colSpan',\n      'color',\n      'compact',\n      'coords',\n      'dateTime',\n      'dir',\n      'disabled',\n      'encType',\n      'htmlFor',\n      'frame',\n      'headers',\n      'height',\n      'hrefLang',\n      'hSpace',\n      'isMap',\n      'id',\n      'label',\n      'lang',\n      'maxLength',\n      'media',\n      'method',\n      'multiple',\n      'name',\n      'noHref',\n      'noShade',\n      'noWrap',\n      'open',\n      'prompt',\n      'readOnly',\n      'rel',\n      'rev',\n      'rows',\n      'rowSpan',\n      'rules',\n      'scope',\n      'selected',\n      'shape',\n      'size',\n      'span',\n      'start',\n      'summary',\n      'tabIndex',\n      'target',\n      'title',\n      'type',\n      'useMap',\n      'vAlign',\n      'value',\n      'vSpace',\n      'width',\n      'itemProp'\n    ]\n  },\n  required: {\n    input: {\n      type: 'checkbox',\n      disabled: true\n    }\n  }\n}\n","/**\n * @typedef {import('hast').Root} Root\n * @typedef {import('hast').Content} Content\n * @typedef {import('hast').Element} Element\n * @typedef {import('hast').Properties} Properties\n * @typedef {Content | Root} Node\n *\n * @typedef {Properties[string]} PropertyValue\n *   Possible property values.\n * @typedef {string | number | boolean} PrimitivePropertyValue\n *   Possible primitive HTML attribute values.\n *\n * @typedef {Record<string, Array<string | [string, ...Array<PrimitivePropertyValue | RegExp>]>>} Attributes\n *  Map of tag names to allow lists for each property.\n * @typedef {Record<string, Array<PrimitivePropertyValue | RegExp>>} AttributeClean\n *   Normalized input.\n *\n * @typedef Schema\n *   Sanitization configuration.\n * @property {Attributes | undefined} [attributes]\n *   Map of tag names to allowed properties.\n *\n *   The special `'*'` key defines property names allowed on all elements.\n * @property {Record<string, Record<string, PropertyValue>> | undefined} [required]\n *   Map of tag names to required property names and their default property value.\n * @property {Array<string> | undefined} [tagNames]\n *   List of allowed tag names.\n * @property {Record<string, Array<string>> | undefined} [protocols]\n *   Map of protocols to allow in property values.\n * @property {Record<string, Array<string>> | undefined} [ancestors]\n *   Map of tag names to their required ancestor elements.\n * @property {Array<string> | undefined} [clobber]\n *   List of allowed property names which can clobber.\n * @property {string | undefined} [clobberPrefix]\n *   Prefix to use before potentially clobbering property names.\n * @property {Array<string> | undefined} [strip]\n *   Names of elements to strip from the tree.\n * @property {boolean | undefined} [allowComments]\n *   Whether to allow comments.\n * @property {boolean | undefined} [allowDoctypes]\n *   Whether to allow doctypes.\n *\n * @typedef {(schema: Schema, value: any, node: any, stack: Array<string>) => unknown} Handler\n * @typedef {Record<string, Handler>} NodeDefinition\n * @typedef {((schema: Schema, node: Node) => NodeDefinition | undefined)} NodeDefinitionGetter\n * @typedef {Record<string, NodeDefinition | NodeDefinitionGetter>} NodeSchema\n */\n\nimport {defaultSchema} from './schema.js'\n\nconst own = {}.hasOwnProperty\n\n/** @type {NodeSchema} */\nconst nodeSchema = {\n  root: {children: all},\n  doctype: handleDoctype,\n  comment: handleComment,\n  element: {\n    tagName: handleTagName,\n    properties: handleProperties,\n    children: all\n  },\n  text: {value: handleValue},\n  '*': {data: allow, position: allow}\n}\n\n/**\n * Utility to sanitize a tree\n *\n * @param {Node} node\n *   Hast tree to sanitize\n * @param {Schema} [schema]\n *   Schema defining how to sanitize - defaults to Github style sanitation\n */\nexport function sanitize(node, schema) {\n  /** @type {Node} */\n  let ctx = {type: 'root', children: []}\n\n  if (node && typeof node === 'object' && node.type) {\n    const replace = one(\n      Object.assign({}, defaultSchema, schema || {}),\n      node,\n      []\n    )\n\n    if (replace) {\n      if (Array.isArray(replace)) {\n        if (replace.length === 1) {\n          ctx = replace[0]\n        } else {\n          // @ts-expect-error Assume `root` is not a child.\n          ctx.children = replace\n        }\n      } else {\n        ctx = replace\n      }\n    }\n  }\n\n  return ctx\n}\n\n/**\n * Sanitize `node`.\n *\n * @param {Schema} schema\n * @param {Node} node\n * @param {Array<string>} stack\n * @returns {Node | Array<Node> | undefined}\n */\nfunction one(schema, node, stack) {\n  const type = node && node.type\n  /** @type {Node} */\n  // @ts-expect-error rest of props added later.\n  const replacement = {type: node.type}\n  /** @type {boolean | undefined} */\n  let replace\n\n  if (own.call(nodeSchema, type)) {\n    /** @type {NodeDefinition | NodeDefinitionGetter | undefined} */\n    let definition = nodeSchema[type]\n\n    if (typeof definition === 'function') {\n      definition = definition(schema, node)\n    }\n\n    if (definition) {\n      const allowed = Object.assign({}, definition, nodeSchema['*'])\n      /** @type {string} */\n      let key\n\n      replace = true\n\n      for (key in allowed) {\n        if (own.call(allowed, key)) {\n          // @ts-expect-error: fine.\n          // type-coverage:ignore-next-line\n          const result = allowed[key](schema, node[key], node, stack)\n\n          // eslint-disable-next-line max-depth\n          if (result === false) {\n            replace = undefined\n            // Set the non-safe value.\n            // @ts-expect-error: fine.\n            // type-coverage:ignore-next-line\n            replacement[key] = node[key]\n          } else if (result !== undefined && result !== null) {\n            // @ts-expect-error: fine.\n            // type-coverage:ignore-next-line\n            replacement[key] = result\n          }\n        }\n      }\n    }\n  }\n\n  if (replace) {\n    return replacement\n  }\n\n  return replacement.type === 'element' &&\n    schema.strip &&\n    !schema.strip.includes(replacement.tagName)\n    ? replacement.children\n    : undefined\n}\n\n/**\n * Sanitize `children`.\n *\n * @type {Handler}\n * @param {Array<Node>} children\n * @param {Node} node\n * @returns {Array<Node>}\n */\nfunction all(schema, children, node, stack) {\n  /** @type {Array<Node>} */\n  const results = []\n\n  if (Array.isArray(children)) {\n    let index = -1\n\n    if (node.type === 'element') {\n      stack.push(node.tagName)\n    }\n\n    while (++index < children.length) {\n      const value = one(schema, children[index], stack)\n\n      if (value) {\n        if (Array.isArray(value)) {\n          results.push(...value)\n        } else {\n          results.push(value)\n        }\n      }\n    }\n\n    if (node.type === 'element') {\n      stack.pop()\n    }\n  }\n\n  return results\n}\n\n/** @type {NodeDefinitionGetter} */\nfunction handleDoctype(schema) {\n  return schema.allowDoctypes ? {name: handleDoctypeName} : undefined\n}\n\n/** @type {NodeDefinitionGetter} */\nfunction handleComment(schema) {\n  return schema.allowComments ? {value: handleCommentValue} : undefined\n}\n\n/**\n * Sanitize `properties`.\n *\n * @type {Handler}\n * @param {Properties} properties\n * @param {Element} node\n * @returns {Properties}\n */\nfunction handleProperties(schema, properties, node, stack) {\n  const name = handleTagName(schema, node.tagName, node, stack)\n  /* c8 ignore next */\n  const attrs = schema.attributes || {}\n  /* c8 ignore next */\n  const reqs = schema.required || {}\n  const props = properties || {}\n  const allowed = Object.assign(\n    {},\n    toPropertyValueMap(attrs['*']),\n    toPropertyValueMap(name && own.call(attrs, name) ? attrs[name] : [])\n  )\n  /** @type {Properties} */\n  const result = {}\n  /** @type {string} */\n  let key\n\n  for (key in props) {\n    if (own.call(props, key)) {\n      let value = props[key]\n      /** @type {AttributeClean[string]} */\n      let definition\n\n      if (own.call(allowed, key)) {\n        definition = allowed[key]\n      } else if (data(key) && own.call(allowed, 'data*')) {\n        definition = allowed['data*']\n      } else {\n        continue\n      }\n\n      value = Array.isArray(value)\n        ? handlePropertyValues(schema, value, key, definition)\n        : handlePropertyValue(schema, value, key, definition)\n\n      if (value !== undefined && value !== null) {\n        result[key] = value\n      }\n    }\n  }\n\n  if (name && own.call(reqs, name)) {\n    for (key in reqs[name]) {\n      if (!own.call(result, key)) {\n        result[key] = reqs[name][key]\n      }\n    }\n  }\n\n  return result\n}\n\n/**\n * Always return a valid HTML5 doctype.\n *\n * @type {Handler}\n * @returns {string}\n */\nfunction handleDoctypeName() {\n  return 'html'\n}\n\n/**\n * Sanitize `tagName`.\n *\n * @param {Schema} schema\n * @param {string} tagName\n * @param {Node} _\n * @param {Array<string>} stack\n * @returns {string | false}\n */\nfunction handleTagName(schema, tagName, _, stack) {\n  const name = typeof tagName === 'string' ? tagName : ''\n  let index = -1\n\n  if (\n    !name ||\n    name === '*' ||\n    (schema.tagNames && !schema.tagNames.includes(name))\n  ) {\n    return false\n  }\n\n  // Some nodes can break out of their context if they don’t have a certain\n  // ancestor.\n  if (schema.ancestors && own.call(schema.ancestors, name)) {\n    while (++index < schema.ancestors[name].length) {\n      if (stack.includes(schema.ancestors[name][index])) {\n        return name\n      }\n    }\n\n    return false\n  }\n\n  return name\n}\n\n/**\n * See <https://html.spec.whatwg.org/multipage/parsing.html#serialising-html-fragments>\n *\n * @type {Handler}\n * @param {unknown} value\n * @returns {string}\n */\nfunction handleCommentValue(_, value) {\n  /** @type {string} */\n  const result = typeof value === 'string' ? value : ''\n  const index = result.indexOf('-->')\n  return index < 0 ? result : result.slice(0, index)\n}\n\n/**\n * Sanitize `value`.\n *\n * @type {Handler}\n * @param {unknown} value\n * @returns {string}\n */\nfunction handleValue(_, value) {\n  return typeof value === 'string' ? value : ''\n}\n\n/**\n * Allow `value`.\n *\n * @type {Handler}\n * @param {unknown} value\n */\nfunction allow(_, value) {\n  return value\n}\n\n/**\n * Sanitize a property value which is a list.\n *\n * @param {Schema} schema\n * @param {Array<unknown>} values\n * @param {string} prop\n * @param {AttributeClean[string]} definition\n * @returns {Array<string | number>}\n */\nfunction handlePropertyValues(schema, values, prop, definition) {\n  let index = -1\n  /** @type {Array<string | number>} */\n  const result = []\n\n  while (++index < values.length) {\n    const value = handlePropertyValue(schema, values[index], prop, definition)\n\n    if (value !== undefined && value !== null) {\n      // @ts-expect-error Assume no booleans were in arrays.\n      result.push(value)\n    }\n  }\n\n  return result\n}\n\n/**\n * Sanitize a property value.\n *\n * @param {Schema} schema\n * @param {unknown} value\n * @param {string} prop\n * @param {AttributeClean[string]} definition\n * @returns {PropertyValue}\n */\nfunction handlePropertyValue(schema, value, prop, definition) {\n  if (\n    (typeof value === 'boolean' ||\n      typeof value === 'number' ||\n      typeof value === 'string') &&\n    safeProtocol(schema, value, prop) &&\n    (definition.length === 0 ||\n      definition.some((allowed) =>\n        allowed && typeof allowed === 'object' && 'flags' in allowed\n          ? allowed.test(String(value))\n          : allowed === value\n      ))\n  ) {\n    return schema.clobberPrefix &&\n      schema.clobber &&\n      schema.clobber.includes(prop)\n      ? schema.clobberPrefix + value\n      : value\n  }\n}\n\n/**\n * Check whether `value` is a safe URL.\n *\n * @param {Schema} schema\n * @param {unknown} value\n * @param {string} prop\n * @returns {boolean}\n */\nfunction safeProtocol(schema, value, prop) {\n  const url = String(value)\n  const colon = url.indexOf(':')\n  const questionMark = url.indexOf('?')\n  const numberSign = url.indexOf('#')\n  const slash = url.indexOf('/')\n  const protocols =\n    schema.protocols && own.call(schema.protocols, prop)\n      ? schema.protocols[prop].concat()\n      : []\n  let index = -1\n\n  if (\n    protocols.length === 0 ||\n    colon < 0 ||\n    // If the first colon is after a `?`, `#`, or `/`, it’s not a protocol.\n    (slash > -1 && colon > slash) ||\n    (questionMark > -1 && colon > questionMark) ||\n    (numberSign > -1 && colon > numberSign)\n  ) {\n    return true\n  }\n\n  while (++index < protocols.length) {\n    if (\n      colon === protocols[index].length &&\n      url.slice(0, protocols[index].length) === protocols[index]\n    ) {\n      return true\n    }\n  }\n\n  return false\n}\n\n/**\n * Create a map from a list of props or a list of properties and values.\n *\n * @param {Attributes[string]} values\n * @returns {AttributeClean}\n */\nfunction toPropertyValueMap(values) {\n  /** @type {AttributeClean} */\n  const result = {}\n  let index = -1\n\n  while (++index < values.length) {\n    const value = values[index]\n\n    if (Array.isArray(value)) {\n      result[value[0]] = value.slice(1)\n    } else {\n      result[value] = []\n    }\n  }\n\n  return result\n}\n\n/**\n * Check if `prop` is a data property.\n *\n * @param {string} prop\n * @returns {boolean}\n */\nfunction data(prop) {\n  return prop.length > 4 && prop.slice(0, 4).toLowerCase() === 'data'\n}\n","/**\n * @typedef {import('hast').Root} Root\n *\n * @typedef {import('hast-util-sanitize').Schema} Options\n *   The sanitation schema defines how and if nodes and properties should be cleaned.\n *   See `hast-util-sanitize`.\n *   The default schema is exported as `defaultSchema`.\n */\n\nimport {sanitize as hastUtilSanitize, defaultSchema} from 'hast-util-sanitize'\n\n/**\n * Plugin to sanitize HTML.\n *\n * @type {import('unified').Plugin<[Options?] | Array<void>, Root, Root>}\n */\nexport default function rehypeSanitize(options = defaultSchema) {\n  // @ts-expect-error: assume input `root` matches output root.\n  return (tree) => hastUtilSanitize(tree, options)\n}\n\nexport {defaultSchema} from 'hast-util-sanitize'\n","import React, { useEffect, useMemo, useRef, useState } from \"react\";\r\nimport { useOutletContext } from \"react-router-dom\";\r\nimport { FaPaperPlane, FaPaperclip } from \"react-icons/fa\";\r\nimport { useAuth } from \"../../../contexts/AuthContext\";\r\nimport { normalizeSystemKey, CANONICAL_SYSTEMS } from \"../constants/systems\";\r\nimport { generateSystemReport } from \"../../../utils/aiPromptGenerator\";\r\nimport { buildIndex, queryIndex } from \"../../../lib/rag\";\r\nimport ReactMarkdown from 'react-markdown';\r\nimport remarkGfm from 'remark-gfm';\r\nimport rehypeRaw from 'rehype-raw';\r\nimport rehypeSanitize from 'rehype-sanitize';\r\n\r\nfunction TypingIndicator({ darkMode }) {\r\n  const dotClass = `h-2 w-2 rounded-full animate-pulse ${darkMode ? \"bg-gray-500\" : \"bg-gray-400\"}`;\r\n  return (\r\n    <div className={`flex items-center gap-2 text-sm ${darkMode ? \"text-gray-400\" : \"text-gray-500\"}`}>\r\n      <div className={dotClass} />\r\n      <div className={`${dotClass} delay-75`} />\r\n      <div className={`${dotClass} delay-150`} />\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction MessageRow({ m, darkMode }) {\r\n  const isUser = m.role === \"user\";\r\n  const userClasses = \"bg-blue-600 text-white rounded-xl max-w-[90%] px-4 py-2 shadow-md break-words\";\r\n  const assistantLight =\r\n    \"bg-gradient-to-r from-gray-50 to-white border border-gray-100 text-gray-900 rounded-xl max-w-[90%] px-4 py-2 shadow-sm break-words\";\r\n  const assistantDark = \"bg-gray-700 text-gray-100 rounded-xl max-w-[90%] px-4 py-2 shadow-sm border border-gray-700 break-words\";\r\n\r\n  return (\r\n    <div className={`flex ${isUser ? \"justify-end\" : \"justify-start\"} my-3`}>\r\n      <div className={`flex flex-col ${isUser ? \"items-end\" : \"items-start\"} min-w-0`}>\r\n        <div className={`${isUser ? userClasses : darkMode ? assistantDark : assistantLight}`}>\r\n          <div className=\"text-sm whitespace-pre-wrap\">{m.text}</div>\r\n          {m.file && (\r\n            <div className=\"mt-2 text-xs\">\r\n              <a href={m.file.url} target=\"_blank\" rel=\"noreferrer\" className=\"underline\">\r\n                {m.file.name}\r\n              </a>\r\n            </div>\r\n          )}\r\n        </div>\r\n        <div className={`text-[11px] mt-2 ${darkMode ? \"text-gray-400\" : \"text-gray-500\"}`}>\r\n          {new Date(m.timestamp).toLocaleTimeString([], { hour: \"2-digit\", minute: \"2-digit\" })}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction ChatComposer({ onSend, darkMode, onAttachClick, textareaRef, textValue, setTextValue, uploadedFile, setUploadedFile, onTyping }) {\r\n  function handleKeyDown(e) {\r\n    if (e.key === \"Enter\" && !e.shiftKey) {\r\n      e.preventDefault();\r\n      if (textValue && textValue.trim()) {\r\n        onSend(textValue.trim());\r\n        setTextValue(\"\");\r\n      }\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (!textareaRef.current) return;\r\n    const ta = textareaRef.current;\r\n    ta.style.height = \"auto\";\r\n    const newHeight = Math.min(ta.scrollHeight, 220);\r\n    ta.style.height = `${newHeight}px`;\r\n  }, [textValue, textareaRef]);\r\n\r\n  return (\r\n    <div\r\n      className={`p-3 border-t ${darkMode ? \"border-gray-700 bg-gray-800\" : \"border-gray-200 bg-white\"}`}\r\n      style={{ boxShadow: darkMode ? \"0 -2px 8px rgba(0,0,0,0.6)\" : \"0 -2px 8px rgba(0,0,0,0.04)\" }}\r\n    >\r\n      {uploadedFile && (\r\n        <div className={`mb-3 p-3 rounded-md border ${darkMode ? \"bg-gray-900 border-gray-700 text-gray-100\" : \"bg-gray-50 border-gray-100 text-gray-900\"}`}>\r\n          <div className=\"flex items-center justify-between gap-4\">\r\n            <div className=\"min-w-0\">\r\n              <div className=\"font-medium truncate\">{uploadedFile.name}</div>\r\n              <div className=\"text-xs text-gray-400\">{(uploadedFile.size / 1024).toFixed(1)} KB</div>\r\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <button className=\"px-3 py-1 rounded-md border\" onClick={() => setUploadedFile(null)} aria-label=\"Remove file\">\r\n                x\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"flex items-end gap-2 min-w-0\">\r\n        <textarea\r\n          ref={textareaRef}\r\n          value={textValue}\r\n          onChange={(e) => { setTextValue(e.target.value); onTyping && onTyping(); }}\r\n          onKeyDown={handleKeyDown}\r\n          placeholder=\"Ask your executive analyst\"\r\n          className={`flex-1 min-w-0 resize-none rounded-lg px-4 py-3 border hide-scrollbar ${\r\n            darkMode ? \"border-gray-700 bg-gray-900 text-gray-100\" : \"border-gray-200 bg-gray-50 text-gray-900\"\r\n          } outline-none focus:ring-2 focus:ring-indigo-200`}\r\n          rows={1}\r\n          aria-label=\"Chat input\"\r\n          style={{ maxHeight: 220 }}\r\n        />\r\n\r\n        <div className=\"flex flex-col items-end\">\r\n          <button\r\n            onClick={() => {\r\n                if (textValue && textValue.trim()) {\r\n                  onSend(textValue.trim());\r\n                  setTextValue(\"\");\r\n                }\r\n              }}\r\n            aria-label=\"Send\"\r\n            className={`p-2 rounded-md ${textValue.trim() ? \"bg-indigo-600 text-white\" : \"bg-gray-200 text-gray-500\"}`}\r\n            style={{ width: 36, height: 36 }}\r\n          >\r\n            <FaPaperPlane size={14} />\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"mt-3 flex items-center gap-3\">\r\n        <button\r\n          onClick={onAttachClick}\r\n          aria-label=\"Attach file\"\r\n          className={`flex items-center gap-2 px-3 py-2 rounded-md border ${darkMode ? \"border-gray-700 text-gray-100 bg-gray-800\" : \"border-gray-200 text-gray-800 bg-white\"}`}\r\n        >\r\n          <FaPaperclip /> <span className=\"text-sm\">Upload Document</span>\r\n        </button>\r\n        <div className={`text-xs ${darkMode ? \"text-gray-400\" : \"text-gray-500\"}`}>PDF, DOCX</div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default function CEOChat() {\r\n  const { darkMode } = useOutletContext();\r\n  const auth = useAuth();\r\n\r\n  const [conversations] = useState([\r\n    { id: \"c1\", title: \"Executive Summary Chat\", lastMessage: \"What's the top 3 priorities for the next quarter?\" },\r\n    { id: \"c2\", title: \"Financial Health Review\", lastMessage: \"Explain EBITDA variance\" },\r\n  ]);\r\n  const [selectedConversationId, setSelectedConversationId] = useState(\"c1\");\r\n\r\n  const [messages, setMessages] = useState([\r\n    { id: \"m0\", role: \"system\", text: \"Welcome to ConseQ-X Ultra - your Executive Analyst.\", timestamp: new Date().toISOString() },\r\n  ]);\r\n  const [isGenerating, setIsGenerating] = useState(false);\r\n  const [userTyping, setUserTyping] = useState(false);\r\n\r\n  // debounce typing indicator\r\n  const typingTimerRef = useRef(null);\r\n  const handleUserTyping = () => {\r\n    setUserTyping(true);\r\n    if (typingTimerRef.current) clearTimeout(typingTimerRef.current);\r\n    typingTimerRef.current = setTimeout(() => setUserTyping(false), 1200);\r\n  };\r\n\r\n  const fileInputRef = useRef(null);\r\n  const messagesRef = useRef(null);\r\n  const textareaRef = useRef(null);\r\n  const [textValue, setTextValue] = useState(\"\");\r\n  const [uploadedFile, setUploadedFile] = useState(null);\r\n\r\n  // Pull most recent assessments for org from local storage to power explainability.\r\n  // We respect the existing key and shape used by Assessments page.\r\n  const orgId = auth?.org?.id || \"anon\";\r\n  const [assessments, setAssessments] = useState(() => {\r\n    try {\r\n      const raw = localStorage.getItem(\"conseqx_assessments_v1\");\r\n      const all = raw ? JSON.parse(raw) : {};\r\n      return all[orgId] || [];\r\n    } catch {\r\n      return [];\r\n    }\r\n  });\r\n\r\n  useEffect(() => {\r\n    function refresh() {\r\n      try {\r\n        const raw = localStorage.getItem(\"conseqx_assessments_v1\");\r\n        const all = raw ? JSON.parse(raw) : {};\r\n        setAssessments(all[orgId] || []);\r\n      } catch {}\r\n    }\r\n    const onStorage = (e) => {\r\n      if (e.key === \"conseqx_assessments_v1\" || e.key === null) refresh();\r\n    };\r\n    window.addEventListener(\"storage\", onStorage);\r\n    let bc;\r\n    try {\r\n      if (\"BroadcastChannel\" in window) {\r\n        bc = new BroadcastChannel(\"conseqx_assessments\");\r\n        bc.addEventListener(\"message\", (ev) => {\r\n          if (ev?.data?.type === \"assessments:update\" && ev?.data?.orgId === orgId) refresh();\r\n        });\r\n      }\r\n    } catch {}\r\n    const poll = setInterval(refresh, 3000);\r\n    return () => {\r\n      window.removeEventListener(\"storage\", onStorage);\r\n      clearInterval(poll);\r\n      if (bc) try { bc.close(); } catch {}\r\n    };\r\n  }, [orgId]);\r\n\r\n  const latestBySystem = useMemo(() => {\r\n    const map = {};\r\n    assessments.forEach((r) => {\r\n      if (!r.systemId) return;\r\n      const k = normalizeSystemKey(r.systemId);\r\n      const cur = map[k];\r\n      if (!cur || (cur.timestamp || 0) < (r.timestamp || 0)) map[k] = { ...r, systemId: k };\r\n    });\r\n    return map;\r\n  }, [assessments]);\r\n\r\n  const titleByKey = useMemo(() => {\r\n    const m = {};\r\n    CANONICAL_SYSTEMS.forEach((s) => (m[s.key] = s.title));\r\n    return m;\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (messagesRef.current) {\r\n      messagesRef.current.scrollTop = messagesRef.current.scrollHeight + 200;\r\n    }\r\n  }, [messages, isGenerating]);\r\n\r\n  function simulateAssistantReply(prompt) {\r\n    // fallback simple simulation (kept for offline/dev)\r\n    setIsGenerating(true);\r\n    const lines = [\"Based on the most recent assessments, here are explainable priorities:\"];\r\n    const systems = Object.keys(latestBySystem);\r\n    if (systems.length === 0) lines.push(\"- No recent system runs found. Start an assessment in the Assessments tab.\");\r\n    else {\r\n      systems.slice(0, 3).forEach((sid) => {\r\n        const r = latestBySystem[sid];\r\n        const label = titleByKey[sid] || r?.title || sid;\r\n        lines.push(`- ${label}: score ${r?.score ?? \"-\"}%.`);\r\n      });\r\n    }\r\n    lines.push(\"\\nWould you like a 4-week action plan with owners and KPIs?\");\r\n    const replyText = lines.join(\"\\n\");\r\n    const id = `m-assistant-${Date.now()}`;\r\n    setMessages((prev) => [...prev, { id, role: \"assistant\", text: \"\", timestamp: new Date().toISOString() }]);\r\n    let idx = 0;\r\n    const interval = setInterval(() => {\r\n      idx += 30;\r\n      const chunk = replyText.slice(0, idx);\r\n      setMessages((prev) => prev.map((m) => (m.id === id ? { ...m, text: chunk } : m)));\r\n      if (idx >= replyText.length) {\r\n        clearInterval(interval);\r\n        setIsGenerating(false);\r\n      }\r\n    }, 50);\r\n  }\r\n\r\n\r\n  async function handleSendMessage(text) {\r\n    const userMsg = { id: `m-user-${Date.now()}`, role: \"user\", text, timestamp: new Date().toISOString(), file: uploadedFile ? { ...uploadedFile } : undefined };\r\n    setMessages((prev) => [...prev, userMsg]);\r\n    setUploadedFile(null);\r\n\r\n    // Show immediate assistant typing placeholder for friendliness\r\n    const placeholderId = `m-assistant-${Date.now()}`;\r\n    setMessages((prev) => [...prev, { id: placeholderId, role: \"assistant\", text: \"...\", timestamp: new Date().toISOString() }]);\r\n    setIsGenerating(true);\r\n\r\n    // Build scores map from latestBySystem\r\n    const scores = {};\r\n    Object.keys(latestBySystem).forEach((k) => {\r\n      scores[k] = latestBySystem[k]?.score ?? null;\r\n    });\r\n\r\n    // helper to detect whether user asked about assessments/org\r\n    const needsAssessmentContext = (t) => {\r\n      if (!t) return false;\r\n      const pattern = /\\b(assess|assessment|score|scores|system|systems|results|report|priority|action plan|org|organization|company|revenue|metrics|kpi|kpis|how did we do|what is my score)\\b/i;\r\n      return pattern.test(t);\r\n    };\r\n\r\n    const openRouterKey = process.env.REACT_APP_OPENROUTER_KEY;\r\n    const modelUrl = \"https://openrouter.ai/api/v1/chat/completions\";\r\n\r\n    try {\r\n      setIsGenerating(true);\r\n      const assistantId = placeholderId;\r\n      // ensure assistant placeholder already added earlier; replace it by updating messages\r\n\r\n        // If user requested assessment/org context and we have assessment scores, include the report\r\n        if (needsAssessmentContext(text) && Object.keys(scores).length > 0 && openRouterKey) {\r\n          const userInfo = { name: auth?.user?.name || auth?.user?.email || \"User\", org: auth?.org?.name || \"Organization\" };\r\n\r\n          // Build small docs from assessments: one summary per system plus recent notes\r\n          const docs = Object.values(latestBySystem || {}).map(r => ({\r\n            id: r.id || `${r.systemId}-${r.timestamp}`,\r\n            text: `System: ${r.systemId}\\nScore: ${r.score}\\nNotes: ${JSON.stringify(r.meta || {})}`,\r\n            meta: { systemId: r.systemId, score: r.score, timestamp: r.timestamp }\r\n          }));\r\n\r\n          const index = buildIndex(docs);\r\n          const hits = queryIndex(index, text, 6);\r\n          const reportChunks = hits.map(h => `- [${h.doc.meta.systemId}] score: ${h.doc.meta.score} — excerpt: ${h.doc.text.slice(0, 200)}`);\r\n          const report = reportChunks.join('\\n');\r\n\r\n          const systemPrompt = `You are an executive AI assistant. Use the following assessment report to answer the user's question precisely and with actionable recommendations. Use concise bullet points and suggested owners/KPIs when relevant. Always include African/Nigerian context where possible.`;\r\n\r\n          const chatPayload = {\r\n            model: \"mistralai/mistral-7b-instruct\",\r\n            messages: [\r\n              { role: \"system\", content: systemPrompt },\r\n              { role: \"system\", content: `AssessmentReport:\\n${report}` },\r\n              { role: \"user\", content: text }\r\n            ]\r\n          };\r\n\r\n        const res = await fetch(modelUrl, {\r\n          method: \"POST\",\r\n          headers: {\r\n            Authorization: `Bearer ${openRouterKey}`,\r\n            \"Content-Type\": \"application/json\",\r\n          },\r\n          body: JSON.stringify(chatPayload)\r\n        });\r\n\r\n        if (!res.ok) {\r\n          const txt = await res.text();\r\n          setMessages((prev) => prev.map((m) => (m.id === assistantId ? { ...m, text: `Error generating response: ${txt}` } : m)));\r\n          setIsGenerating(false);\r\n          return;\r\n        }\r\n\r\n        const payload = await res.json();\r\n        const output = payload.choices?.[0]?.message?.content ?? \"\";\r\n\r\n        // Typing animation for the assistant reply\r\n        let idx = 0;\r\n        const total = output.length;\r\n        const tick = setInterval(() => {\r\n          idx = Math.min(total, idx + Math.max(20, Math.round(total / 30)));\r\n          const chunk = output.slice(0, idx);\r\n          setMessages((prev) => prev.map((m) => (m.id === assistantId ? { ...m, text: chunk } : m)));\r\n          if (idx >= total) {\r\n            clearInterval(tick);\r\n            setIsGenerating(false);\r\n          }\r\n        }, 40);\r\n        return;\r\n      }\r\n\r\n      // Otherwise: normal conversational flow — call model with a friendly system prompt (no heavy report)\r\n      if (!openRouterKey) {\r\n        // fallback to simulated reply\r\n        simulateAssistantReply(text);\r\n        return;\r\n      }\r\n\r\n      const friendlySystemPrompt = `You are a friendly, conversational executive assistant. Be warm and concise. Answer conversational questions naturally. Only provide assessment-specific analysis if the user asks for it.`;\r\n      const chatPayload = {\r\n        model: \"mistralai/mistral-7b-instruct\",\r\n        messages: [\r\n          { role: \"system\", content: friendlySystemPrompt },\r\n          { role: \"user\", content: text }\r\n        ]\r\n      };\r\n\r\n      const res2 = await fetch(modelUrl, {\r\n        method: \"POST\",\r\n        headers: {\r\n          Authorization: `Bearer ${openRouterKey}`,\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify(chatPayload)\r\n      });\r\n\r\n      if (!res2.ok) {\r\n        const txt = await res2.text();\r\n        setMessages((prev) => prev.map((m) => (m.id === assistantId ? { ...m, text: `Error generating response: ${txt}` } : m)));\r\n        setIsGenerating(false);\r\n        return;\r\n      }\r\n\r\n      const payload2 = await res2.json();\r\n      const output2 = payload2.choices?.[0]?.message?.content ?? \"\";\r\n\r\n      let idx2 = 0;\r\n      const total2 = output2.length;\r\n      const tick2 = setInterval(() => {\r\n        idx2 = Math.min(total2, idx2 + Math.max(20, Math.round(total2 / 30)));\r\n        const chunk = output2.slice(0, idx2);\r\n        setMessages((prev) => prev.map((m) => (m.id === assistantId ? { ...m, text: chunk } : m)));\r\n        if (idx2 >= total2) {\r\n          clearInterval(tick2);\r\n          setIsGenerating(false);\r\n        }\r\n      }, 40);\r\n\r\n    } catch (err) {\r\n      console.error(err);\r\n      simulateAssistantReply(text);\r\n    }\r\n  }\r\n\r\n  function handleUploadFile(file) {\r\n    if (!file) return;\r\n    const url = URL.createObjectURL(file);\r\n    setUploadedFile({ name: file.name, size: file.size, url });\r\n  }\r\n\r\n  return (\r\n    <section>\r\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n        <div\r\n          className={`md:col-span-1 rounded-2xl p-4 h-[62vh] overflow-auto hide-scrollbar ${\r\n            darkMode ? \"border border-gray-700 bg-gray-900 text-gray-100\" : \"border border-gray-100 bg-white text-gray-900\"\r\n          }`}\r\n        >\r\n          <div className={`text-xs ${darkMode ? \"text-gray-400\" : \"text-gray-500\"}`}>{conversations.length} chats</div>\r\n          <ul className=\"mt-3 space-y-2\">\r\n            {conversations.map((c) => {\r\n              const selected = selectedConversationId === c.id;\r\n              const itemClass = selected\r\n                ? darkMode\r\n                  ? \"bg-blue-900/20\"\r\n                  : \"bg-blue-50\"\r\n                : darkMode\r\n                ? \"hover:bg-blue-900/20\"\r\n                : \"hover:bg-blue-50\";\r\n              return (\r\n                <li\r\n                  key={c.id}\r\n                  onClick={() => setSelectedConversationId(c.id)}\r\n                  className={`p-2 rounded-md cursor-pointer ${itemClass}`}\r\n                >\r\n                  <div className={`font-medium ${darkMode ? \"text-gray-100\" : \"\"}`}>{c.title}</div>\r\n                  <div className={`text-xs ${darkMode ? \"text-gray-400\" : \"text-gray-400\"}`}>{c.lastMessage}</div>\r\n                </li>\r\n              );\r\n            })}\r\n          </ul>\r\n        </div>\r\n\r\n        <div\r\n          className={`md:col-span-2 rounded-2xl p-0 md:p-4 h-[60vh] flex flex-col min-w-0 ${\r\n            darkMode ? \"border border-gray-700 bg-gray-900 text-gray-100\" : \"border border-gray-100 bg-white text-gray-900\"\r\n          }`}\r\n        >\r\n          <div className=\"flex items-center justify-between p-3 border-b\" style={{ borderColor: darkMode ? \"rgba(255,255,255,0.04)\" : \"\" }}>\r\n            <div>\r\n              <div className=\"font-semibold\">Executive Analyst</div>\r\n              <div className={`text-xs ${darkMode ? \"text-gray-400\" : \"text-gray-400\"}`}>{isGenerating ? \"Assistant is typing...\" : \"All caught up\"}</div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"flex-1 overflow-auto px-4 py-3 hide-scrollbar\" ref={messagesRef} style={{ WebkitOverflowScrolling: \"touch\" }}>\r\n            {messages.map((m) => (\r\n              <div key={m.id} className=\"my-3\">\r\n                {m.role === 'assistant' ? (\r\n                  <div className={`inline-block rounded-xl px-4 py-3 ${darkMode ? \"bg-gray-700 text-gray-100\" : \"bg-gray-50 text-gray-900\"}` }>\r\n                    <ReactMarkdown remarkPlugins={[remarkGfm]} rehypePlugins={[rehypeRaw, rehypeSanitize]}>{m.text}</ReactMarkdown>\r\n                  </div>\r\n                ) : (\r\n                  <MessageRow m={m} darkMode={darkMode} />\r\n                )}\r\n              </div>\r\n            ))}\r\n\r\n            {isGenerating && (\r\n              <div className=\"mt-2\">\r\n                <div className={`inline-block rounded-xl px-4 py-3 ${darkMode ? \"bg-gray-700 text-gray-100\" : \"bg-gray-100 text-gray-900\"}`}>\r\n                  <TypingIndicator darkMode={darkMode} />\r\n                </div>\r\n              </div>\r\n            )}\r\n            {userTyping && (\r\n              <div className=\"mt-2 text-xs italic text-gray-400\">You are typing...</div>\r\n            )}\r\n          </div>\r\n\r\n          <ChatComposer\r\n            onSend={(t) => handleSendMessage(t)}\r\n            darkMode={darkMode}\r\n            onAttachClick={() => fileInputRef.current && fileInputRef.current.click()}\r\n            textareaRef={textareaRef}\r\n            textValue={textValue}\r\n            setTextValue={setTextValue}\r\n            uploadedFile={uploadedFile}\r\n            setUploadedFile={setUploadedFile}\r\n            onTyping={handleUserTyping}\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      {/* hidden file input */}\r\n      <input\r\n        ref={fileInputRef}\r\n        type=\"file\"\r\n        className=\"hidden\"\r\n        onChange={(e) => {\r\n          const f = e.target.files?.[0];\r\n          if (f) handleUploadFile(f);\r\n          e.target.value = \"\";\r\n        }}\r\n      />\r\n    </section>\r\n  );\r\n}\r\n","/**\r\n * Canonical  {\r\n    key: 'orchestration',\r\n    title: 'Orchestration',\r\n    description: 'Development cycles, sprint planning, and continuous improvement',\r\n    icon: '🔄',\r\n    color: '#10B981', // emerald-500\r\n    order: 2\r\n  }, for C-Suite Partner Dashboard\r\n * \r\n * Defines the six core systems that form the assessment framework,\r\n * display metadata, and legacy key mapping for backwards compatibility.\r\n */\r\n\r\n// Six canonical systems with display metadata\r\nexport const CANONICAL_SYSTEMS = [\r\n  {\r\n    key: 'interdependency',\r\n    title: 'Interdependency',\r\n    description: 'Cross-functional collaboration and dependency management',\r\n    icon: '🔗',\r\n    color: '#3B82F6', // blue-500\r\n    order: 1\r\n  },\r\n  {\r\n    key: 'orchestration',\r\n    title: 'Orchestration',\r\n    description: 'Development cycles, sprint planning, and continuous improvement',\r\n    icon: '🔄',\r\n    color: '#10B981', // emerald-500\r\n    order: 2\r\n  },\r\n  {\r\n    key: 'investigation',\r\n    title: 'Investigation',\r\n    description: 'Data analysis, research, and discovery processes',\r\n    icon: '🔎',\r\n    color: '#F59E0B', // amber-500\r\n    order: 3\r\n  },\r\n  {\r\n    key: 'interpretation',\r\n    title: 'Interpretation',\r\n    description: 'Insight generation, decision-making, and strategic analysis',\r\n    icon: '💡',\r\n    color: '#8B5CF6', // violet-500\r\n    order: 4\r\n  },\r\n  {\r\n    key: 'illustration',\r\n    title: 'Illustration',\r\n    description: 'Communication, visualization, and knowledge sharing',\r\n    icon: '🔄',\r\n    color: '#EF4444', // red-500\r\n    order: 5\r\n  },\r\n  {\r\n    key: 'inlignment',\r\n    title: 'Inlignment',\r\n    description: 'Strategic coordination, goal setting, and organizational coherence',\r\n    icon: '🎯',\r\n    color: '#06B6D4', // cyan-500\r\n    order: 6\r\n  }\r\n];\r\n\r\n// Legacy system keys mapping to canonical keys for backwards compatibility\r\n// TODO: Remove legacy mappings after migration period (6 months)\r\nexport const LEGACY_TO_CANONICAL = {\r\n  // Legacy keys that need normalization\r\n  'orchestration': 'orchestration', // legacy iteration maps to orchestration\r\n  'inlignment': 'inlignment', // legacy ilignment maps to inlignment\r\n  \r\n  // Ensure canonical keys map to themselves\r\n  'interdependency': 'interdependency',\r\n  'orchestration': 'orchestration',\r\n  'investigation': 'investigation',\r\n  'interpretation': 'interpretation',\r\n  'illustration': 'illustration',\r\n  'inlignment': 'inlignment',\r\n  \r\n  // Additional legacy variations that might exist\r\n  'dependency': 'interdependency',\r\n  'dependencies': 'interdependency',\r\n  'analysis': 'investigation',\r\n  'research': 'investigation',\r\n  'insights': 'interpretation',\r\n  'reporting': 'illustration',\r\n  'visualization': 'illustration',\r\n  'coordination': 'inlignment',\r\n  'strategy': 'inlignment'\r\n};\r\n\r\n/**\r\n * Normalize a system key from legacy format to canonical format\r\n * @param {string} systemKey - Raw system key (possibly legacy)\r\n * @returns {string} Canonical system key\r\n */\r\nexport function normalizeSystemKey(systemKey) {\r\n  if (!systemKey || typeof systemKey !== 'string') {\r\n    return 'investigation'; // Default fallback\r\n  }\r\n  \r\n  const normalized = systemKey.toLowerCase().trim();\r\n  return LEGACY_TO_CANONICAL[normalized] || normalized;\r\n}\r\n\r\n/**\r\n * Get system metadata by canonical key\r\n * @param {string} systemKey - Canonical system key\r\n * @returns {object|null} System metadata or null if not found\r\n */\r\nexport function getSystemMetadata(systemKey) {\r\n  const canonical = normalizeSystemKey(systemKey);\r\n  return CANONICAL_SYSTEMS.find(s => s.key === canonical) || null;\r\n}\r\n\r\n/**\r\n * Get all systems formatted for UI display (sorted by order)\r\n * @returns {Array} Systems with UI metadata\r\n */\r\nexport function getSystemsForUI() {\r\n  return CANONICAL_SYSTEMS\r\n    .sort((a, b) => a.order - b.order)\r\n    .map(system => ({\r\n      id: system.key,\r\n      key: system.key,\r\n      title: system.title,\r\n      description: system.description,\r\n      icon: system.icon,\r\n      color: system.color\r\n    }));\r\n}\r\n\r\n/**\r\n * Validate if a system key is canonical\r\n * @param {string} systemKey - System key to validate\r\n * @returns {boolean} True if canonical, false otherwise\r\n */\r\nexport function isCanonicalSystem(systemKey) {\r\n  return CANONICAL_SYSTEMS.some(s => s.key === systemKey);\r\n}\r\n\r\n// Default system weights for org health calculation\r\n// TODO: Make these configurable per organization\r\nexport const DEFAULT_SYSTEM_WEIGHTS = {\r\n  'interdependency': 0.18,\r\n  'orchestration': 0.20,\r\n  'investigation': 0.16,\r\n  'interpretation': 0.18,\r\n  'illustration': 0.14,\r\n  'inlignment': 0.14\r\n};\r\n\r\n// Ensure weights sum to 1.0\r\nconst weightSum = Object.values(DEFAULT_SYSTEM_WEIGHTS).reduce((sum, w) => sum + w, 0);\r\nif (Math.abs(weightSum - 1.0) > 0.001) {\r\n  console.warn(`[systems.js] System weights sum to ${weightSum.toFixed(3)}, should be 1.0`);\r\n}\r\n\r\n// Organizational Health Framework Metadata\r\n// This positions our tool as an \"organizational doctor\" that provides\r\n// automated diagnosis beyond what ERP/BI platforms offer\r\nexport const FRAMEWORK_METADATA = {\r\n  name: 'ConseQ-X Organizational Health Assessment',\r\n  version: '1.0',\r\n  description: 'Automated organizational health analysis across six holistic systems',\r\n  differentiators: [\r\n    'Holistic organizational diagnosis beyond operational metrics',\r\n    'Automated analysis and recommendations vs manual BI configuration', \r\n    'Predictive and prescriptive insights vs descriptive reporting',\r\n    'Cultural and behavioral factors integrated with operational data',\r\n    'Purpose-built for organizational effectiveness vs generic analytics'\r\n  ],\r\n  targetGap: 'Bridges the space between operational ERP/BI data and strategic consulting insights',\r\n  useCases: [\r\n    'Post-merger integration assessment',\r\n    'Organizational transformation tracking',\r\n    'Performance turnaround monitoring',\r\n    'Continuous health monitoring for SMEs',\r\n    'Government agency effectiveness measurement'\r\n  ]\r\n};\r\n\r\n// Value proposition vs traditional platforms\r\nexport const COMPETITIVE_ADVANTAGES = {\r\n  vsERP: [\r\n    'Analyzes intangible dynamics like culture and collaboration',\r\n    'Provides narrative insights beyond transactional data',\r\n    'Ready-made organizational health model vs complex customization'\r\n  ],\r\n  vsBI: [\r\n    'Purpose-built framework vs empty canvas requiring expertise',\r\n    'Automated interpretation and recommendations vs manual analysis',\r\n    'Integrated organizational model vs piecemeal dashboard building'\r\n  ],\r\n  vsConsulting: [\r\n    'Continuous monitoring vs one-off assessments',\r\n    'Affordable software vs expensive consulting engagements',\r\n    'Real-time insights vs periodic reports'\r\n  ]\r\n};\r\n"],"names":["tokenize","text","toLowerCase","replace","split","filter","Boolean","queryIndex","index","query","topK","arguments","length","undefined","docs","scored","qTokens","qtf","Object","create","forEach","t","qvec","qnorm","entries","_ref2","f","val","idf","Math","sqrt","docVectors","map","_ref3","i","vec","norm","dot","_ref4","v","sim","sort","a","b","scoreQuery","s","slice","score","doc","defaultSchema","strip","clobberPrefix","clobber","ancestors","tbody","tfoot","thead","td","th","tr","protocols","href","cite","src","longDesc","tagNames","attributes","img","input","li","div","blockquote","del","ins","q","required","type","disabled","own","hasOwnProperty","nodeSchema","root","children","all","doctype","schema","allowDoctypes","name","handleDoctypeName","comment","allowComments","value","handleCommentValue","element","tagName","handleTagName","properties","node","stack","attrs","reqs","props","allowed","assign","toPropertyValueMap","call","result","key","definition","data","Array","isArray","handlePropertyValues","handlePropertyValue","_","allow","position","one","replacement","includes","results","push","pop","indexOf","values","prop","url","String","colon","questionMark","numberSign","slash","concat","safeProtocol","some","test","rehypeSanitize","options","tree","ctx","hastUtilSanitize","TypingIndicator","_ref","darkMode","dotClass","_jsxs","className","_jsx","MessageRow","m","isUser","role","file","target","rel","Date","timestamp","toLocaleTimeString","hour","minute","ChatComposer","onSend","onAttachClick","textareaRef","textValue","setTextValue","uploadedFile","setUploadedFile","onTyping","useEffect","current","ta","style","height","newHeight","min","scrollHeight","boxShadow","size","toFixed","onClick","ref","onChange","e","onKeyDown","shiftKey","preventDefault","trim","placeholder","rows","maxHeight","width","FaPaperPlane","FaPaperclip","CEOChat","_auth$org","useOutletContext","auth","useAuth","conversations","useState","id","title","lastMessage","selectedConversationId","setSelectedConversationId","messages","setMessages","toISOString","isGenerating","setIsGenerating","userTyping","setUserTyping","typingTimerRef","useRef","fileInputRef","messagesRef","orgId","org","assessments","setAssessments","raw","localStorage","getItem","JSON","parse","_unused","refresh","_unused2","onStorage","bc","window","addEventListener","BroadcastChannel","ev","_ev$data","_ev$data2","_unused3","poll","setInterval","removeEventListener","clearInterval","close","_unused4","latestBySystem","useMemo","r","systemId","k","normalizeSystemKey","cur","_objectSpread","titleByKey","CANONICAL_SYSTEMS","simulateAssistantReply","prompt","lines","systems","keys","sid","_r$score","label","replyText","join","now","prev","idx","interval","chunk","async","handleSendMessage","userMsg","placeholderId","scores","_latestBySystem$k$sco","_latestBySystem$k","openRouterKey","process","modelUrl","_payload2$choices$0$m","_payload2$choices","_payload2$choices$","_payload2$choices$$me","assistantId","_auth$user","_auth$user2","_auth$org2","_payload$choices$0$me","_payload$choices","_payload$choices$","_payload$choices$$mes","user","email","N","termDocCount","docTerms","d","toks","tf","log","buildIndex","stringify","meta","hits","report","h","chatPayload","model","content","res","fetch","method","headers","Authorization","body","ok","txt","output","json","choices","message","total","tick","max","round","res2","output2","idx2","total2","tick2","err","console","error","scrollTop","c","itemClass","borderColor","WebkitOverflowScrolling","ReactMarkdown","remarkPlugins","remarkGfm","rehypePlugins","rehypeRaw","click","handleUserTyping","clearTimeout","setTimeout","_e$target$files","files","URL","createObjectURL","handleUploadFile","description","icon","color","order","LEGACY_TO_CANONICAL","systemKey","normalized","getSystemsForUI","system","weightSum","reduce","sum","w","abs","warn"],"sourceRoot":""}
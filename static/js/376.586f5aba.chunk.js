"use strict";(self.webpackChunkceo_assessment_app=self.webpackChunkceo_assessment_app||[]).push([[376],{8376:(e,t,s)=>{s.r(t),s.d(t,{default:()=>M});var n=s(89379),a=s(65043),r=s(23721),o=s(43199),c=s(13204),l=s(41962);const i={start:"conseqx:assessment:start",progress:"conseqx:assessment:progress",completed:"conseqx:assessment:completed",view:"conseqx:assessment:view"};function d(e){let{orgId:t,systemId:s}=e;try{window.dispatchEvent(new CustomEvent(i.start,{detail:{orgId:t,systemId:s}}))}catch(n){}}function u(e){let{orgId:t,systemId:s,progress:n,result:a}=e;try{window.dispatchEvent(new CustomEvent(i.progress,{detail:{orgId:t,systemId:s,progress:n,result:a}}))}catch(r){}}function m(e){try{window.dispatchEvent(new CustomEvent(i.completed,{detail:e}))}catch(t){}}var g=s(55255),x=s(59570),h=s(67519),p=s(52421),y=s(55805),w=s(70579);const v=(0,l.y6)();const b="conseqx_assessments_v1",f="conseqx_assessment_answers_v1",j="conseqx_assessment_progress_v1";function N(){try{const e=localStorage.getItem(b);return e?JSON.parse(e):{}}catch(e){return{}}}function A(e){try{localStorage.setItem(b,JSON.stringify(e))}catch(t){}}function I(){const e={};return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(t=>{if(!t.systemId)return;const s=(0,l.Os)(t.systemId);(!e[s]||(e[s].timestamp||0)<(t.timestamp||0))&&(e[s]=(0,n.A)((0,n.A)({},t),{},{systemId:s}))}),Object.keys(e).map(t=>({systemId:t,score:e[t].score||0,result:e[t]}))}function C(e){try{const t=localStorage.getItem(j);return(t?JSON.parse(t):{})[e]||{}}catch(t){return{}}}function k(e,t){if(console.log("calculateAnsweredCount called for ".concat(t,":"),e),!e||"object"!==typeof e)return console.log("calculateAnsweredCount: No valid answers for ".concat(t)),0;let s=0;const n=p.n.find(e=>e.id===t);return n&&n.subAssessments?(n.subAssessments.forEach(n=>{const a=e[n.id]||{},r=Object.keys(a).filter(e=>{const t=a[e];return null!==t&&void 0!==t&&""!==t&&"null"!==t}).length;console.log("calculateAnsweredCount: ".concat(t," -> ").concat(n.id,": ").concat(r," answers out of ").concat(Object.keys(a).length," total"),a),s+=r}),console.log("calculateAnsweredCount: ".concat(t," FINAL TOTAL = ").concat(s)),s):(console.log("calculateAnsweredCount: No system found for ".concat(t)),0)}function E(e){let{pct:t=0,darkMode:s=!1}=e;const n=s?"bg-gray-800":"bg-gray-200",a=100===t?"bg-green-500":"bg-yellow-500";return(0,w.jsx)("div",{className:"w-full h-2 rounded-full ".concat(n," overflow-hidden"),children:(0,w.jsx)("div",{style:{width:"".concat(t,"%")},className:"h-full ".concat(a)})})}function S(e){let{progress:t=0,darkMode:s=!1,systemTitle:n="System"}=e;return(0,w.jsxs)("div",{className:"mt-3 p-4 rounded-lg border-2 border-dashed ".concat(s?"bg-gradient-to-br from-blue-900/20 to-purple-900/20 border-blue-500/30":"bg-gradient-to-br from-blue-50 to-purple-50 border-blue-300/50"," relative overflow-hidden"),children:[(0,w.jsx)("div",{className:"absolute inset-0 opacity-10",children:(0,w.jsx)("div",{className:"h-full w-full ".concat(s?"bg-blue-400":"bg-blue-600"," animate-pulse"),style:{background:"linear-gradient(45deg, transparent 40%, ".concat(s?"#3b82f6":"#2563eb"," 50%, transparent 60%)"),backgroundSize:"20px 20px",animation:"slide 2s linear infinite"}})}),(0,w.jsxs)("div",{className:"relative z-10",children:[(0,w.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,w.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center ".concat(s?"bg-blue-600 text-white shadow-lg shadow-blue-500/20":"bg-blue-500 text-white shadow-lg shadow-blue-500/30"," animate-spin"),children:"\ud83e\udde0"}),(0,w.jsxs)("div",{children:[(0,w.jsx)("div",{className:"font-semibold ".concat(s?"text-blue-200":"text-blue-800"),children:"AI Analysis in Progress"}),(0,w.jsxs)("div",{className:"text-sm ".concat(s?"text-blue-300":"text-blue-600"),children:["Analyzing ",n,"..."]})]})]}),(0,w.jsx)("div",{className:"relative h-3 rounded-full overflow-hidden ".concat(s?"bg-gray-800":"bg-white/50"),children:(0,w.jsx)("div",{className:"h-full transition-all duration-500 ease-out relative ".concat(100===t?"bg-gradient-to-r from-green-400 to-emerald-500 shadow-lg shadow-green-500/30":"bg-gradient-to-r from-blue-400 to-purple-500 shadow-lg shadow-blue-500/30"),style:{width:"".concat(t,"%")},children:(0,w.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent animate-pulse"})})}),(0,w.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,w.jsxs)("div",{className:"text-sm font-medium ".concat(s?"text-blue-200":"text-blue-700"),children:[t,"% Complete"]}),(0,w.jsx)("div",{className:"flex gap-1",children:[...Array(3)].map((e,t)=>(0,w.jsx)("div",{className:"w-1.5 h-1.5 rounded-full ".concat(s?"bg-blue-400":"bg-blue-500"," animate-bounce"),style:{animationDelay:"".concat(.15*t,"s")}},t))})]}),(0,w.jsxs)("div",{className:"mt-2 text-xs ".concat(s?"text-gray-300":"text-gray-600"),children:[t<20&&"\ud83d\udd0d Initializing analysis engine...",t>=20&&t<40&&"\ud83d\udcca Processing assessment data...",t>=40&&t<60&&"\ud83e\uddee Running AI algorithms...",t>=60&&t<80&&"\ud83d\udcc8 Generating insights...",t>=80&&t<100&&"\u2728 Finalizing recommendations...",100===t&&"\ud83c\udf89 Analysis complete! Preparing results..."]})]}),(0,w.jsx)("style",{jsx:!0,children:"\n        @keyframes slide {\n          0% { transform: translateX(-100%); }\n          100% { transform: translateX(100%); }\n        }\n      "})]})}function R(e){var t,s;let{s:n,state:a,onStart:r,onView:o,onRemove:l,darkMode:i=!1}=e;const d=(a.answeredCount||0)>0,u=!d,m=null!==(t=null===(s=a.latestResult)||void 0===s?void 0:s.score)&&void 0!==t?t:null,g="completed"===a.status&&a.latestResult,x="completed"===a.status&&null!==m;console.log("\ud83d\udd04 SystemRow RENDER ".concat(n.id,":"),{status:a.status,answeredCount:a.answeredCount,hasAnswers:d,progress:a.progress,timestamp:Date.now()});const h=i?"hover:bg-gray-800":"hover:bg-gray-50",y=i?"text-gray-100":"text-gray-900",v=i?"text-gray-400":"text-gray-500",b="in-progress"===a.status&&a.progress<100,f=("ready-to-run"===a.status||d&&a.status,d&&!b),j=!f;console.log("\ud83d\udd18 Button Logic ".concat(n.id,": hasAnswers=").concat(d,", isRunning=").concat(b,", canRun=").concat(f,", runDisabled=").concat(j));const N="".concat(j?i?"bg-gray-800 text-gray-400 cursor-not-allowed border-gray-700":"bg-gray-200 text-gray-500 cursor-not-allowed border-gray-300":"bg-blue-600 text-white hover:bg-blue-700 border-blue-500"),A=!x,I="".concat(A?i?"bg-gray-900/20 text-gray-500 cursor-not-allowed border-gray-700":"bg-gray-50 text-gray-400 cursor-not-allowed border-gray-300":"bg-green-600 text-white hover:bg-green-700 border-green-500");let C=0;if("in-progress"===a.status)C=a.progress;else if(d&&!g){const e=p.n.find(e=>e.id===n.id),t=e?e.subAssessments.reduce((e,t)=>e+t.questions.length,0):0;C=t>0?Math.round(a.answeredCount/t*100):0}return(0,w.jsxs)("div",{className:"flex items-center justify-between gap-2 p-2 rounded-md ".concat(u?"opacity-60":""," ").concat(h," transition-all duration-200"),children:[(0,w.jsxs)("div",{className:"flex items-start gap-3 min-w-0",children:[(0,w.jsx)("div",{className:"w-10 h-10 rounded-md bg-gradient-to-br from-indigo-600 to-blue-500 flex items-center justify-center text-white font-semibold",children:n.icon}),(0,w.jsxs)("div",{className:"min-w-0",children:[(0,w.jsxs)("div",{className:"flex items-center gap-2",children:[(0,w.jsx)("div",{className:"font-medium truncate ".concat(y),children:n.title}),"completed"===a.status&&(0,w.jsxs)("div",{className:"text-xs px-2 py-0.5 rounded-full ".concat(i?"bg-green-900/30 text-green-300":"bg-green-100 text-green-700"),children:[m,"%"]}),"in-progress"===a.status&&(0,w.jsx)("div",{className:"text-xs px-2 py-0.5 rounded-full ".concat(i?"bg-yellow-900/20 text-yellow-300":"bg-yellow-100 text-yellow-700"),children:"In progress"})]}),(0,w.jsxs)("div",{className:"text-xs ".concat(v," mt-1"),children:[!d&&"Complete assessment questions first",d&&("not-started"===a.status||"ready-to-run"===a.status)&&"Ready to run analysis",d&&"in-progress"===a.status&&a.progress<100&&"Analyzing... ".concat(a.progress,"%"),d&&"in-progress"===a.status&&a.progress>=100&&"Analysis complete",g&&"Analysis completed ".concat(new Date(a.latestResult.timestamp).toLocaleString()),d&&!g&&"in-progress"!==a.status&&"".concat(a.answeredCount," questions answered")]}),C>0&&!g&&(0,w.jsx)("div",{className:"mt-2",children:(0,w.jsx)(E,{pct:C,darkMode:i})}),"in-progress"===a.status&&(0,w.jsx)(S,{progress:a.progress,darkMode:i,systemTitle:n.title})]})]}),(0,w.jsxs)("div",{className:"flex items-center gap-1",children:[(0,w.jsx)("button",{onClick:()=>r(n.id),disabled:j,title:"".concat(n.id,": ").concat(a.status," (").concat(a.answeredCount," answers) - ").concat(d?b?"AI analysis in progress...":"Run comprehensive AI analysis":"Answer at least one question to unlock analysis"),className:"px-2 py-1.5 rounded-md border text-xs font-medium transition-all duration-200 ".concat(N," ").concat(b?"animate-pulse shadow-lg":""),children:b?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{className:"inline-block mr-1 animate-spin",children:"\ud83e\udde0"}),"AI Analyzing..."]}):d?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(c.gSK,{className:"inline-block mr-1",size:10}),"ready-to-run"===a.status?"\ud83d\ude80 Run X-ULTRA":"\u25b6 Run Analysis"]}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{className:"inline-block mr-1",children:"\ud83d\udd12"}),"Locked"]})}),(0,w.jsx)("button",{onClick:()=>o(n.id),disabled:A,title:A?"Complete assessment to view results":"View detailed results",className:"px-2 py-1.5 rounded-md border text-xs transition-all duration-200 ".concat(I),children:(0,w.jsx)(c.Ny1,{size:10})}),a.latestResult&&(0,w.jsx)("button",{onClick:()=>l(a.latestResult.id),className:"px-2 py-1.5 rounded-md text-xs transition-all duration-200 ".concat(i?"text-gray-400 hover:text-gray-200 hover:bg-gray-800":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"),title:"Remove assessment",children:(0,w.jsx)(c.qbC,{size:10})})]})]})}function M(){const{darkMode:e,org:t=null,user:s=null}=(0,r.KC)(),l=(null===t||void 0===t?void 0:t.id)||"anon";(0,a.useEffect)(()=>{try{window.dispatchEvent(new CustomEvent("conseqx:theme:changed",{detail:{darkMode:e}}))}catch(t){}},[e]);const[i,b]=(0,a.useState)(()=>{try{return N()[l]||[]}catch(e){return[]}}),[S,M]=(0,a.useState)(()=>{const e=function(e){try{const t=localStorage.getItem(f);return(t?JSON.parse(t):{})[e]||{}}catch(t){return{}}}(l),t={};v.forEach(s=>{const n=k(e,s.id);t[s.id]={status:"not-started",progress:0,latestResult:null,answeredCount:n}});return I(i).forEach(s=>{const n=k(e,s.systemId);t[s.systemId],t[s.systemId]={status:"completed",progress:100,latestResult:s.result,answeredCount:n}}),t}),[q,D]=(0,a.useState)({}),[O,L]=(0,a.useState)(null),[z,_]=(0,a.useState)(!1),[P,J]=(0,a.useState)(null),[T,B]=(0,a.useState)(()=>C(l)),U=(0,a.useCallback)(()=>{_(!1),setTimeout(()=>J(null),320)},[]),F=(0,a.useRef)({}),H=()=>Object.keys(F.current).length>0?F.current:q;function K(e){const t=N();t[l]=e,A(t),b(e);const s=I(e),a=H();M(e=>{const t=(0,n.A)({},e);return v.forEach(e=>{const s=k(a,e.id);t[e.id]=t[e.id]||{status:"not-started",progress:0,latestResult:null,answeredCount:s},t[e.id].answeredCount=s}),s.forEach(e=>{const s=k(a,e.systemId);t[e.systemId]={status:"completed",progress:100,latestResult:e.result,answeredCount:s}}),t});try{window.dispatchEvent(new CustomEvent("conseqx:assessment:update",{detail:{orgId:l,assessments:e}})),console.log("\ud83d\udce1 Assessments: Dispatched update event for ".concat(e.length," assessments"))}catch(r){}try{if("BroadcastChannel"in window){const t=new BroadcastChannel("conseqx_assessments");t.postMessage({type:"assessments:update",orgId:l,assessments:e}),t.close(),console.log("\ud83d\udce1 Assessments: Broadcast update for ".concat(e.length," assessments"))}}catch(o){}}function Q(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={id:e.id||"A-".concat(Date.now().toString(36)),systemId:e.systemId||e.system||"general",title:e.title||e.name||e.systemId||"Assessment",score:"number"===typeof e.score?e.score:e.score?Number(e.score):null,owner:e.owner||s&&s.name||"Unknown",meta:e.meta||{},timestamp:e.timestamp||Date.now(),orgId:l,notes:e.notes||""},a=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:200;e||(e="anon");const a=N(),r=a[e]||[],o=[(0,n.A)((0,n.A)({},t),{},{timestamp:t.timestamp||Date.now()}),...r.filter(e=>e.id!==t.id)];return a[e]=o.slice(0,s),A(a),a[e]}(l,t,200);K(a);try{window.dispatchEvent(new CustomEvent("conseqx:assessment:completed",{detail:{orgId:l,assessment:t,systemId:t.systemId,score:t.score}})),console.log("\ud83c\udf89 Assessments: Assessment completed for system ".concat(t.systemId," with score ").concat(t.score,"%"))}catch(r){}try{y.tB(t)}catch(o){console.error("Error ingesting assessment into orgHealth service",o)}}function X(e){const t=S[e];if(t&&"in-progress"===t.status&&t.progress<100)return;((null===t||void 0===t?void 0:t.answeredCount)||0)>0?(M(t=>(0,n.A)((0,n.A)({},t),{},{[e]:(0,n.A)((0,n.A)({},t[e]),{},{status:"in-progress",progress:1})})),d({systemId:e,orgId:l}),function(e){let t=1;const s=setInterval(()=>{t=Math.min(100,t+Math.round(5+15*Math.random())),M(s=>(0,n.A)((0,n.A)({},s),{},{[e]:(0,n.A)((0,n.A)({},s[e]),{},{status:t>=100?"completed":"in-progress",progress:t})})),u({orgId:l,systemId:e,progress:t}),t>=100&&(clearInterval(s),(async()=>{try{m(await g.Kk(l,e))}catch(t){console.error("Assessment run failed:",t),M(t=>(0,n.A)((0,n.A)({},t),{},{[e]:(0,n.A)((0,n.A)({},t[e]),{},{status:"ready-to-run",progress:0})}))}})())},600)}(e)):console.warn("Run button clicked but no answers found. This should not happen.")}function V(e){const t=S[e];if(!t||!t.latestResult)return;const s=v.find(t=>t.id===e);if(s){var a,r,o;const c=H(),l=p.n.find(t=>t.id===e),i={};null===l||void 0===l||null===(a=l.subAssessments)||void 0===a||a.forEach(e=>{c[e.id]&&(i[e.id]=c[e.id])});const d=(null===l||void 0===l||null===(r=l.subAssessments)||void 0===r?void 0:r.map(e=>{const t=e.questions.length,s=i[e.id]?Object.keys(i[e.id]).filter(t=>{const s=i[e.id][t];return null!==s&&void 0!==s&&""!==s}).length:0;return{id:e.id,title:e.title,answered:s,total:t}}))||[],u=(0,n.A)((0,n.A)({},s),{},{result:t.latestResult,answers:i,subProgress:d});if(z&&P&&(null===(o=P.result)||void 0===o?void 0:o.id)===t.latestResult.id)return;J(u),_(!0)}try{window.dispatchEvent(new CustomEvent("conseqx:assessment:view",{detail:{result:t.latestResult}}))}catch(c){}}function G(e){const t=function(e,t){const s=N(),n=(s[e]||[]).filter(e=>e.id!==t);return s[e]=n,A(s),n}(l,e);K(t)}(0,a.useEffect)(()=>{console.log("\ud83d\udd04 useEffect triggered by assessmentAnswers change");const e=H();M(t=>{console.log("\u26a1 Force updating systemStates from useEffect");const s={};return v.forEach(n=>{const a=k(e,n.id),r=t[n.id]||{status:"not-started",progress:0,latestResult:null,answeredCount:0},o=r.latestResult?"completed":a>0?"ready-to-run":"not-started";console.log("\ud83d\udd27 Force update ".concat(n.id,": ").concat(r.answeredCount," -> ").concat(a,", ").concat(r.status," -> ").concat(o)),s[n.id]={status:o,progress:r.progress||0,latestResult:r.latestResult||null,answeredCount:a,lastUpdate:Date.now()}}),s})},[q,F.current]),(0,a.useEffect)(()=>{function e(e){const t=null===e||void 0===e?void 0:e.detail;!t||t.orgId&&t.orgId!==l||Q(t)}function t(e){const{systemId:t,progress:s}=(null===e||void 0===e?void 0:e.detail)||{};t&&M(a=>{var r;const o=a[t]||{status:"not-started",progress:0,latestResult:null},c=(0,n.A)((0,n.A)({},a),{},{[t]:(0,n.A)((0,n.A)({},o),{},{status:s>=100?"completed":"in-progress",progress:Math.max(0,Math.min(100,s))})});return s>=100&&null!==(r=e.detail)&&void 0!==r&&r.result&&Q(e.detail.result),c})}function s(e){const{systemId:t}=(null===e||void 0===e?void 0:e.detail)||{};t&&L(t)}function a(e){const{systemId:t,questionId:s,answer:a,totalQuestions:r,answeredCount:o}=(null===e||void 0===e?void 0:e.detail)||{};if(!t)return;const c=o||0,i=r>0?Math.round(c/r*100):0;B(e=>{const s=(0,n.A)((0,n.A)({},e),{},{[t]:i});return function(e,t){try{const s=localStorage.getItem(j),n=s?JSON.parse(s):{};n[e]=t,localStorage.setItem(j,JSON.stringify(n))}catch(s){}}(l,s),s}),M(e=>{const s=e[t]||{},a=s.latestResult;return(0,n.A)((0,n.A)({},e),{},{[t]:(0,n.A)((0,n.A)({},s),{},{status:a?"completed":c>0?"ready-to-run":"not-started",progress:s.progress||0,answeredCount:c})})}),u({orgId:l,systemId:t,progress:i,answeredCount:c})}return window.addEventListener("conseqx:assessment:completed",e),window.addEventListener("conseqx:assessment:progress",t),window.addEventListener("conseqx:assessment:start",s),window.addEventListener("conseqx:assessment:question-answered",a),()=>{window.removeEventListener("conseqx:assessment:completed",e),window.removeEventListener("conseqx:assessment:progress",t),window.removeEventListener("conseqx:assessment:start",s),window.removeEventListener("conseqx:assessment:question-answered",a)}},[l]),(0,a.useEffect)(()=>{if(!("BroadcastChannel"in window))return;const e=new BroadcastChannel("conseqx_assessments");return e.addEventListener("message",e=>{try{const{type:t,orgId:s,payload:a}=e.data||{};if("assessments:update"===t&&s===l){b(a||[]);const e=I(a||[]),t=H();M(s=>{const a=(0,n.A)({},s);return v.forEach(e=>{const s=k(t,e.id);a[e.id]=a[e.id]||{status:"not-started",progress:0,latestResult:null,answeredCount:s},a[e.id].answeredCount=s}),e.forEach(e=>{const s=k(t,e.systemId);a[e.systemId]={status:"completed",progress:100,latestResult:e.result,answeredCount:s}}),a})}}catch(t){}}),()=>e.close()},[l]),(0,a.useEffect)(()=>{const e=()=>{const e=C(l);B(e);const t=H();M(e=>{const s=(0,n.A)({},e);return v.forEach(e=>{const a=k(t,e.id);s[e.id]&&(s[e.id]=(0,n.A)((0,n.A)({},s[e.id]),{},{answeredCount:a,status:s[e.id].latestResult?"completed":a>0?"ready-to-run":"not-started"}))}),s})},t=t=>{t.key!==f&&t.key!==j||e()};window.addEventListener("storage",t);const s=setInterval(e,1e3);return()=>{window.removeEventListener("storage",t),clearInterval(s)}},[l]),(0,a.useEffect)(()=>{const e=Object.values(S).some(e=>(e.answeredCount||0)>0&&!e.latestResult),t=t=>{if(e)return t.preventDefault(),t.returnValue="You have unsaved assessment progress. Are you sure you want to leave?","You have unsaved assessment progress. Are you sure you want to leave?"};return e&&window.addEventListener("beforeunload",t),()=>{window.removeEventListener("beforeunload",t)}},[S]);const Y=(0,a.useMemo)(()=>{var e;const t=i.length;return{count:t,avgScore:t?Math.round(i.reduce((e,t)=>e+(Number(t.score)||0),0)/t):null,lastRun:(null===(e=i[0])||void 0===e?void 0:e.timestamp)||null}},[i]),Z=t=>{var s;let{isOpen:n}=t;if(!P&&!n)return null;const{title:a,result:r,icon:o,answers:l,subProgress:i}=P||{},d=(null===r||void 0===r?void 0:r.score)||0,u=null===r||void 0===r?void 0:r.timestamp,m={company:"Dangote Group (Nigeria)",challenge:"Similar challenges in ".concat(a.toLowerCase()," across multiple business units"),solution:"Implemented centralized governance framework with decentralized execution",result:"35% improvement in operational efficiency within 18 months",keyLessons:["Standardized processes while maintaining local flexibility","Invested in technology infrastructure for real-time monitoring","Created cross-functional teams to break down silos"]};return(0,w.jsx)(x.N,{children:n&&P&&(0,w.jsx)(h.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:U,children:(0,w.jsxs)(h.P.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"max-w-4xl w-full max-h-[90vh] overflow-y-auto rounded-2xl ".concat(e?"bg-gray-900 border-gray-700":"bg-white border-gray-200"," border shadow-2xl"),onClick:e=>e.stopPropagation(),children:[(0,w.jsxs)("div",{className:"sticky top-0 ".concat(e?"bg-gray-900 border-gray-700":"bg-white border-gray-200"," border-b px-6 py-4 flex items-center justify-between"),children:[(0,w.jsxs)("div",{className:"flex items-center gap-3",children:[(0,w.jsx)("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-indigo-600 to-blue-500 flex items-center justify-center text-white text-xl font-bold",children:o}),(0,w.jsxs)("div",{children:[(0,w.jsxs)("h2",{className:"text-xl font-bold ".concat(e?"text-gray-100":"text-gray-900"),children:[a," Assessment Results"]}),(0,w.jsxs)("p",{className:"text-sm ".concat(e?"text-gray-400":"text-gray-500"),children:["Completed ",u?new Date(u).toLocaleString():"Recently"]})]})]}),(0,w.jsx)("button",{onClick:U,className:"p-2 rounded-lg ".concat(e?"hover:bg-gray-800 text-gray-400":"hover:bg-gray-100 text-gray-500"),children:(0,w.jsx)(c.QCr,{size:20})})]}),(0,w.jsxs)("div",{className:"p-6 space-y-6",children:[(0,w.jsxs)("div",{className:"rounded-xl p-4 ".concat(e?"bg-gray-800":"bg-gray-50"),children:[(0,w.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,w.jsx)("h3",{className:"font-semibold ".concat(e?"text-gray-100":"text-gray-900"),children:"Overall Score"}),(0,w.jsxs)("div",{className:"text-2xl font-bold ".concat(d>=80?"text-green-500":d>=60?"text-yellow-500":"text-red-500"),children:[d,"%"]})]}),(0,w.jsx)("div",{className:"w-full h-3 rounded-full ".concat(e?"bg-gray-700":"bg-gray-200"),children:(0,w.jsx)("div",{className:"h-full rounded-full transition-all duration-500 ".concat(d>=80?"bg-green-500":d>=60?"bg-yellow-500":"bg-red-500"),style:{width:"".concat(d,"%")}})})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("h3",{className:"text-lg font-semibold mb-4 ".concat(e?"text-gray-100":"text-gray-900"),children:"Assessment Breakdown"}),(0,w.jsx)("div",{className:"space-y-3",children:i.map((t,s)=>(0,w.jsxs)("div",{className:"p-4 rounded-lg border ".concat(e?"bg-gray-800 border-gray-700":"bg-gray-50 border-gray-200"),children:[(0,w.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,w.jsx)("h4",{className:"font-medium ".concat(e?"text-gray-200":"text-gray-800"),children:t.title}),(0,w.jsxs)("div",{className:"flex items-center gap-2",children:[(0,w.jsx)(c.A7C,{className:"text-green-500",size:16}),(0,w.jsxs)("span",{className:"text-sm ".concat(e?"text-gray-400":"text-gray-600"),children:[t.answered," / ",t.total," answered"]})]})]}),(0,w.jsx)("div",{className:"w-full mb-2",children:(0,w.jsx)(E,{pct:t.total>0?Math.round(t.answered/t.total*100):0,darkMode:e})}),(0,w.jsx)("p",{className:"text-sm ".concat(e?"text-gray-400":"text-gray-600"),children:"Questions:"}),(0,w.jsx)("ul",{className:"list-disc list-inside ml-4",children:Object.entries(l[t.id]||{}).map(t=>{let[s,n]=t;return(0,w.jsxs)("li",{className:"text-xs ".concat(e?"text-gray-300":"text-gray-700"),children:["Q",s,": ",(0,w.jsx)("span",{className:"font-semibold",children:n})]},s)})})]},t.id))})]}),(0,w.jsxs)("div",{children:[(0,w.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2 ".concat(e?"text-gray-100":"text-gray-900"),children:[(0,w.jsx)(c.ZPX,{className:"text-yellow-500"}),"AI Recommendations"]}),(0,w.jsx)("div",{className:"space-y-2",children:["Implement structured feedback loops to improve communication","Establish clear performance metrics and tracking systems","Develop cross-functional collaboration protocols","Create standardized training programs for consistency"].map((t,s)=>(0,w.jsx)("div",{className:"p-3 rounded-lg ".concat(e?"bg-blue-900/20 border-blue-500/30":"bg-blue-50 border-blue-200"," border"),children:(0,w.jsx)("p",{className:"text-sm ".concat(e?"text-blue-200":"text-blue-800"),children:t})},s))})]}),(0,w.jsxs)("div",{children:[(0,w.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2 ".concat(e?"text-gray-100":"text-gray-900"),children:[(0,w.jsx)(c.ymh,{className:"text-green-500"}),"African Success Story"]}),(0,w.jsx)("div",{className:"rounded-xl p-4 border ".concat(e?"bg-green-900/20 border-green-500/30":"bg-green-50 border-green-200"),children:(0,w.jsxs)("div",{className:"space-y-3",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("h4",{className:"font-semibold ".concat(e?"text-green-200":"text-green-800"),children:m.company}),(0,w.jsx)("p",{className:"text-sm mt-1 ".concat(e?"text-green-300":"text-green-700"),children:m.challenge})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("h5",{className:"font-medium ".concat(e?"text-green-200":"text-green-800"),children:"Solution:"}),(0,w.jsx)("p",{className:"text-sm ".concat(e?"text-green-300":"text-green-700"),children:m.solution})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("h5",{className:"font-medium ".concat(e?"text-green-200":"text-green-800"),children:"Result:"}),(0,w.jsx)("p",{className:"text-sm ".concat(e?"text-green-300":"text-green-700"),children:m.result})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("h5",{className:"font-medium ".concat(e?"text-green-200":"text-green-800"),children:"Key Lessons:"}),(0,w.jsx)("ul",{className:"list-disc list-inside space-y-1 mt-1",children:m.keyLessons.map((t,s)=>(0,w.jsx)("li",{className:"text-sm ".concat(e?"text-green-300":"text-green-700"),children:t},s))})]})]})})]})]})]})},(null===(s=P.result)||void 0===s?void 0:s.id)||"detail-modal")})};return(0,w.jsxs)("section",{children:[(0,w.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("h2",{className:"".concat(e?"text-gray-100":"text-gray-900"," text-lg font-semibold"),children:"Assessments"}),(0,w.jsx)("p",{className:"mt-2 text-sm ".concat(e?"text-gray-300":"text-gray-600"),children:"Run or view system assessments. Systems update in real-time as runs progress and complete."})]}),(0,w.jsx)("div",{className:"flex items-center gap-3",children:(0,w.jsxs)("div",{className:"".concat(e?"text-gray-200":"text-sm text-gray-700"),children:[(0,w.jsxs)("div",{children:["Recent runs: ",(0,w.jsx)("span",{className:"font-semibold",children:Y.count})]}),(0,w.jsxs)("div",{className:"".concat(e?"text-gray-400":"text-xs text-gray-500"),children:["Avg score: ",null!==Y.avgScore?"".concat(Y.avgScore,"%"):"\u2014"]})]})})]}),(0,w.jsxs)("div",{className:"mt-4 grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,w.jsx)("div",{className:"lg:col-span-2",children:(0,w.jsx)("div",{className:"rounded-xl p-3 border ".concat(e?"bg-gray-900 border-gray-700":"bg-white border-gray-100"," shadow-sm"),children:(0,w.jsx)(o.A,{darkMode:e,onComplete:e=>Q(e),onAnswersChange:e=>{console.log("\ud83d\ude80 onAnswersChange called with:",e),F.current=e,D(e),M(t=>{console.log("\u26a1 Updating systemStates from onAnswersChange");const s={};return v.forEach(n=>{const a=k(e,n.id),r=t[n.id]||{status:"not-started",progress:0,latestResult:null,answeredCount:0},o=r.latestResult?"completed":a>0?"ready-to-run":"not-started";console.log("\ud83d\udcca System ".concat(n.id,": ").concat(r.answeredCount," -> ").concat(a," answers, ").concat(r.status," -> ").concat(o)),s[n.id]={status:o,progress:r.progress||0,latestResult:r.latestResult||null,answeredCount:a,lastUpdate:Date.now()}}),console.log("\u2705 New systemStates:",s),s}),function(e,t){try{const s=localStorage.getItem(f),n=s?JSON.parse(s):{};n[e]=t,localStorage.setItem(f,JSON.stringify(n))}catch(s){}}(l,e)},onQuestionAnswered:e=>{console.log("\ud83d\udcdd onQuestionAnswered called:",e),e.systemId&&void 0!==e.answeredCount&&M(t=>{const s=t[e.systemId]||{status:"not-started",progress:0,latestResult:null,answeredCount:0},a=s.latestResult?"completed":e.answeredCount>0?"ready-to-run":"not-started";return console.log("\ud83d\ude80 IMMEDIATE update ".concat(e.systemId,": ").concat(s.answeredCount," -> ").concat(e.answeredCount)),(0,n.A)((0,n.A)({},t),{},{[e.systemId]:(0,n.A)((0,n.A)({},s),{},{answeredCount:e.answeredCount,status:a,lastUpdate:Date.now()})})}),window.dispatchEvent(new CustomEvent("conseqx:assessment:question-answered",{detail:(0,n.A)((0,n.A)({},e),{},{orgId:l,timestamp:Date.now()})}))},onSystemStart:e=>{window.dispatchEvent(new CustomEvent("conseqx:assessment:start",{detail:{systemId:e,orgId:l,timestamp:Date.now()}}))},showClientInfo:!1,customSystems:p.n,ceoPartnerMode:!0,orgId:l,initialAnswers:q,enableRealTimeTracking:!0},e?"assessment-dark":"assessment-light")})}),(0,w.jsxs)("aside",{className:"rounded-xl p-3 border ".concat(e?"bg-gray-900 border-gray-700":"bg-white border-gray-100"," shadow-sm"),children:[(0,w.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,w.jsx)("div",{className:"text-sm font-semibold ".concat(e?"text-gray-100":"text-gray-900"),children:"Systems"}),(0,w.jsxs)("div",{className:"".concat(e?"text-xs text-gray-400":"text-xs text-gray-500"," flex items-center gap-2"),children:[(0,w.jsx)(c.OKX,{})," ",(0,w.jsx)("span",{children:i.length})]})]}),(0,w.jsx)("div",{className:"space-y-2",children:v.map(t=>{const s=k(H(),t.id),a=S[t.id]||{status:"not-started",progress:0,latestResult:null,answeredCount:0},r=(0,n.A)((0,n.A)({},a),{},{answeredCount:Math.max(a.answeredCount||0,s),status:a.latestResult?"completed":s>0?"ready-to-run":"not-started"});return(0,w.jsx)(R,{s:t,state:r,onStart:X,onView:V,onRemove:G,darkMode:e},"".concat(t.id,"-").concat(r.answeredCount,"-").concat(r.lastUpdate||0))})}),(0,w.jsx)("div",{className:"mt-3 border-t pt-2 ".concat(e?"text-xs text-gray-400 border-gray-800":"text-xs text-gray-500 border-gray-200"),children:(0,w.jsxs)("div",{className:"flex items-center justify-between",children:[(0,w.jsxs)("div",{className:"flex items-center gap-2",children:[(0,w.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(e?"bg-blue-500":"bg-blue-600"," animate-pulse")}),(0,w.jsx)("span",{children:"Real-time assessment tracking with X-Ultra intelligence"})]}),(0,w.jsx)("div",{className:"flex items-center gap-1",children:Object.values(S).some(e=>(e.answeredCount||0)>0)&&(0,w.jsx)("span",{className:"px-2 py-0.5 rounded-full text-xs ".concat(e?"bg-green-900/30 text-green-300":"bg-green-100 text-green-700"),children:"Active"})})]})})]})]}),(0,w.jsx)(Z,{isOpen:z})]})}},55805:(e,t,s)=>{s.d(t,{h1:()=>c,tB:()=>o});const n="conseqx_org_health_v1";function a(){try{const e=localStorage.getItem(n);return e?JSON.parse(e):{}}catch(e){return{}}}function r(e,t){e||(e="anon");const s=a(),r=s[e]||[];r.unshift(t),s[e]=r.slice(0,300),function(e){try{localStorage.setItem(n,JSON.stringify(e))}catch(t){}}(s);try{window.dispatchEvent(new CustomEvent("conseqx:orghealth:completed",{detail:{orgId:e,result:t}}))}catch(o){}}function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{const s=e.orgId||"anon",n=e.systemId||e.system||"general",a=e.meta||{},o="number"===typeof a.networkDensity?Math.max(0,Math.min(1,a.networkDensity)):Number(e.score)?Math.min(1,e.score/100):.5,c="number"===typeof a.sentiment?a.sentiment:null,l=null!==c?Math.max(0,Math.min(1,(c+1)/2)):Math.min(1,(Number(e.score)||0)/100),i="number"===typeof a.operational?Math.max(0,Math.min(1,a.operational)):Math.min(1,(Number(e.score)||0)/100);let d={networkDensity:.4,sentiment:.3,operational:.3};const u={interdependency:{networkDensity:.6,sentiment:.2,operational:.2},investigation:{networkDensity:.2,sentiment:.2,operational:.6},inlignment:{networkDensity:.2,sentiment:.4,operational:.4},orchestration:{networkDensity:.3,sentiment:.2,operational:.5},illustration:{networkDensity:.2,sentiment:.5,operational:.3},interpretation:{networkDensity:.2,sentiment:.5,operational:.3}};u[n]&&(d=u[n]);const m={networkDensity:o,sentiment:l,operational:i},g=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=Object.keys(t);if(0===s.length){const t=Object.values(e);if(0===t.length)return 0;const s=t.reduce((e,t)=>e+(Number(t)||0),0)/t.length;return Math.round(100*s)}const n=s.reduce((e,s)=>e+(Number(t[s])||0),0)||1,a=s.reduce((s,n)=>s+(Number(e[n])||0)*(Number(t[n])||0),0)/n;return Math.round(100*Math.max(0,Math.min(1,a)))}(m,d),x={id:e.id||"oh-".concat(Date.now().toString(36)),orgId:s,systemId:n,score:g,breakdown:m,provenance:{sourceAssessmentId:e.id,algorithmVersion:"orghealth-v1",createdAt:Date.now()},timestamp:Date.now(),original:{title:e.title,owner:e.owner,meta:e.meta||{}}};r(s,x);const h={id:"rec-".concat(Date.now().toString(36)),title:"Investigate ".concat(n," - ").concat(g,"%"),summary:"System ".concat(n," received a score of ").concat(g,"%. Key drivers: ").concat(Object.entries(m).map(e=>{let[t,s]=e;return"".concat(t,"=").concat(Math.round(100*s),"%")}).join(", "),"."),impact:g<60?"High \u2014 potential risk":g<75?"Medium":"Low",severity:g<60?"warning":"improvement",predictions:{short:g<60?"Short term: Operational friction, delays.":"Short term: Stable",mid:g<60?"Mid term: Reduced throughput if unresolved.":"Mid term: Maintain improvements",long:"Long term: Monitor trends"},evidence:["Derived from assessment ".concat(e.id),...e.meta&&e.meta.notes?[e.meta.notes]:[]],comparables:[],recommendedMeeting:{title:"Cross-functional sync: ".concat(n),urgency:g<60?"Urgent":"High",attendees:["Head of Product","Head of Engineering","Ops Lead"],proposedDurationMin:45,agenda:["Review findings","Assign owners","Agree next steps"]},source:"Assessment: ".concat(n),createdAt:Date.now()};try{window.dispatchEvent(new CustomEvent("conseqx:orghealth:recommendation",{detail:{orgId:s,recommendations:[h]}}))}catch(t){}return x}catch(s){return console.error("orgHealth.ingestAssessment error",s),null}}function c(e){return a()[e]||[]}}}]);
//# sourceMappingURL=376.586f5aba.chunk.js.map